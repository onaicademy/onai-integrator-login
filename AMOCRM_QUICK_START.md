# ‚ö° amoCRM Integration - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

## 5 –º–∏–Ω—É—Ç –¥–æ –∑–∞–ø—É—Å–∫–∞

### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ amoCRM

1. **Access Token** - [–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å ‚Üí](./AMOCRM_INTEGRATION_SETUP.md#—à–∞–≥-1-–ø–æ–ª—É—á–∏—Ç–µ-access-token-–æ—Ç-amocrm)
2. **Pipeline ID** - [–ö–∞–∫ –Ω–∞–π—Ç–∏ ‚Üí](./AMOCRM_INTEGRATION_SETUP.md#—à–∞–≥-2-–ø–æ–ª—É—á–∏—Ç–µ-id-–≤–æ—Ä–æ–Ω–∫–∏-pipeline-id)
3. **Status IDs** (ID —ç—Ç–∞–ø–æ–≤) - [–ö–∞–∫ –Ω–∞–π—Ç–∏ ‚Üí](./AMOCRM_INTEGRATION_SETUP.md#—à–∞–≥-3-–ø–æ–ª—É—á–∏—Ç–µ-id-—ç—Ç–∞–ø–æ–≤-status-ids)

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env

–û—Ç–∫—Ä–æ–π—Ç–µ `backend/.env` –∏ –¥–æ–±–∞–≤—å—Ç–µ:

```bash
# ========================================
# AMOCRM INTEGRATION
# ========================================
AMOCRM_SUBDOMAIN=yoursubdomain
AMOCRM_ACCESS_TOKEN=your_access_token_here
AMOCRM_PIPELINE_ID=10350882

# ‚ö†Ô∏è –í–ê–ñ–ù–û: –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ ID –∏–∑ –≤–∞—à–µ–π amoCRM!
AMOCRM_STAGE_LESSON_1=12345678  # "–ü–†–û–®–ï–õ –ü–ï–†–í–´–ô –£–†–û–ö"
AMOCRM_STAGE_LESSON_2=23456789  # "–ü–†–û–®–ï–õ –í–¢–û–†–û–ô –£–†–û–ö"
AMOCRM_STAGE_LESSON_3=34567890  # "–ü–†–û–®–ï–õ 3–ô –£–†–û–ö"

# üî• –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –î–õ–Ø –ü–†–û–î–ê–ö–®–ï–ù–ê (–∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤)
AMOCRM_CLIENT_ID=your_client_id
AMOCRM_CLIENT_SECRET=your_client_secret
AMOCRM_REFRESH_TOKEN=your_refresh_token
AMOCRM_REDIRECT_URI=https://onai.academy
```

> **üí° –í–∞–∂–Ω–æ:** –ë–µ–∑ OAuth credentials —Ç–æ–∫–µ–Ω –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ 24 —á–∞—Å–∞!  
> –°–º. –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é: [AMOCRM_REFRESH_TOKEN_GUIDE.md](./AMOCRM_REFRESH_TOKEN_GUIDE.md)

### –®–∞–≥ 3: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±—ç–∫–µ–Ω–¥

```bash
# –í —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
npm run dev

# –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ (pm2)
pm2 restart backend
```

### –®–∞–≥ 4: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ Node.js –∫–æ–Ω—Å–æ–ª—å
node

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
const amoCrm = require('./backend/src/services/amoCrmService');
await amoCrm.testConnection();

# –î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏:
# ‚úÖ [AmoCRM] –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ!
```

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –±–æ–µ–≤—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö

1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –ø–æ–¥ —Å—Ç—É–¥–µ–Ω—Ç–æ–º
2. –ó–∞–≤–µ—Ä—à–∏—Ç–µ –ª—é–±–æ–π —É—Ä–æ–∫ Tripwire (67, 68 –∏–ª–∏ 69)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±—ç–∫–µ–Ω–¥–∞:
   ```bash
   pm2 logs backend --lines 50 | grep AMOCRM
   ```
4. –û—Ç–∫—Ä–æ–π—Ç–µ amoCRM –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–¥–µ–ª–∫–∞ –ø–µ—Ä–µ–º–µ—Å—Ç–∏–ª–∞—Å—å

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å —Å–¥–µ–ª–∫–∏ –≤ amoCRM –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —É—Ä–æ–∫–æ–≤.

---

## üìö –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–î–ª—è –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π, troubleshooting –∏ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫:

üëâ **[AMOCRM_INTEGRATION_SETUP.md](./AMOCRM_INTEGRATION_SETUP.md)**

---

## üÜò –ß—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç?

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

**1. "amoCRM –Ω–µ —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω"**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `.env`
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±—ç–∫–µ–Ω–¥

**2. "–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ 401"**
- –¢–æ–∫–µ–Ω –∏—Å—Ç—ë–∫ (–∂–∏–≤—ë—Ç 24 —á–∞—Å–∞)
- –ü–æ–ª—É—á–∏—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω

**3. "–°–¥–µ–ª–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"**
- Email —Å—Ç—É–¥–µ–Ω—Ç–∞ –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å email –≤ amoCRM
- –°–¥–µ–ª–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –Ω—É–∂–Ω–æ–π –≤–æ—Ä–æ–Ω–∫–µ (`AMOCRM_PIPELINE_ID`)

**4. "–°–¥–µ–ª–∫–∞ –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è"**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ ID —ç—Ç–∞–ø–æ–≤ (`AMOCRM_STAGE_LESSON_*`)
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `amoCrm.listPipelines()` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

---

## üí° –°–æ–≤–µ—Ç

–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ Refresh Token:

üëâ [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è](./AMOCRM_INTEGRATION_SETUP.md#3-refresh-token-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)




