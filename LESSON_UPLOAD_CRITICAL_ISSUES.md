# üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï –£–†–û–ö–û–í

**–î–∞—Ç–∞:** 02.12.2025  
**–°—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ—à–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞  
**–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:** onAI-platform (–æ—Å–Ω–æ–≤–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞, –ù–ï Tripwire)

---

## üìã –û–ë–ó–û–† –ü–†–û–ë–õ–ï–ú

–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —É—Ä–æ–∫–æ–≤ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã **5 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º**, –∫–æ—Ç–æ—Ä—ã–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã:

1. ‚ùå **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Ä–æ–∫–æ–≤** –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
2. ‚ùå **–í–∏–¥–µ–æ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è** (404 –æ—à–∏–±–∫–∞)
3. ‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω—É–º–µ—Ä–∞—Ü–∏—è —É—Ä–æ–∫–æ–≤**
4. ‚ùå **–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–µ–Ω**
5. ‚ùå **–ö–∞—Ä—Ç–æ—á–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤—Å–µ–≥–¥–∞**

---

## üî• –ü–†–û–ë–õ–ï–ú–ê ‚Ññ1: –î–£–ë–õ–ò–†–û–í–ê–ù–ò–ï –£–†–û–ö–û–í

### üìä –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–î–æ–±–∞–≤–∏—Ç—å —É—Ä–æ–∫"
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç 1 –≤–∏–¥–µ–æ
- –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ—è–≤–ª—è–µ—Ç—Å—è **2 —É—Ä–æ–∫–∞** –≤–º–µ—Å—Ç–æ 1

### üì∏ –õ–æ–≥–∏ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏:
```
‚úÖ –£—Ä–æ–∫ —Å–æ–∑–¥–∞–Ω —Å ID: 68
üìä Upload progress: 23% ‚Üí 29% ‚Üí 39% ‚Üí 64% ‚Üí 89% ‚Üí 100%
‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ —É—Ä–æ–∫–æ–≤: 1

[–ü–æ–∑–∂–µ –ø–æ—Å–ª–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –Ω–∞–∂–∞—Ç–∏—è "–î–æ–±–∞–≤–∏—Ç—å —É—Ä–æ–∫"]
‚úÖ –£—Ä–æ–∫ —Å–æ–∑–¥–∞–Ω —Å ID: 69
‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ —É—Ä–æ–∫–æ–≤: 2
```

### ‚ùì –í–û–ü–†–û–°–´ –î–õ–Ø –ê–†–•–ò–¢–ï–ö–¢–û–†–ê:

1. **–ü–æ—á–µ–º—É —Å–æ–∑–¥–∞—é—Ç—Å—è –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —É—Ä–æ–∫–∏?**
   - –ü—Ä–æ–±–ª–µ–º–∞ –≤–æ frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ `LessonEditDialog.tsx`?
   - –ü—Ä–æ–±–ª–µ–º–∞ –≤ backend endpoint `POST /api/lessons`?
   - `onSave` callback –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã?

2. **–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É —Å–æ–∑–¥–∞–Ω–∏—è —É—Ä–æ–∫–∞?**
   - –ù—É–∂–µ–Ω –ª–∏ –º–µ—Ö–∞–Ω–∏–∑–º –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ –Ω–∞ backend?
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –ë–î –¥–ª—è –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏?
   - –ö–∞–∫ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É –∑–∞–ø—Ä–æ—Å–∞?

3. **–ö–∞–∫–æ–π –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å flow –∑–∞–≥—Ä—É–∑–∫–∏ —É—Ä–æ–∫–∞?**
   ```
   –í–∞—Ä–∏–∞–Ω—Ç 1 (—Ç–µ–∫—É—â–∏–π):
   1. –°–æ–∑–¥–∞—Ç—å lesson ‚Üí 2. –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏–¥–µ–æ ‚Üí 3. –û–±–Ω–æ–≤–∏—Ç—å lesson —Å video_id
   
   –í–∞—Ä–∏–∞–Ω—Ç 2 (–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π):
   1. –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏–¥–µ–æ ‚Üí 2. –°–æ–∑–¥–∞—Ç—å lesson —Å video_id
   
   –ö–∞–∫–æ–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π?
   ```

---

## üî• –ü–†–û–ë–õ–ï–ú–ê ‚Ññ2: –í–ò–î–ï–û –ù–ï –ó–ê–ì–†–£–ñ–ê–ï–¢–°–Ø (404)

### üìä –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
- –£—Ä–æ–∫ —Å–æ–∑–¥–∞–µ—Ç—Å—è (ID: 68)
- –í–∏–¥–µ–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –Ω–∞ Bunny Stream (progress: 100%)
- –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–æ–ª—É—á–∏—Ç—å –≤–∏–¥–µ–æ: `GET /api/videos/lesson/68` ‚Üí **404 Not Found**

### üì∏ –õ–æ–≥–∏ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏:
```
‚úÖ –í–∏–¥–µ–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –≤ Bunny Stream! –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç–∫–∞...
‚ùå API Error: Not found {error: 'Not found'}
‚ùå API Request Failed: GET http://localhost:3000/api/videos/lesson/68
‚ÑπÔ∏è –í–∏–¥–µ–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –¥–ª—è —É—Ä–æ–∫–∞: 68
```

### ‚ùì –í–û–ü–†–û–°–´ –î–õ–Ø –ê–†–•–ò–¢–ï–ö–¢–û–†–ê:

1. **–ü–æ—á–µ–º—É –≤–∏–¥–µ–æ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î?**
   - Backend endpoint `/api/stream/upload` –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü—É `videos`?
   - –ù—É–∂–Ω–∞ –ª–∏ —Å–≤—è–∑—å `lesson_id` ‚Üî `bunny_video_id` –≤ –ë–î?
   - –ö–∞–∫–∞—è —Ç–∞–±–ª–∏—Ü–∞ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–∏–¥–µ–æ? (`videos`, `lesson_videos`, –¥—Ä—É–≥–∞—è?)

2. **–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–≤—è–∑—å —É—Ä–æ–∫-–≤–∏–¥–µ–æ?**
   ```sql
   -- –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä—è–º–∞—è —Å–≤—è–∑—å
   lessons:
     - id
     - bunny_video_id (foreign key)
   
   -- –í–∞—Ä–∏–∞–Ω—Ç 2: –û—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
   videos:
     - id
     - lesson_id (foreign key)
     - bunny_video_id
     - public_url
   
   –ö–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–ª—è onAI-platform?
   ```

3. **–ö–∞–∫–æ–π –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å API flow?**
   - Frontend ‚Üí POST `/api/stream/upload` (—Å `lesson_id`?) ‚Üí Bunny Stream
   - Backend –¥–æ–ª–∂–µ–Ω —Å—Ä–∞–∑—É –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –≤ –ë–î –∏–ª–∏ –∂–¥–∞—Ç—å –æ—Ç–≤–µ—Ç–∞ –æ—Ç Bunny?
   - –ö–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –≤–∏–¥–µ–æ –Ω–∞ Bunny?

4. **–ü–æ—á–µ–º—É endpoint `/api/videos/lesson/:lessonId` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404?**
   - –≠—Ç–æ—Ç endpoint —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–∞ backend?
   - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ª–∏ –ø—É—Ç—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤–∏–¥–µ–æ —É—Ä–æ–∫–∞?
   - –ö–∞–∫–æ–π query –¥–æ–ª–∂–µ–Ω –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è: `SELECT * FROM videos WHERE lesson_id = ?` ?

---

## üî• –ü–†–û–ë–õ–ï–ú–ê ‚Ññ3: –ù–ï–ü–†–ê–í–ò–õ–¨–ù–ê–Ø –ù–£–ú–ï–†–ê–¶–ò–Ø –£–†–û–ö–û–í

### üìä –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
- –°–æ–∑–¥–∞–µ—Ç—Å—è **–ø–µ—Ä–≤—ã–π —É—Ä–æ–∫** –≤ –º–æ–¥—É–ª–µ
- –í UI –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ **"–£—Ä–æ–∫ 68"** (ID –∏–∑ –ë–î)
- –î–æ–ª–∂–µ–Ω –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∫–∞–∫ **"–£—Ä–æ–∫ 1"** (–ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä)

### üì∏ –í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:
```
–£–†–û–ö–ò –ú–û–î–£–õ–Ø
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 68  –ë–∞–∑–æ–≤–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π     ‚îÇ  ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1   –ë–∞–∑–æ–≤–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π     ‚îÇ  ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### ‚ùì –í–û–ü–†–û–°–´ –î–õ–Ø –ê–†–•–ò–¢–ï–ö–¢–û–†–ê:

1. **–ö–∞–∫–æ–µ –ø–æ–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –Ω—É–º–µ—Ä–∞—Ü–∏–∏ —É—Ä–æ–∫–æ–≤?**
   - `id` (—Ç–µ–∫—É—â–∏–π, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
   - `order_index` (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –º–æ–¥—É–ª—è–º)
   - –í—ã—á–∏—Å–ª—è—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏: `index + 1` –≤ —Å–ø–∏—Å–∫–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É—Ä–æ–∫–æ–≤?

2. **–î–æ–ª–∂–µ–Ω –ª–∏ –±—ã—Ç—å `order_index` –≤ —Ç–∞–±–ª–∏—Ü–µ `lessons`?**
   ```sql
   ALTER TABLE lessons ADD COLUMN order_index INTEGER DEFAULT 0;
   ```
   –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –ø–æ `created_at`?

3. **–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö?**
   - Frontend: `lessons.map((lesson, index) => index + 1)` ?
   - Backend –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å `order_index` ?

---

## üî• –ü–†–û–ë–õ–ï–ú–ê ‚Ññ4: –ü–†–û–ì–†–ï–°–°-–ë–ê–† –ù–ï –ò–ù–§–û–†–ú–ê–¢–ò–í–ï–ù

### üìä –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–µ–π—á–∞—Å:
```
üìä Upload progress: 23%
üìä Upload progress: 29%
üìä Upload progress: 100%
```
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–∏–¥–∏—Ç —Å–∫–æ–ª—å–∫–æ **–º–µ–≥–∞–±–∞–π—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–æ**.

### ‚úÖ –ö–∞–∫ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
üìä –ó–∞–≥—Ä—É–∂–µ–Ω–æ: 65 MB / 280 MB (23%)
üìä –ó–∞–≥—Ä—É–∂–µ–Ω–æ: 120 MB / 280 MB (43%)
üìä –ó–∞–≥—Ä—É–∂–µ–Ω–æ: 280 MB / 280 MB (100%)
```

### üì∏ –¢–µ–∫—É—â–∏–π –∫–æ–¥ (LessonEditDialog.tsx):
```typescript
xhr.upload.addEventListener('progress', (e) => {
  if (e.lengthComputable) {
    const percentComplete = Math.round((e.loaded / e.total) * 100);
    setUploadStatus(`üìπ –ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ... ${percentComplete}%`);
  }
});
```

### ‚ùì –í–û–ü–†–û–°–´ –î–õ–Ø –ê–†–•–ò–¢–ï–ö–¢–û–†–ê:

1. **–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ –≤ MB?**
   ```typescript
   const loadedMB = (e.loaded / 1024 / 1024).toFixed(2);
   const totalMB = (e.total / 1024 / 1024).toFixed(2);
   setUploadStatus(`üìπ –ó–∞–≥—Ä—É–∂–µ–Ω–æ: ${loadedMB} MB / ${totalMB} MB (${percent}%)`);
   ```
   –≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥?

2. **–ì–¥–µ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å?**
   - –í —Ç–µ–∫—Å—Ç–µ –Ω–∞–¥ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º?
   - –í–Ω—É—Ç—Ä–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞?
   - –í –æ—Ç–¥–µ–ª—å–Ω–æ–º —ç–ª–µ–º–µ–Ω—Ç–µ —Ä—è–¥–æ–º —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º?

3. **–ù—É–∂–Ω–∞ –ª–∏ –∞–Ω–∏–º–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞?**
   - –ü–ª–∞–≤–Ω–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ (transition)?
   - –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è (–∑–µ–ª–µ–Ω—ã–π/—Å–∏–Ω–∏–π/–∂–µ–ª—Ç—ã–π)?

---

## üî• –ü–†–û–ë–õ–ï–ú–ê ‚Ññ5: –ö–ê–†–¢–û–ß–ö–ê –ú–ê–¢–ï–†–ò–ê–õ–û–í –û–¢–û–ë–†–ê–ñ–ê–ï–¢–°–Ø –í–°–ï–ì–î–ê

### üìä –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
- –£—Ä–æ–∫ **–±–µ–∑ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤** (`materials.length === 0`)
- –ö–∞—Ä—Ç–æ—á–∫–∞ **"–ú–∞—Ç–µ—Ä–∏–∞–ª—ã —É—Ä–æ–∫–∞"** –≤—Å–µ —Ä–∞–≤–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- –ö–Ω–æ–ø–∫–∞ "–°–∫–∞—á–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã" –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞

### ‚úÖ –ö–∞–∫ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
- –ï—Å–ª–∏ `materials.length === 0` ‚Üí **–ù–ï –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É**
- –ï—Å–ª–∏ `materials.length > 0` ‚Üí –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É

### üì∏ –¢–µ–∫—É—â–∏–π –∫–æ–¥ (Lesson.tsx):
```tsx
{/* –ú–∞—Ç–µ—Ä–∏–∞–ª—ã */}
<div className="materials-section">
  <h3>üìö –ú–∞—Ç–µ—Ä–∏–∞–ª—ã —É—Ä–æ–∫–∞</h3>
  <button disabled={materials.length === 0}>–°–∫–∞—á–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã</button>
</div>
```

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥:
```tsx
{materials.length > 0 && (
  <div className="materials-section">
    <h3>üìö –ú–∞—Ç–µ—Ä–∏–∞–ª—ã —É—Ä–æ–∫–∞</h3>
    <button>–°–∫–∞—á–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã</button>
  </div>
)}
```

### ‚ùì –í–û–ü–†–û–°–´ –î–õ–Ø –ê–†–•–ò–¢–ï–ö–¢–û–†–ê:

1. **–≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –¥–ª—è —É—Å–ª–æ–≤–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞?**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `&&` –æ–ø–µ—Ä–∞—Ç–æ—Ä?
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Ä–Ω–∞—Ä–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä?
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π `if` –±–ª–æ–∫?

2. **–ì–¥–µ –µ—â–µ –Ω—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —É—Å–ª–æ–≤–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥?**
   - AI –æ–ø–∏—Å–∞–Ω–∏–µ —É—Ä–æ–∫–∞ (`ai_description`)?
   - AI —Å–æ–≤–µ—Ç—ã (`ai_tips`)?
   - –°—É–±—Ç–∏—Ç—Ä—ã –≤–∏–¥–µ–æ?

---

## üõ†Ô∏è –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï –ö–û–î–û–í–û–ô –ë–ê–ó–´

### üìÅ –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã:
1. **Frontend:**
   - `src/components/admin/LessonEditDialog.tsx` (–∑–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ, —Å–æ–∑–¥–∞–Ω–∏–µ —É—Ä–æ–∫–∞)
   - `src/pages/Lesson.tsx` (–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Ä–æ–∫–∞)
   - `src/pages/Module.tsx` (—Å–ø–∏—Å–æ–∫ —É—Ä–æ–∫–æ–≤)

2. **Backend:**
   - `backend/src/routes/stream.ts` (–∑–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ –Ω–∞ Bunny)
   - `backend/src/routes/lessons.ts` (CRUD —É—Ä–æ–∫–æ–≤)
   - `backend/src/routes/video.ts` (–ø–æ–ª—É—á–µ–Ω–∏–µ –≤–∏–¥–µ–æ)

### üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (Supabase):

#### ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `lessons` (—Å—É—â–µ—Å—Ç–≤—É–µ—Ç):
```sql
CREATE TABLE lessons (
    id SERIAL PRIMARY KEY,
    module_id INTEGER REFERENCES modules(id),
    title TEXT,
    description TEXT,
    video_url TEXT,
    duration INTEGER,
    order_index INTEGER,
    lesson_type VARCHAR(50) DEFAULT 'video',
    duration_minutes INTEGER DEFAULT 0,
    is_preview BOOLEAN DEFAULT false,
    tip TEXT,
    xp_reward INTEGER DEFAULT 10,
    is_archived BOOLEAN DEFAULT false,
    bunny_video_id TEXT,  -- ‚ö†Ô∏è –°–≤—è–∑—å —Å Bunny Stream
    ai_description TEXT,
    ai_tips TEXT,
    created_at TIMESTAMPTZ DEFAULT now(),
    updated_at TIMESTAMPTZ DEFAULT now()
);
```

#### ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `video_content` (—Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ù–ï `videos`):
```sql
CREATE TABLE video_content (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    lesson_id INTEGER REFERENCES lessons(id),  -- ‚úÖ FOREIGN KEY
    bunny_video_id TEXT,  -- ‚ö†Ô∏è –°–≤—è–∑—å —Å Bunny Stream
    r2_object_key VARCHAR NOT NULL,
    r2_bucket_name VARCHAR DEFAULT 'onai-academy-videos',
    public_url TEXT,  -- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–ª–µ–µ—Ä–∞
    filename VARCHAR NOT NULL,
    file_size_bytes BIGINT,
    duration_seconds INTEGER,
    resolution VARCHAR,
    format VARCHAR,
    upload_status VARCHAR DEFAULT 'pending',
    transcoding_status VARCHAR DEFAULT 'pending',
    created_at TIMESTAMPTZ DEFAULT now(),
    updated_at TIMESTAMPTZ DEFAULT now()
);
```

#### üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–µ–π (–¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î):
```sql
-- Lesson ID 68 (–µ—Å—Ç—å –≤–∏–¥–µ–æ) ‚úÖ
lessons.bunny_video_id = 'cb4fafc4-7814-4289-9b5f-8dc0bf749cfe'
video_content.bunny_video_id = 'cb4fafc4-7814-4289-9b5f-8dc0bf749cfe'
video_content.public_url = 'https://video.onai.academy/.../playlist.m3u8'
video_content.lesson_id = 68

-- Lesson ID 69 (–ù–ï–¢ –≤–∏–¥–µ–æ, –¥—É–±–ª–∏–∫–∞—Ç!) ‚ùå
lessons.bunny_video_id = NULL
video_content: –∑–∞–ø–∏—Å—å –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
```

#### ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ù–ê–•–û–î–ö–ê:
**Endpoint `/api/videos/lesson/:id` –¥–æ–ª–∂–µ–Ω –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å `video_content`, –∞ –Ω–µ `videos`!**

```sql
-- ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (—Ç–∞–±–ª–∏—Ü—ã videos –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç):
SELECT * FROM videos WHERE lesson_id = ?

-- ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
SELECT * FROM video_content WHERE lesson_id = ?
```

---

## üìÇ –°–¢–†–£–ö–¢–£–†–ê –ú–ò–ì–†–ê–¶–ò–ô SUPABASE

### üìÅ –ü–∞–ø–∫–∞: `supabase/migrations/`

**–í—Å–µ–≥–æ –º–∏–≥—Ä–∞—Ü–∏–π:** 58 —Ñ–∞–π–ª–æ–≤

#### üîë –ö–ª—é—á–µ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –≤–∏–¥–µ–æ:
1. `20251115_video_analytics_and_mentor.sql` - –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤–∏–¥–µ–æ
2. `20251115_fix_course_structure.sql` - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫—É—Ä—Å–æ–≤
3. `VERIFY_VIDEO_STRUCTURE.sql` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤–∏–¥–µ–æ

#### üìä –ü–æ—Å–ª–µ–¥–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
- `20251124_fix_priority_constraint.sql`
- `20251124_add_telegram_fields.sql`
- `20251122_user_goals_system_clean.sql`
- `20251121_ai_mentor_missing_tables.sql`

#### ‚ùì –í–æ–ø—Ä–æ—Å –¥–ª—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞:
**–ù—É–∂–Ω–∞ –ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è `order_index` –≤ `lessons`?**

```sql
-- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è:
-- supabase/migrations/20251202_add_lesson_order_index.sql

ALTER TABLE lessons 
ADD COLUMN IF NOT EXISTS order_index INTEGER DEFAULT 0;

-- –û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —É—Ä–æ–∫–∏
UPDATE lessons 
SET order_index = (
    SELECT COUNT(*) 
    FROM lessons l2 
    WHERE l2.module_id = lessons.module_id 
      AND l2.id < lessons.id
)
WHERE order_index = 0;

-- –°–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
CREATE INDEX IF NOT EXISTS idx_lessons_module_order 
ON lessons(module_id, order_index);
```

---

## üéØ –ö–õ–Æ–ß–ï–í–´–ï –í–û–ü–†–û–°–´ –î–õ–Ø –ê–†–•–ò–¢–ï–ö–¢–û–†–ê

### 1Ô∏è‚É£ **–ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ó–ê–ì–†–£–ó–ö–ò –í–ò–î–ï–û**

**–í–æ–ø—Ä–æ—Å:** –ö–∞–∫–æ–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π flow –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ?

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –í–ê–†–ò–ê–ù–¢ A (—Ç–µ–∫—É—â–∏–π):                                ‚îÇ
‚îÇ 1. Frontend: –°–æ–∑–¥–∞—Ç—å lesson (POST /api/lessons)    ‚îÇ
‚îÇ 2. Frontend: –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏–¥–µ–æ (POST /api/stream)    ‚îÇ
‚îÇ 3. Backend: –û–±–Ω–æ–≤–∏—Ç—å lesson.bunny_video_id         ‚îÇ
‚îÇ 4. Frontend: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å lesson –¥–∞–Ω–Ω—ã–µ           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –í–ê–†–ò–ê–ù–¢ B (–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π):                           ‚îÇ
‚îÇ 1. Frontend: –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏–¥–µ–æ (POST /api/stream)    ‚îÇ
‚îÇ 2. Backend: –ü–æ–ª—É—á–∏—Ç—å bunny_video_id                ‚îÇ
‚îÇ 3. Frontend: –°–æ–∑–¥–∞—Ç—å lesson —Å bunny_video_id       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–ö–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–ª—è onAI-platform?
```

---

### 2Ô∏è‚É£ **–°–¢–†–£–ö–¢–£–†–ê –ë–î –î–õ–Ø –í–ò–î–ï–û**

**–í–æ–ø—Ä–æ—Å:** –ù—É–∂–Ω–∞ –ª–∏ –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ `videos` –∏–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ `bunny_video_id` –≤ `lessons`?

```sql
-- –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä—è–º–∞—è —Å–≤—è–∑—å (—Ç–µ–∫—É—â–∏–π?)
CREATE TABLE lessons (
    id SERIAL PRIMARY KEY,
    bunny_video_id TEXT,
    title TEXT,
    ...
);

-- –í–∞—Ä–∏–∞–Ω—Ç 2: –û—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
CREATE TABLE videos (
    id SERIAL PRIMARY KEY,
    lesson_id INTEGER REFERENCES lessons(id),
    bunny_video_id TEXT,
    public_url TEXT,
    duration INTEGER,
    status TEXT, -- 'processing' | 'completed' | 'failed'
    created_at TIMESTAMP
);

–ö–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π?
```

---

### 3Ô∏è‚É£ **ENDPOINT `/api/videos/lesson/:lessonId`**

**–í–æ–ø—Ä–æ—Å:** –≠—Ç–æ—Ç endpoint —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–∞ backend? –ö–∞–∫–æ–π –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–≤–µ—Ç?

```typescript
// –¢–µ–∫—É—â–∏–π –∑–∞–ø—Ä–æ—Å (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404):
GET /api/videos/lesson/68

// –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç (–Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–î):
{
  "video": {
    "id": "6c2fce46-ac91-4c1c-a706-e84795271df0",  // UUID
    "lesson_id": 68,
    "bunny_video_id": "cb4fafc4-7814-4289-9b5f-8dc0bf749cfe",
    "public_url": "https://video.onai.academy/cb4fafc4-7814-4289-9b5f-8dc0bf749cfe/playlist.m3u8",
    "filename": "0219 (2)(1).mov",
    "file_size_bytes": 294395904,  // 280 MB
    "duration_seconds": 826,
    "resolution": "1920x1080",
    "upload_status": "completed",
    "transcoding_status": "completed",
    "created_at": "2025-12-02T10:35:00Z"
  }
}

// Backend –¥–æ–ª–∂–µ–Ω –≤—ã–ø–æ–ª–Ω—è—Ç—å:
SELECT * FROM video_content WHERE lesson_id = $1;
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Ö–æ–¥–∫–∞:**
- –¢–∞–±–ª–∏—Ü–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `video_content`, –ù–ï `videos`
- –°–≤—è–∑—å: `video_content.lesson_id` ‚Üí `lessons.id`
- –û–±–µ —Ç–∞–±–ª–∏—Ü—ã –∏–º–µ—é—Ç `bunny_video_id` (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö?)

**–í–æ–ø—Ä–æ—Å –¥–ª—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞:**
–ó–∞—á–µ–º `bunny_video_id` –≤ –æ–±–µ–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö? –ù–µ –ª—É—á—à–µ –ª–∏ —Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –≤ `video_content`?

---

### 4Ô∏è‚É£ **–î–ï–î–£–ü–õ–ò–ö–ê–¶–ò–Ø –£–†–û–ö–û–í**

**–í–æ–ø—Ä–æ—Å:** –ö–∞–∫ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Ä–æ–∫–æ–≤?

```typescript
// Frontend: –ù—É–∂–µ–Ω –ª–∏ —Ñ–ª–∞–≥ isSubmitting?
const [isSubmitting, setIsSubmitting] = useState(false);

const handleSubmit = async () => {
  if (isSubmitting) return; // –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É
  setIsSubmitting(true);
  try {
    await api.post('/api/lessons', data);
  } finally {
    setIsSubmitting(false);
  }
};

// Backend: –ù—É–∂–Ω–∞ –ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã?
SELECT * FROM lessons 
WHERE module_id = ? AND title = ? 
LIMIT 1;
-- –ï—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Üí –≤–µ—Ä–Ω—É—Ç—å –æ—à–∏–±–∫—É
```

---

### 5Ô∏è‚É£ **–ù–£–ú–ï–†–ê–¶–ò–Ø –£–†–û–ö–û–í**

**–í–æ–ø—Ä–æ—Å:** –î–æ–±–∞–≤–∏—Ç—å `order_index` –≤ —Ç–∞–±–ª–∏—Ü—É `lessons`?

```sql
-- –ú–∏–≥—Ä–∞—Ü–∏—è
ALTER TABLE lessons ADD COLUMN order_index INTEGER DEFAULT 0;

-- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —É—Ä–æ–∫–∞
INSERT INTO lessons (module_id, title, order_index)
VALUES (?, ?, (SELECT COALESCE(MAX(order_index), 0) + 1 FROM lessons WHERE module_id = ?));

-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ frontend
lessons.map((lesson, index) => (
  <div>–£—Ä–æ–∫ {lesson.order_index + 1}: {lesson.title}</div>
))
```

–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ª–∏ –ø–æ–¥—Ö–æ–¥?

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–†–û–ë–õ–ï–ú

| –ü—Ä–æ–±–ª–µ–º–∞ | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –ë–ª–æ–∫–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É? | –¢—Ä–µ–±—É–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î? |
|----------|-------------|-------------------|----------------------|
| –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Ä–æ–∫–æ–≤ | üî¥ –í—ã—Å–æ–∫–∞—è | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç |
| –í–∏–¥–µ–æ 404 | üî¥ –í—ã—Å–æ–∫–∞—è | ‚úÖ –î–∞ | ‚ùì –í–æ–∑–º–æ–∂–Ω–æ |
| –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω—É–º–µ—Ä–∞—Ü–∏—è | üü° –°—Ä–µ–¥–Ω—è—è | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ |
| –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä | üü¢ –ù–∏–∑–∫–∞—è | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç |
| –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –≤—Å–µ–≥–¥–∞ –≤–∏–¥–Ω—ã | üü¢ –ù–∏–∑–∫–∞—è | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç |

---

## üöÄ –ü–†–ï–î–õ–û–ñ–ï–ù–ù–´–ô –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### –≠—Ç–∞–ø 1: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (–æ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞)
1. ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î –¥–ª—è –≤–∏–¥–µ–æ
2. ‚úÖ –£—Ç–æ—á–Ω–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π API flow
3. ‚úÖ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω—É–∂–Ω–∞ –ª–∏ —Ç–∞–±–ª–∏—Ü–∞ `videos`

### –≠—Ç–∞–ø 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ backend
1. –°–æ–∑–¥–∞—Ç—å/–∏—Å–ø—Ä–∞–≤–∏—Ç—å endpoint `/api/videos/lesson/:lessonId`
2. –û–±–Ω–æ–≤–∏—Ç—å `/api/stream/upload` –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤ –ë–î
3. –î–æ–±–∞–≤–∏—Ç—å –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—é —É—Ä–æ–∫–æ–≤

### –≠—Ç–∞–ø 3: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ frontend
1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É —Å–æ–∑–¥–∞–Ω–∏—è —É—Ä–æ–∫–∞ (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã)
2. –£–ª—É—á—à–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å MB)
3. –î–æ–±–∞–≤–∏—Ç—å —É—Å–ª–æ–≤–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
4. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω—É–º–µ—Ä–∞—Ü–∏—é —É—Ä–æ–∫–æ–≤

### –≠—Ç–∞–ø 4: –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞)
1. –î–æ–±–∞–≤–∏—Ç—å `order_index` –≤ `lessons`
2. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `videos` (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞)
3. –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –∏ foreign keys

---

## üìû –ö–û–ù–¢–ê–ö–¢ –î–õ–Ø –í–û–ü–†–û–°–û–í

**–ö–æ–º—É –∞–¥—Ä–µ—Å–æ–≤–∞–Ω–æ:** –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ onAI Academy  
**–û—Ç –∫–æ–≥–æ:** AI Assistant (Cursor Chat)  
**–î–∞—Ç–∞:** 02.12.2025  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –í–´–°–û–ö–ò–ô

---

## üîó –°–í–Ø–ó–ê–ù–ù–´–ï –§–ê–ô–õ–´

- `src/components/admin/LessonEditDialog.tsx` - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —É—Ä–æ–∫–∞
- `backend/src/routes/stream.ts` - backend –∑–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ
- `backend/src/routes/lessons.ts` - backend CRUD —É—Ä–æ–∫–æ–≤
- `backend/src/routes/video.ts` - backend –ø–æ–ª—É—á–µ–Ω–∏–µ –≤–∏–¥–µ–æ (???)
- `DEPLOYMENT_GUIDE.md` - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–µ–ø–ª–æ—é
- `PLATFORM_NAMING.md` - —Ä–∞–∑–ª–∏—á–∏–µ onAI-platform –∏ Tripwire

---

**‚ö†Ô∏è –û–ñ–ò–î–ê–ù–ò–ï –û–¢–í–ï–¢–ê –û–¢ –ê–†–•–ò–¢–ï–ö–¢–û–†–ê –î–õ–Ø –ü–†–û–î–û–õ–ñ–ï–ù–ò–Ø –†–ê–ë–û–¢–´**

