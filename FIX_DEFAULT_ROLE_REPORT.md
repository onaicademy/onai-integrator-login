# üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –î–ï–§–û–õ–¢–ù–û–ô –†–û–õ–ò "student"

**–î–∞—Ç–∞:** 11 –Ω–æ—è–±—Ä—è 2025  
**–¶–µ–ª—å:** –£–±—Ä–∞—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `role = "student"` –∏ –Ω–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ–∫–∞ —Ä–æ–ª—å –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞

---

## ‚ùå –ü–†–û–ë–õ–ï–ú–ê

**–ß—Ç–æ –±—ã–ª–æ:**
1. `AppSidebar` –ø–æ–ª—É—á–∞–ª `role = "student"` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
2. –°–∞–π–¥–±–∞—Ä —Ä–µ–Ω–¥–µ—Ä–∏–ª—Å—è –î–û —Ç–æ–≥–æ –∫–∞–∫ `MainLayout` –æ–ø—Ä–µ–¥–µ–ª–∏–ª –Ω–∞—Å—Ç–æ—è—â—É—é —Ä–æ–ª—å
3. –ü—Ä–∏ –æ—à–∏–±–∫–µ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–µ—Å—Å–∏–∏ —Ä–æ–ª—å —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–∞—Å—å –≤ `"student"`
4. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∞–¥–º–∏–Ω –≤–∏–¥–µ–ª –º–µ–Ω—é —Å—Ç—É–¥–µ–Ω—Ç–∞ –Ω–∞ 1-2 —Å–µ–∫—É–Ω–¥—ã

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï

### 1. **–ò–∑–º–µ–Ω—ë–Ω —Ç–∏–ø —Ä–æ–ª–∏ –≤ AppSidebar**

**–§–∞–π–ª:** `src/components/app-sidebar.tsx`

**–ë–´–õ–û:**
```typescript
interface AppSidebarProps {
  role?: UserRole; // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å –¥–µ—Ñ–æ–ª—Ç–æ–º
}

export function AppSidebar({ role }: AppSidebarProps) {
  if (!role) {
    return null;
  }
  // ...
}
```

**–°–¢–ê–õ–û:**
```typescript
interface AppSidebarProps {
  role: UserRole | null; // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π, –º–æ–∂–µ—Ç –±—ã—Ç—å null
}

export function AppSidebar({ role }: AppSidebarProps) {
  console.log('üìã AppSidebar —Ä–æ–ª—å:', role);
  
  // –ù–µ —Ä–µ–Ω–¥–µ—Ä–∏–º –ø–æ–∫–∞ —Ä–æ–ª—å –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞
  if (!role) {
    console.log("‚è≥ AppSidebar: –†–æ–ª—å –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞, –∂–¥—ë–º...");
    return null;
  }
  // ...
}
```

### 2. **–£–±—Ä–∞–Ω–æ –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ "student" –≤ MainLayout**

**–§–∞–π–ª:** `src/components/layouts/MainLayout.tsx`

**–ë–´–õ–û:**
```typescript
if (sessionError || !session?.user) {
  console.log('‚ö†Ô∏è MainLayout: –ù–µ—Ç —Å–µ—Å—Å–∏–∏');
  setUserRole("student"); // ‚ùå –î–µ—Ñ–æ–ª—Ç!
  setIsLoading(false);
  return;
}

// ...

} catch (error) {
  console.error('‚ùå MainLayout: –ò—Å–∫–ª—é—á–µ–Ω–∏–µ:', error);
  setUserRole("student"); // ‚ùå –î–µ—Ñ–æ–ª—Ç!
  setIsLoading(false);
}
```

**–°–¢–ê–õ–û:**
```typescript
if (sessionError || !session?.user) {
  console.log('‚ö†Ô∏è MainLayout: –ù–µ—Ç —Å–µ—Å—Å–∏–∏, –æ—Å—Ç–∞–≤–ª—è–µ–º role = null');
  setUserRole(null); // ‚úÖ Null!
  setIsLoading(false);
  return;
}

// ...

} catch (error) {
  console.error('‚ùå MainLayout: –ò—Å–∫–ª—é—á–µ–Ω–∏–µ:', error);
  setUserRole(null); // ‚úÖ Null!
  setIsLoading(false);
}
```

### 3. **–î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è —Ä–æ–ª–∏**

**–ë–´–õ–û:**
```typescript
if (isLoading || userRole === null) {
  return null;
}
```

**–°–¢–ê–õ–û:**
```typescript
if (isLoading || userRole === null) {
  console.log("‚è≥ MainLayout: –ñ–¥—ë–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–æ–ª–∏...");
  return null;
}
```

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ï –õ–û–ì–ò

### ‚úÖ –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç (–∞–¥–º–∏–Ω):

```
üîç MainLayout: –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–æ–ª–∏...
üìä SESSION: { user: {...}, access_token: "..." }
üîë ACCESS TOKEN: eyJh...
‚ùå SESSION ERROR: null
üë§ MainLayout: User ID: xxx Email: saint@onaiacademy.kz
üì§ –ó–∞–ø—Ä–æ—Å –∫ profiles —Å headers...
üì• –û—Ç–≤–µ—Ç profiles: [{ role: 'admin' }]
‚ùå –û—à–∏–±–∫–∞ profiles: null
‚úÖ MainLayout: –†–æ–ª—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞: admin
üìã AppSidebar —Ä–æ–ª—å: admin  ‚Üê –ù–ï student!
‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—É–Ω–∫—Ç–æ–≤: 7 –¥–ª—è —Ä–æ–ª–∏: admin
```

### ‚ö†Ô∏è –ï—Å–ª–∏ –Ω–µ—Ç —Å–µ—Å—Å–∏–∏:

```
üîç MainLayout: –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–æ–ª–∏...
üìä SESSION: null
üîë ACCESS TOKEN: undefined
‚ùå SESSION ERROR: null
‚ö†Ô∏è MainLayout: –ù–µ—Ç —Å–µ—Å—Å–∏–∏, –æ—Å—Ç–∞–≤–ª—è–µ–º role = null
‚è≥ MainLayout: –ñ–¥—ë–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–æ–ª–∏...
(–∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è)
```

### ‚ùå –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ profiles:

```
üîç MainLayout: –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–æ–ª–∏...
üìä SESSION: { user: {...} }
...
üì• –û—Ç–≤–µ—Ç profiles: null
‚ùå –û—à–∏–±–∫–∞ profiles: { code: "406", message: "..." }
‚ùå MainLayout: –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è: ...
‚ö†Ô∏è MainLayout: –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–æ–ª–ª–±—ç–∫ –ø–æ email, —Ä–æ–ª—å = admin
‚úÖ MainLayout: –†–æ–ª—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞: admin (—á–µ—Ä–µ–∑ —Ñ–æ–ª–ª–±—ç–∫)
üìã AppSidebar —Ä–æ–ª—å: admin
```

---

## üéØ –ò–ù–°–¢–†–£–ö–¶–ò–Ø –î–õ–Ø –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø

### –®–ê–ì 1: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ dev server

```bash
# Ctrl+C
npm run dev
```

### –®–ê–ì 2: –û—á–∏—Å—Ç–∏ –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞

1. `F12` ‚Üí Application ‚Üí Storage ‚Üí **Clear site data**
2. `Ctrl+R`

### –®–ê–ì 3: –ó–∞–ª–æ–≥–∏–Ω—å—Å—è –∏ –ø—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏

1. –û—Ç–∫—Ä–æ–π `http://localhost:8080/login`
2. –ó–∞–ª–æ–≥–∏–Ω—å—Å—è –∫–∞–∫ –∞–¥–º–∏–Ω
3. –û—Ç–∫—Ä–æ–π –∫–æ–Ω—Å–æ–ª—å (`F12`)
4. –°–∫–æ–ø–∏—Ä—É–π –ª–æ–≥–∏ –∏ –ø—Ä–∏—à–ª–∏ –º–Ω–µ

### –®–ê–ì 4: –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –ù–ï–¢ "student"

–í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:

```
üìã AppSidebar —Ä–æ–ª—å: admin  ‚Üê –ë–ï–ó "student"!
‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—É–Ω–∫—Ç–æ–≤: 7 –¥–ª—è —Ä–æ–ª–∏: admin
```

**–ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**

```
‚ùå üìã AppSidebar —Ä–æ–ª—å: student  ‚Üê –ù–ï–¢ –¢–ê–ö–û–ì–û!
```

---

## üìÇ –ò–ó–ú–ï–ù–Å–ù–ù–´–ï –§–ê–ô–õ–´

1. **`src/components/app-sidebar.tsx`**
   - –ò–∑–º–µ–Ω—ë–Ω —Ç–∏–ø `role?: UserRole` ‚Üí `role: UserRole | null`
   - –£–±—Ä–∞–Ω –¥–µ—Ñ–æ–ª—Ç `"student"`
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è —Ä–æ–ª–∏

2. **`src/components/layouts/MainLayout.tsx`**
   - –£–±—Ä–∞–Ω–æ `setUserRole("student")` ‚Üí `setUserRole(null)`
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è —Ä–æ–ª–∏

---

## ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢

–¢–µ–ø–µ—Ä—å:
1. ‚úÖ –ù–µ—Ç –¥–µ—Ñ–æ–ª—Ç–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è `"student"`
2. ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–µ —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è –ø–æ–∫–∞ —Ä–æ–ª—å –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞
3. ‚úÖ –ê–¥–º–∏–Ω —Å—Ä–∞–∑—É –≤–∏–¥–∏—Ç –∞–¥–º–∏–Ω-–º–µ–Ω—é (–±–µ–∑ –º–µ—Ä—Ü–∞–Ω–∏—è —Å—Ç—É–¥–µ–Ω—Ç—Å–∫–∏–º)
4. ‚úÖ –ï—Å–ª–∏ –Ω–µ—Ç —Å–µ—Å—Å–∏–∏ ‚Üí –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–µ —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è –≤–æ–æ–±—â–µ

---

## üîç –ü–†–û–í–ï–†–ö–ê

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**

1. –õ–æ–≥–∏–Ω –ø–æ–¥ –∞–¥–º–∏–Ω–æ–º ‚Üí —Å–∞–π–¥–±–∞—Ä —Å 7 –ø—É–Ω–∫—Ç–∞–º–∏ (–±–µ–∑ –º–µ—Ä—Ü–∞–Ω–∏—è)
2. –õ–æ–≥–∏–Ω –ø–æ–¥ —Å—Ç—É–¥–µ–Ω—Ç–æ–º ‚Üí —Å–∞–π–¥–±–∞—Ä —Å 6 –ø—É–Ω–∫—Ç–∞–º–∏ (–±–µ–∑ "–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å")
3. –ù–µ—Ç —Å–µ—Å—Å–∏–∏ ‚Üí –ø—É—Å—Ç–æ–π —ç–∫—Ä–∞–Ω (–Ω–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è)

**–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ localStorage:**

```javascript
console.log('=== CHECK ===')
console.log('Token:', localStorage.getItem('supabase.auth.token'))
```

---

**–ö–æ–Ω–µ—Ü –æ—Ç—á—ë—Ç–∞**

