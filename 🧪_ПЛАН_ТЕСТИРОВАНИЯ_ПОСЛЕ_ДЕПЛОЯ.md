# üß™ –ü–õ–ê–ù –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø –ü–û–°–õ–ï –î–ï–ü–õ–û–Ø –ù–ê PRODUCTION

**–î–∞—Ç–∞**: 14 –¥–µ–∫–∞–±—Ä—è 2025  
**–¶–µ–ª—å**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–∞ production

---

## üìã –≠–¢–ê–ü–´ –î–ï–ü–õ–û–Ø –ò –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø

### –≠–¢–ê–ü 1: –î–ï–ü–õ–û–ô –ù–ê PRODUCTION

#### 1.1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ë–î –∏–Ω–¥–µ–∫—Å—ã –≤ Supabase ‚ö° –ö–†–ò–¢–ò–ß–ù–û
```sql
-- –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Supabase Production Dashboard
-- SQL Editor > New query

-- –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:
-- supabase/migrations/20251214_performance_indexes.sql

-- –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é (Run)
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∏–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã
SELECT 
  tablename,
  indexname,
  indexdef
FROM pg_indexes
WHERE tablename IN ('landing_leads', 'scheduled_notifications', 'unified_lead_tracking')
ORDER BY tablename, indexname;
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è**: 15 –Ω–æ–≤—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤

#### 1.2. Backend (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è)
```bash
# –ï—Å–ª–∏ backend –∏–∑–º–µ–Ω–∏–ª—Å—è - –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å
ssh onai-backend "cd /var/www/onai-integrator-login-main/backend && git pull && npm install && pm2 restart onai-backend"
```

#### 1.3. Frontend –Ω–∞ Vercel
```bash
# Vercel –¥–µ–ø–ª–æ–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ push –≤ main
# –ò–ª–∏ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é:
cd /Users/miso/onai-integrator-login
git status
# git push origin main  # –µ—Å–ª–∏ –µ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
```

---

## üß™ –≠–¢–ê–ü 2: –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò

### –¢–ï–°–¢ 1: API Response Time ‚ö°

**–¶–µ–ª—å**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ API –æ—Ç–≤–µ—á–∞–µ—Ç –±—ã—Å—Ç—Ä–æ (< 200ms)

**–ö–æ–º–∞–Ω–¥–∞**:
```bash
time curl -X POST https://api.onai.academy/api/landing/proftest \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Performance Test User",
    "email": "perftest_'$(date +%s)'@example.com",
    "phone": "+7777'$(date +%s | tail -c 8)'",
    "source": "proftest_performance_test",
    "answers": [0,1,2,0,1,2,0,1,2,0],
    "proftestAnswers": [
      {"question": "–¢–µ—Å—Ç 1", "answer": "A", "score": 0},
      {"question": "–¢–µ—Å—Ç 2", "answer": "B", "score": 1}
    ],
    "campaignSlug": "performance_test",
    "utmParams": {
      "utm_source": "test",
      "utm_medium": "performance",
      "utm_campaign": "optimization_test"
    },
    "metadata": {
      "userAgent": "curl/test",
      "timestamp": "'$(date -u +%Y-%m-%dT%H:%M:%SZ)'"
    }
  }'
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ `real` –≤—Ä–µ–º—è < **0.2s** (200ms)
- ‚úÖ HTTP Status: **200 OK**
- ‚úÖ Response —Å–æ–¥–µ—Ä–∂–∏—Ç `"success": true` –∏ `leadId`

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è**:
- –°–∫–æ—Ä–æ—Å—Ç—å Supabase insert
- Background tasks –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –æ—Ç–≤–µ—Ç
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### –¢–ï–°–¢ 2: –ë–î Query Performance üóÑÔ∏è

**–¶–µ–ª—å**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∏–Ω–¥–µ–∫—Å—ã —É—Å–∫–æ—Ä–∏–ª–∏ –∑–∞–ø—Ä–æ—Å—ã

**–ö–æ–º–∞–Ω–¥–∞** (–≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤ Supabase SQL Editor):

#### 2.1. –¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞ –ø–æ email
```sql
-- –î–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Index Scan
EXPLAIN ANALYZE 
SELECT * FROM landing_leads 
WHERE email = 'perftest_1702578000@example.com'
LIMIT 1;
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ –ü–ª–∞–Ω: `Index Scan using idx_landing_leads_email`
- ‚úÖ Execution Time: **< 10ms**
- ‚ùå –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: `Seq Scan` (—ç—Ç–æ –º–µ–¥–ª–µ–Ω–Ω–æ!)

#### 2.2. –¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞ –ø–æ phone
```sql
EXPLAIN ANALYZE 
SELECT * FROM landing_leads 
WHERE phone = '+77771234567'
LIMIT 1;
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ –ü–ª–∞–Ω: `Index Scan using idx_landing_leads_phone`
- ‚úÖ Execution Time: **< 10ms**

#### 2.3. –¢–µ—Å—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ –¥–∞—Ç–µ
```sql
EXPLAIN ANALYZE 
SELECT id, email, phone, created_at 
FROM landing_leads 
ORDER BY created_at DESC 
LIMIT 10;
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ –ü–ª–∞–Ω: `Index Scan using idx_landing_leads_created_at`
- ‚úÖ Execution Time: **< 20ms**

#### 2.4. –¢–µ—Å—Ç pending notifications
```sql
EXPLAIN ANALYZE 
SELECT * FROM scheduled_notifications 
WHERE status = 'pending' 
ORDER BY scheduled_for ASC 
LIMIT 10;
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ –ü–ª–∞–Ω: `Index Scan using idx_scheduled_notifications_pending`
- ‚úÖ Execution Time: **< 10ms**

---

### –¢–ï–°–¢ 3: Frontend Load Time & Performance üé®

**–¶–µ–ª—å**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–æ—Ñ—Ç–µ—Å—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±—ã—Å—Ç—Ä–æ –∏ –±–µ–∑ –ª–∞–≥–æ–≤

#### 3.1. Page Load Time

**–®–∞–≥–∏**:
1. –û—Ç–∫—Ä—ã—Ç—å Chrome DevTools (F12)
2. Network tab ‚Üí Disable cache ‚úÖ
3. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É: https://onai.academy/proftest/kenesary
4. –î–æ–∂–¥–∞—Ç—å—Å—è –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ DOMContentLoaded: **< 1s**
- ‚úÖ Load: **< 2s**
- ‚úÖ Largest Contentful Paint (LCP): **< 2.5s**
- ‚úÖ First Input Delay (FID): **< 100ms**
- ‚úÖ Cumulative Layout Shift (CLS): **< 0.1**

#### 3.2. FPS (Frames Per Second)

**–®–∞–≥–∏**:
1. Chrome DevTools ‚Üí Performance tab
2. –ù–∞–∂–∞—Ç—å Record (Ctrl+E)
3. –ü–æ–¥–æ–∂–¥–∞—Ç—å 5 —Å–µ–∫—É–Ω–¥ (–∞–Ω–∏–º–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç)
4. Stop recording
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å FPS –≤ –≥—Ä–∞—Ñ–∏–∫–µ

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ Desktop: **50-60 FPS** (–ø–ª–∞–≤–Ω–æ)
- ‚úÖ Mobile (< 768px): **–ê–Ω–∏–º–∞—Ü–∏–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã** (canvas.style.display = 'none')
- ‚úÖ –ù–µ—Ç –∫—Ä–∞—Å–Ω—ã—Ö –ª–∏–Ω–∏–π (dropped frames)

#### 3.3. Memory Leaks

**–®–∞–≥–∏**:
1. Chrome DevTools ‚Üí Memory tab
2. Take heap snapshot (–Ω–∞—á–∞–ª—å–Ω—ã–π)
3. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ–π 1 –º–∏–Ω—É—Ç—É
4. Take heap snapshot (—Ñ–∏–Ω–∞–ª—å–Ω—ã–π)
5. –°—Ä–∞–≤–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ –†–æ—Å—Ç –ø–∞–º—è—Ç–∏: **< 10MB** (–Ω–µ—Ç —É—Ç–µ—á–µ–∫)
- ‚úÖ Detached DOM nodes: **< 50** (–Ω–æ—Ä–º–∞–ª—å–Ω–æ)

#### 3.4. Mobile Performance

**–®–∞–≥–∏**:
1. Chrome DevTools ‚Üí Toggle device toolbar (Ctrl+Shift+M)
2. –í—ã–±—Ä–∞—Ç—å iPhone 12 Pro
3. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∞–Ω–∏–º–∞—Ü–∏–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ Canvas —ç–ª–µ–º–µ–Ω—Ç—ã: `display: none`
- ‚úÖ –ù–µ—Ç –∞–Ω–∏–º–∞—Ü–∏–π (–Ω–µ —Ç—Ä–∞—Ç–∏—Ç CPU/GPU)
- ‚úÖ Scroll –ø–ª–∞–≤–Ω—ã–π (60 FPS)

---

### –¢–ï–°–¢ 4: –ü–æ–ª–Ω–∞—è –í–æ—Ä–æ–Ω–∫–∞ (End-to-End) üéØ

**–¶–µ–ª—å**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Å—å user journey –æ—Ç –Ω–∞—á–∞–ª–∞ –¥–æ –∫–æ–Ω—Ü–∞

#### 4.1. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã

**–®–∞–≥–∏**:
1. –û—Ç–∫—Ä—ã—Ç—å https://onai.academy/proftest/kenesary
2. –ü—Ä–æ–π—Ç–∏ –≤—Å–µ 10 –≤–æ–ø—Ä–æ—Å–æ–≤
3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É:
   - –ò–º—è: `E2E Test User`
   - Email: `e2e_test_<timestamp>@example.com`
   - –¢–µ–ª–µ—Ñ–æ–Ω: `+7777<random>`
4. –ù–∞–∂–∞—Ç—å "–û—Ç–ø—Ä–∞–≤–∏—Ç—å"

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ –§–æ—Ä–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è **< 0.5s**
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è Success —Å–æ–æ–±—â–µ–Ω–∏–µ
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ Console

#### 4.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ë–î

**SQL**:
```sql
-- –ù–∞–π—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –ª–∏–¥
SELECT 
  id,
  name,
  email,
  phone,
  source,
  created_at,
  metadata->'proftestAnswers' as answers
FROM landing_leads
ORDER BY created_at DESC
LIMIT 1;
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ –õ–∏–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ `metadata->proftestAnswers` —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—Ç–≤–µ—Ç—ã
- ‚úÖ `source` = `proftest_kenesary`

#### 4.3. –ü—Ä–æ–≤–µ—Ä–∫–∞ scheduled_notifications

**SQL**:
```sql
-- –ù–∞–π—Ç–∏ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ª–∏–¥–∞
SELECT 
  id,
  lead_id,
  notification_type,
  status,
  scheduled_for,
  created_at
FROM scheduled_notifications
WHERE lead_id = (
  SELECT id FROM landing_leads ORDER BY created_at DESC LIMIT 1
);
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ –ù–∞–π–¥–µ–Ω–∞ 1 –∑–∞–ø–∏—Å—å
- ‚úÖ `notification_type` = `proftest_result`
- ‚úÖ `status` = `pending`
- ‚úÖ `scheduled_for` = `created_at + 10 –º–∏–Ω—É—Ç`

#### 4.4. –ü—Ä–æ–≤–µ—Ä–∫–∞ AmoCRM

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ AmoCRM Dashboard**:
1. –û—Ç–∫—Ä—ã—Ç—å https://onaiagencykz.amocrm.ru
2. –ù–∞–π—Ç–∏ –ª–∏–¥ –ø–æ email/phone
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–æ–∑–¥–∞–Ω

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ –õ–∏–¥ —Å–æ–∑–¥–∞–Ω –≤ AmoCRM
- ‚úÖ –ò–º—è, email, phone —Å–æ–≤–ø–∞–¥–∞—é—Ç
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ–≥–∏/–ø—Ä–∏–º–µ—á–∞–Ω–∏—è

---

### –¢–ï–°–¢ 5: Email –û—Ç–ø—Ä–∞–≤–∫–∞ (10 –º–∏–Ω—É—Ç) üìß

**–¶–µ–ª—å**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ email –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –∫—Ä–∞—Å–∏–≤—ã–º —à–∞–±–ª–æ–Ω–æ–º

**–®–∞–≥–∏**:
1. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –∑–∞—è–≤–∫—É —Å **—Ä–µ–∞–ª—å–Ω—ã–º email** (–≤–∞—à email)
2. –ü–æ–¥–æ–∂–¥–∞—Ç—å **10 –º–∏–Ω—É—Ç**
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å inbox

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ Email –ø–æ–ª—É—á–µ–Ω —á–µ—Ä–µ–∑ **~10 –º–∏–Ω—É—Ç**
- ‚úÖ –û—Ç: `OnAI Academy <no-reply@onai.academy>`
- ‚úÖ –¢–µ–º–∞: `–í–∞—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞`
- ‚úÖ **–ö—Ä–∞—Å–∏–≤—ã–π HTML —à–∞–±–ª–æ–Ω** (–Ω–µ –ø—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç!)
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "–ó–∞–±—Ä–∞—Ç—å –∫—É—Ä—Å" –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- ‚úÖ –°—Å—ã–ª–∫–∞ –≤–µ–¥–µ—Ç –Ω–∞ tracking URL: `https://api.onai.academy/api/landing/track/{leadId}?source=email`

**–ü—Ä–æ–≤–µ—Ä–∫–∞ tracking**:
```sql
-- –ü–æ—Å–ª–µ –∫–ª–∏–∫–∞ –ø–æ —Å—Å—ã–ª–∫–µ –≤ email
SELECT 
  email_clicked,
  email_clicked_at,
  click_count
FROM landing_leads
WHERE id = '<lead_id>';
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ `email_clicked` = `true`
- ‚úÖ `email_clicked_at` –∑–∞–ø–æ–ª–Ω–µ–Ω
- ‚úÖ `click_count` > 0

---

### –¢–ï–°–¢ 6: SMS –û—Ç–ø—Ä–∞–≤–∫–∞ üì±

**–¶–µ–ª—å**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ SMS –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å tracking

**–®–∞–≥–∏**:
1. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É —Å **—Ä–µ–∞–ª—å–Ω—ã–º —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º** (+7777...)
2. –ü–æ–¥–æ–∂–¥–∞—Ç—å **10 –º–∏–Ω—É—Ç**
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SMS

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ SMS –ø–æ–ª—É—á–µ–Ω–∞ —á–µ—Ä–µ–∑ **~10 –º–∏–Ω—É—Ç**
- ‚úÖ –¢–µ–∫—Å—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç tracking —Å—Å—ã–ª–∫—É
- ‚úÖ –°—Å—ã–ª–∫–∞: `https://api.onai.academy/api/landing/track/{leadId}?source=sms`

**–ü—Ä–æ–≤–µ—Ä–∫–∞ tracking**:
```sql
-- –ü–æ—Å–ª–µ –∫–ª–∏–∫–∞ –ø–æ —Å—Å—ã–ª–∫–µ –≤ SMS
SELECT 
  sms_clicked,
  sms_clicked_at,
  click_count
FROM landing_leads
WHERE id = '<lead_id>';
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ `sms_clicked` = `true`
- ‚úÖ `sms_clicked_at` –∑–∞–ø–æ–ª–Ω–µ–Ω
- ‚úÖ `click_count` —É–≤–µ–ª–∏—á–µ–Ω

---

### –¢–ï–°–¢ 7: –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç üéì

**–¶–µ–ª—å**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ tracking —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–®–∞–≥–∏**:
1. –ö–ª–∏–∫–Ω—É—Ç—å –ø–æ —Å—Å—ã–ª–∫–µ –∏–∑ email –∏–ª–∏ SMS
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–µ–ª —Ä–µ–¥–∏—Ä–µ–∫—Ç

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞: `https://onai.academy/integrator/expresscourse`
- ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è (200 OK)
- ‚úÖ –í –ë–î –æ–±–Ω–æ–≤–ª–µ–Ω `click_count`

---

### –¢–ï–°–¢ 8: –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) üí™

**–¶–µ–ª—å**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –≤—ã–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç**: Apache Bench –∏–ª–∏ k6

#### –í–∞—Ä–∏–∞–Ω—Ç –ê: Apache Bench
```bash
# 100 –∑–∞–ø—Ä–æ—Å–æ–≤, 10 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
ab -n 100 -c 10 -p proftest_payload.json -T application/json \
  https://api.onai.academy/api/landing/proftest
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã: **200 OK**
- ‚úÖ –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è: **< 300ms**
- ‚úÖ 99th percentile: **< 500ms**
- ‚úÖ Errors: **0%**

#### –í–∞—Ä–∏–∞–Ω—Ç –ë: k6 (–±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π)
```javascript
// load-test.js
import http from 'k6/http';
import { check, sleep } from 'k6';

export let options = {
  vus: 10, // 10 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  duration: '30s', // 30 —Å–µ–∫—É–Ω–¥
};

export default function() {
  const payload = JSON.stringify({
    name: 'Load Test User',
    email: `loadtest_${Date.now()}@example.com`,
    phone: `+7777${Math.floor(Math.random() * 10000000)}`,
    answers: [0,1,2,0,1,2,0,1,2,0],
  });

  const res = http.post(
    'https://api.onai.academy/api/landing/proftest',
    payload,
    { headers: { 'Content-Type': 'application/json' } }
  );

  check(res, {
    'status is 200': (r) => r.status === 200,
    'response time < 500ms': (r) => r.timings.duration < 500,
  });

  sleep(1);
}
```

**–ó–∞–ø—É—Å–∫**:
```bash
k6 run load-test.js
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞**:
- ‚úÖ Success rate: **> 99%**
- ‚úÖ P95 response time: **< 500ms**
- ‚úÖ P99 response time: **< 1000ms**

---

## üìä CHECKLIST –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø

### –î–µ–ø–ª–æ–π:
- [ ] –ë–î –∏–Ω–¥–µ–∫—Å—ã –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –≤ Supabase
- [ ] Backend –Ω–∞ production –∞–∫—Ç—É–∞–ª–µ–Ω
- [ ] Frontend –Ω–∞ Vercel –∑–∞–¥–µ–ø–ª–æ–µ–Ω

### Performance:
- [ ] API response time < 200ms
- [ ] –ë–î queries —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ < 10ms
- [ ] Frontend load time < 2s
- [ ] FPS 50-60 (desktop)
- [ ] –ê–Ω–∏–º–∞—Ü–∏–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã (mobile)
- [ ] –ù–µ—Ç memory leaks

### Functionality:
- [ ] –§–æ—Ä–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
- [ ] Scheduled notifications —Å–æ–∑–¥–∞—é—Ç—Å—è
- [ ] AmoCRM –ø–æ–ª—É—á–∞–µ—Ç –ª–∏–¥–∞
- [ ] Email –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è (10 –º–∏–Ω)
- [ ] SMS –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è (10 –º–∏–Ω)
- [ ] Tracking —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç

### Stress Test:
- [ ] –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–π–¥–µ–Ω–æ
- [ ] 99% success rate
- [ ] < 500ms response time (p95)

---

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

| –ú–µ—Ç—Ä–∏–∫–∞ | –¶–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---------|------------------|--------|
| API Response Time | < 200ms | ‚è≥ |
| –ë–î Email Query | < 10ms | ‚è≥ |
| –ë–î Phone Query | < 10ms | ‚è≥ |
| Frontend Load Time | < 2s | ‚è≥ |
| FPS (desktop) | 50-60 | ‚è≥ |
| Email Delivery | ~10 min | ‚è≥ |
| SMS Delivery | ~10 min | ‚è≥ |
| Tracking Click | Works | ‚è≥ |
| Success Rate | > 99% | ‚è≥ |

---

## üö® –ß–¢–û –î–ï–õ–ê–¢–¨ –ï–°–õ–ò –¢–ï–°–¢ –ü–†–û–í–ê–õ–ò–õ–°–Ø

### –ü—Ä–æ–±–ª–µ–º–∞: API –º–µ–¥–ª–µ–Ω–Ω—ã–π (> 500ms)
**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `ssh onai-backend "pm2 logs onai-backend | tail -100"`
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å: `pm2 restart onai-backend`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Supabase –∏–Ω–¥–µ–∫—Å—ã –ø—Ä–∏–º–µ–Ω–µ–Ω—ã

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–î –∑–∞–ø—Ä–æ—Å—ã –º–µ–¥–ª–µ–Ω–Ω—ã–µ (> 100ms)
**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∏–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã (SQL –≤—ã—à–µ)
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å ANALYZE: `ANALYZE landing_leads;`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å EXPLAIN PLAN

### –ü—Ä–æ–±–ª–µ–º–∞: Email –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç
**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `scheduled_notifications` —Ç–∞–±–ª–∏—Ü—É
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ backend
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å RESEND_API_KEY –≤–∞–ª–∏–¥–µ–Ω
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Resend Dashboard

### –ü—Ä–æ–±–ª–µ–º–∞: Frontend –ª–∞–≥–∞–µ—Ç
**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Console –Ω–∞ –æ—à–∏–±–∫–∏
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∞–Ω–∏–º–∞—Ü–∏–∏ –æ—Ç–∫–ª—é—á–∞—é—Ç—Å—è –Ω–∞ mobile
3. –û—á–∏—Å—Ç–∏—Ç—å cache –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å

---

**Next Step**: –ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ! üöÄ







