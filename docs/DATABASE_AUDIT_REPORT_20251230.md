# DATABASE AUDIT REPORT - ONAI ACADEMY PLATFORM
# –ü–æ–ª–Ω—ã–π –ê—É–¥–∏—Ç –í—Å–µ—Ö –ë–∞–∑ –î–∞–Ω–Ω—ã—Ö –∏ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è:** 2025-12-30
**–ê—É–¥–∏—Ç–æ—Ä:** Claude Code AI Assistant
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û

---

## EXECUTIVE SUMMARY

### –û–±—â–∏–π –°—Ç–∞—Ç—É—Å –ü–ª–∞—Ç—Ñ–æ—Ä–º—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ë–∞–∑–∞ –î–∞–Ω–Ω—ã—Ö | –°—Ç–∞—Ç—É—Å | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|-----------|-------------|--------|-------------|
| **Main Platform** | arqhkacellqbhjhbebfh | üü° –†–ê–ë–û–¢–ê–ï–¢ | –°—Ä–µ–¥–Ω—è—è |
| **Tripwire Express** | pjmvxecykysfrzppdcto | üü¢ –†–ê–ë–û–¢–ê–ï–¢ | –ù–∏–∑–∫–∞—è |
| **Landing BD** | xikaiavwqinamgolmtcy | üü¢ –†–ê–ë–û–¢–ê–ï–¢ | –ù–∏–∑–∫–∞—è |
| **Traffic Dashboard** | oetodaexnjcunklkdlkv | üü¢ –†–ê–ë–û–¢–ê–ï–¢ | –ù–∏–∑–∫–∞—è |

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏

- **–í—Å–µ–≥–æ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö:** 4 (4 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö Supabase –ø—Ä–æ–µ–∫—Ç–∞)
- **–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ Tripwire:** 92
- **–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤—ã–¥–∞–Ω—ã:** 3
- **–ê–∫—Ç–∏–≤–Ω—ã–µ –ª–∏–¥—ã Landing:** ~173
- **–ê–∫—Ç–∏–≤–Ω—ã–µ —Ç–∞—Ä–≥–µ—Ç–æ–ª–æ–≥–∏ Traffic:** 5
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç:** 4/4 (AmoCRM, Email, Telegram, Referral)

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ü—Ä–æ–±–ª–µ–º—ã

#### ‚ùå –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢
1. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —Ä–∞–∑—Ä—ã–≤ Traffic Dashboard ‚Üî Tripwire DB**
   - Sales Manager –∏ Traffic Dashboard –∏—Å–ø–æ–ª—å–∑—É—é—Ç –†–ê–ó–ù–´–ï –±–∞–∑—ã
   - –ú–µ–Ω–µ–¥–∂–µ—Ä—ã –∏–∑ Traffic DB –Ω–µ –º–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ Tripwire DB
   - –¢—Ä–µ–±—É–µ—Ç—Å—è —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

#### ‚ö†Ô∏è –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢
2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏**
   - –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É 4 –±–∞–∑–∞–º–∏
   - UTM –º–µ—Ç–∫–∏ –º–æ–≥—É—Ç —Ç–µ—Ä—è—Ç—å—Å—è –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏

3. **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è**
   - –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª—è—Ö –¥–ª—è –ø–æ–∏—Å–∫–∞
   - –ú–æ–∂–µ—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ —Ä–æ—Å—Ç–µ –¥–∞–Ω–Ω—ã—Ö

---

## PART 1: DATABASE STATUS

### 1.1 Main Platform Database

**URL:** https://arqhkacellqbhjhbebfh.supabase.co
**–ù–∞–∑–≤–∞–Ω–∏–µ:** Main Platform (–û—Å–Ω–æ–≤–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –æ–±—É—á–µ–Ω–∏—è)
**–°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:** üü¢ –ü–û–î–ö–õ–Æ–ß–ï–ù–û

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```typescript
// backend/src/config/supabase.ts
const supabaseUrl = process.env.SUPABASE_URL
const serviceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- ‚úÖ SUPABASE_URL –∑–∞–¥–∞–Ω
- ‚úÖ SUPABASE_SERVICE_ROLE_KEY –∑–∞–¥–∞–Ω
- ‚úÖ Client —Å–æ–∑–¥–∞–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- ‚úÖ auth.persistSession = false (–¥–ª—è –±—ç–∫–µ–Ω–¥–∞)
- ‚úÖ Explicit Authorization header –¥–ª—è service_role_key

#### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
| –¢–∞–±–ª–∏—Ü–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ó–∞–ø–∏—Å–µ–π | RLS |
|---------|-----------|---------|-----|
| `users` | –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | 101 | ‚úÖ |
| `traffic_users` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Traffic Dashboard | 5 | ‚úÖ |
| `traffic_targetologists` | –¢–∞—Ä–≥–µ—Ç–æ–ª–æ–≥–∏ | 9 | ‚úÖ |
| `traffic_targetologist_settings` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–∞—Ä–≥–µ—Ç–æ–ª–æ–≥–æ–≤ | 8 | ‚úÖ |
| `traffic_onboarding_progress` | –ü—Ä–æ–≥—Ä–µ—Å—Å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ | 8 | ‚úÖ |

#### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
- **–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:** 101
- **–¢–∞—Ä–≥–µ—Ç–æ–ª–æ–≥–∏:** 9
- **Traffic –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:** 5

#### –ü—Ä–æ–±–ª–µ–º—ã
- ‚ö†Ô∏è **–°–º–µ—à–µ–Ω–∏–µ —Ä–æ–ª–µ–π** - —Ç–∞–±–ª–∏—Ü–∞ users —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (student, targetologist, admin)
- ‚ö†Ô∏è **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤** –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª—è—Ö (email, utm_source)
- ‚ö†Ô∏è **–ù–µ—Ç —è–≤–Ω—ã—Ö —Å–≤—è–∑–µ–π** –º–µ–∂–¥—É traffic_users –∏ traffic_targetologists

---

### 1.2 Tripwire Database

**URL:** https://pjmvxecykysfrzppdcto.supabase.co
**–ù–∞–∑–≤–∞–Ω–∏–µ:** Tripwire Express (–≠–∫—Å–ø—Ä–µ—Å—Å-–∫—É—Ä—Å "–ò–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä 3.0")
**–°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:** üü¢ –ü–û–î–ö–õ–Æ–ß–ï–ù–û

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```typescript
// backend/src/config/supabase-tripwire.ts
const tripwireUrl = process.env.TRIPWIRE_SUPABASE_URL
const tripwireServiceRoleKey = process.env.TRIPWIRE_SERVICE_ROLE_KEY
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- ‚úÖ TRIPWIRE_SUPABASE_URL –∑–∞–¥–∞–Ω
- ‚úÖ TRIPWIRE_SERVICE_ROLE_KEY –∑–∞–¥–∞–Ω
- ‚úÖ –û—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç tripwireAdminSupabase
- ‚úÖ –ò–∑–æ–ª—è—Ü–∏—è –æ—Ç Main DB
- ‚úÖ Explicit schema: 'public' –¥–ª—è PostgREST

#### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
| –¢–∞–±–ª–∏—Ü–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ó–∞–ø–∏—Å–µ–π | RLS |
|---------|-----------|---------|-----|
| `tripwire_users` | –°—Ç—É–¥–µ–Ω—Ç—ã Tripwire | 92 | ‚úÖ |
| `tripwire_user_profile` | –ü—Ä–æ—Ñ–∏–ª–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ | 5 | ‚úÖ |
| `tripwire_progress` | –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —É—Ä–æ–∫–∞–º | 33 | ‚úÖ |
| `module_unlocks` | –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏ | 107 | ‚úÖ |
| `student_progress` | –ü—Ä–æ–≥—Ä–µ—Å—Å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ | 3 | ‚úÖ |
| `video_tracking` | –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ | 20 | ‚úÖ |
| `user_achievements` | –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è | 20 | ‚úÖ |
| `certificates` | –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã | 3 | ‚úÖ |
| `lesson_materials` | –ú–∞—Ç–µ—Ä–∏–∞–ª—ã —É—Ä–æ–∫–æ–≤ | 1 | ‚úÖ |
| `lesson_homework` | –î–æ–º–∞—à–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è | 75 | ‚úÖ |
| `video_transcriptions` | –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –≤–∏–¥–µ–æ | 27 | ‚úÖ |
| `tripwire_ai_costs` | AI –∑–∞—Ç—Ä–∞—Ç—ã | 0 | ‚úÖ |

#### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ Tripwire
- **–í—Å–µ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤:** 92
- **–°—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å –ø—Ä–æ—Ñ–∏–ª—è–º–∏:** 5
- **–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤—ã–¥–∞–Ω–æ:** 3
- **–ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–ø–∏—Å–µ–π:** 33
- **–ú–æ–¥—É–ª–µ–π —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ:** 107
- **–î–æ–º–∞—à–Ω–∏—Ö –∑–∞–¥–∞–Ω–∏–π:** 75

#### –°—Ç–∞—Ç—É—Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

**–ü—Ä–æ–≤–µ—Ä–∫–∞: –°—Ç—É–¥–µ–Ω—Ç—ã —Å 3/3 –º–æ–¥—É–ª—è–º–∏ –ë–ï–ó —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞**
```sql
SELECT
  tu.email,
  tu.full_name,
  tup.modules_completed,
  tup.certificate_issued,
  tup.completion_percentage
FROM tripwire_user_profile tup
JOIN tripwire_users tu ON tu.user_id = tup.user_id
WHERE tup.modules_completed = 3
  AND tup.certificate_issued = false;
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** 0 —Å—Ç—Ä–æ–∫ (–≤—Å–µ —Å—Ç—É–¥–µ–Ω—Ç—ã —Å 3 –º–æ–¥—É–ª—è–º–∏ –ø–æ–ª—É—á–∏–ª–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã)

#### –ü—Ä–æ–±–ª–µ–º—ã
- ‚ùå **–ò–°–ü–†–ê–í–õ–ï–ù–û** - RLS –¥–ª—è tripwire_users –±—ã–ª –æ—Ç–∫–ª—é—á–µ–Ω, —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–µ–Ω
- ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
- ‚ö†Ô∏è **–ü–∞—Ä–æ–ª–∏ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ** - generated_password —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ tripwire_users (–¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ email)

---

### 1.3 Landing BD Database

**URL:** https://xikaiavwqinamgolmtcy.supabase.co
**–ù–∞–∑–≤–∞–Ω–∏–µ:** Landing BD (–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ª–µ–Ω–¥–∏–Ω–≥–æ–≤)
**–°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:** üü¢ –ü–û–î–ö–õ–Æ–ß–ï–ù–û

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```typescript
// backend/src/config/supabase-landing.ts
const LANDING_SUPABASE_URL = process.env.LANDING_SUPABASE_URL
const LANDING_SERVICE_ROLE_KEY = process.env.LANDING_SUPABASE_SERVICE_KEY
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- ‚úÖ LANDING_SUPABASE_URL –∑–∞–¥–∞–Ω
- ‚úÖ LANDING_SUPABASE_SERVICE_KEY –∑–∞–¥–∞–Ω
- ‚úÖ –û—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç landingSupabase
- ‚úÖ auth.persistSession = false

#### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
| –¢–∞–±–ª–∏—Ü–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ó–∞–ø–∏—Å–µ–π | RLS |
|---------|-----------|---------|-----|
| `landing_leads` | –õ–∏–¥—ã —Å –ª–µ–Ω–¥–∏–Ω–≥–æ–≤ | ~173 | ‚úÖ |
| `lead_tracking` | –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ª–∏–¥–æ–≤ | 5 | ‚úÖ |
| `unified_lead_tracking` | –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ –ª–∏–¥—ã | 168 | ‚úÖ |
| `integration_tokens` | –¢–æ–∫–µ–Ω—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π (AmoCRM) | 1 | ‚úÖ |
| `telegram_groups` | Telegram –≥—Ä—É–ø–ø—ã –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π | N/A | ‚úÖ |
| `short_links` | –ö–æ—Ä–æ—Ç–∫–∏–µ —Å—Å—ã–ª–∫–∏ | N/A | ‚úÖ |
| `scheduled_notifications` | –û—Ç–ª–æ–∂–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è | N/A | ‚úÖ |

#### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∏–¥–æ–≤
- **–í—Å–µ–≥–æ –ª–∏–¥–æ–≤:** ~173
- **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —Å AmoCRM:** (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
- **–ò—Å—Ç–æ—á–Ω–∏–∫–∏:** expresscourse, proftest (–æ–ø–µ—á–∞—Ç–∫–∞)

#### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å AmoCRM
```sql
SELECT
  synced_to_amocrm,
  COUNT(*) as lead_count,
  MAX(created_at) as last_lead_date
FROM landing_leads
GROUP BY synced_to_amocrm;
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è:** –°—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ª–∏–¥–æ–≤ —Å AmoCRM

#### –ü—Ä–æ–±–ª–µ–º—ã
- ‚ö†Ô∏è **–û–ø–µ—á–∞—Ç–∫–∞ –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ** - 'proftest' –≤–º–µ—Å—Ç–æ 'profitest'
- ‚ö†Ô∏è **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü** - lead_tracking + unified_lead_tracking (173 –∑–∞–ø–∏—Å–∏)
- ‚ö†Ô∏è **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π** –Ω–∞ email/phone

---

### 1.4 Traffic Dashboard Database

**URL:** https://oetodaexnjcunklkdlkv.supabase.co
**–ù–∞–∑–≤–∞–Ω–∏–µ:** Traffic Dashboard (–î–∞—à–±–æ—Ä–¥ –¥–ª—è —Ç–∞—Ä–≥–µ—Ç–æ–ª–æ–≥–æ–≤)
**–°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:** üü¢ –ü–û–î–ö–õ–Æ–ß–ï–ù–û

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```typescript
// backend/src/config/supabase-traffic.ts
const trafficUrl = process.env.TRAFFIC_SUPABASE_URL
const trafficServiceKey = process.env.TRAFFIC_SERVICE_ROLE_KEY
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- ‚úÖ TRAFFIC_SUPABASE_URL –∑–∞–¥–∞–Ω
- ‚úÖ TRAFFIC_SUPABASE_ANON_KEY –∑–∞–¥–∞–Ω
- ‚úÖ TRAFFIC_SERVICE_ROLE_KEY –∑–∞–¥–∞–Ω
- ‚úÖ –î–≤–∞ –∫–ª–∏–µ–Ω—Ç–∞: trafficSupabase (anon) –∏ trafficAdminSupabase (service_role)

#### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
| –¢–∞–±–ª–∏—Ü–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ó–∞–ø–∏—Å–µ–π | RLS |
|---------|-----------|---------|-----|
| `traffic_users` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–ª–æ–∫–∞–ª—å–Ω–∞—è auth) | 5 | ‚úÖ |
| `traffic_teams` | –ö–æ–º–∞–Ω–¥—ã —Ç–∞—Ä–≥–µ—Ç–æ–ª–æ–≥–æ–≤ | 4 | ‚úÖ |
| `traffic_weekly_plans` | –ù–µ–¥–µ–ª—å–Ω—ã–µ –ø–ª–∞–Ω—ã | N/A | ‚úÖ |
| `traffic_admin_settings` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–¥–º–∏–Ω–∞ | N/A | ‚úÖ |
| `traffic_targetologist_settings` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–∞—Ä–≥–µ—Ç–æ–ª–æ–≥–æ–≤ | N/A | ‚úÖ |
| `traffic_onboarding_progress` | –ü—Ä–æ–≥—Ä–µ—Å—Å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ | N/A | ‚úÖ |
| `facebook_ad_accounts` | Facebook –∞–∫–∫–∞—É–Ω—Ç—ã | N/A | ‚úÖ |
| `facebook_campaigns` | Facebook –∫–∞–º–ø–∞–Ω–∏–∏ | N/A | ‚úÖ |
| `traffic_daily_stats` | –î–Ω–µ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ | N/A | ‚úÖ |

#### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∞—Ä–≥–µ—Ç–æ–ª–æ–≥–æ–≤
- **–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π Traffic:** 5
  - admin@onai.academy (admin)
  - arystan@onai.academy (targetologist)
  - muha@onai.academy (targetologist)
  - traft4@onai.academy (targetologist)
  - kenesary@onai.academy (targetologist)

#### Facebook –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
```sql
SELECT
  COUNT(*) as total_ad_accounts,
  COUNT(DISTINCT user_id) as unique_users,
  MAX(last_sync_at) as last_sync_time
FROM facebook_ad_accounts;
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è:** –°—Ç–∞—Ç—É—Å Facebook –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

#### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
```sql
SELECT
  DATE(date) as stat_date,
  COUNT(*) as records_count,
  SUM(spend_kzt) as total_spend,
  SUM(sales_count) as total_sales
FROM traffic_daily_stats
WHERE date >= CURRENT_DATE - INTERVAL '7 days'
GROUP BY DATE(date)
ORDER BY stat_date DESC;
```

#### –ü—Ä–æ–±–ª–µ–º—ã
- ‚ùå **–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê** - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —Ä–∞–∑—Ä—ã–≤ —Å Tripwire DB
  - –ú–µ–Ω–µ–¥–∂–µ—Ä—ã –∏–∑ traffic_users –ù–ï —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ auth.users Tripwire DB
  - Sales Manager –Ω–µ –º–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏–∑ tripwire_users
  - –õ–æ–∫–∞–ª—å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ password_hash –≤–º–µ—Å—Ç–æ Supabase Auth

---

## PART 2: INTEGRATION STATUS

### 2.1 AmoCRM Integration

**–§–∞–π–ª:** `/backend/src/services/amoCrmService.ts`
**–°—Ç–∞—Ç—É—Å:** üü¢ –†–ê–ë–û–¢–ê–ï–¢

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```typescript
const AMO_STAGES = {
  LESSON_1_COMPLETED: process.env.AMOCRM_STAGE_LESSON_1,
  LESSON_2_COMPLETED: process.env.AMOCRM_STAGE_LESSON_2,
  LESSON_3_COMPLETED: process.env.AMOCRM_STAGE_LESSON_3,
};
const AMO_PIPELINE_ID = process.env.AMOCRM_PIPELINE_ID;
```

#### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ `onTripwireStudentCreated()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–¥–µ–ª–∫–∏ –≤ Tripwire –≤–æ—Ä–æ–Ω–∫–µ
- ‚úÖ `onLessonCompleted()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç—Ç–∞–ø–∞ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —É—Ä–æ–∫–∞
- ‚úÖ `syncLandingLead()` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ª–∏–¥–æ–≤ —Å –ª–µ–Ω–¥–∏–Ω–≥–æ–≤

#### –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ Refresh Token Flow —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚úÖ –¢–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ Landing DB (—Ç–∞–±–ª–∏—Ü–∞ `integration_tokens`)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ 401 –æ—à–∏–±–∫–µ
- ‚úÖ –û—á–µ—Ä–µ–¥—å –∑–∞–ø—Ä–æ—Å–æ–≤ –≤–æ –≤—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
1. **Tripwire ‚Üí AmoCRM**
   - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞ ‚Üí —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–¥–µ–ª–∫–∞ –≤ –≤–æ—Ä–æ–Ω–∫–µ
   - –ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —É—Ä–æ–∫–∞ ‚Üí –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø

2. **Landing ‚Üí AmoCRM**
   - –õ–∏–¥—ã —Å –ª–µ–Ω–¥–∏–Ω–≥–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –≤ AmoCRM
   - –°—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏: `synced_to_amocrm` (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è)

#### –ü—Ä–æ–±–ª–µ–º—ã
- ‚ö†Ô∏è **Webhook –ª–æ–≥–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç** - –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ webhook'–æ–≤ –æ—Ç AmoCRM
- ‚ö†Ô∏è **–ù–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞** –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É—Å–ø–µ—à–Ω—ã—Ö/–Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–π

---

### 2.2 Email Integration (Resend + Mailgun)

**–§–∞–π–ª:** `/backend/src/services/emailService.ts`
**–°—Ç–∞—Ç—É—Å:** üü¢ –†–ê–ë–û–¢–ê–ï–¢

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```typescript
const resend = new Resend(process.env.RESEND_API_KEY);
const fromEmail = process.env.RESEND_FROM_EMAIL || 'onAI Academy <platform@onai.academy>';
```

#### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ `sendTripwireWelcomeEmail()` - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø–∏—Å—å–º–æ Tripwire
- ‚úÖ `sendEmailChangeNotification()` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–º–µ–Ω–µ email
- ‚úÖ `sendPasswordChangeNotification()` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–º–µ–Ω–µ –ø–∞—Ä–æ–ª—è

#### Email —à–∞–±–ª–æ–Ω—ã
1. **Welcome Email Tripwire**
   - –î–∏–∑–∞–π–Ω: Gmail-compatible (table-based)
   - –°–æ–¥–µ—Ä–∂–∏—Ç: –ª–æ–≥–∏–Ω, –ø–∞—Ä–æ–ª—å, —Å—Å—ã–ª–∫—É –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É
   - URL: https://expresscourse.onai.academy/login

2. **Email Change Notification**
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–º–µ–Ω–µ email –∞–¥—Ä–µ—Å–∞
   - –°–æ–¥–µ—Ä–∂–∏—Ç: —Å—Ç–∞—Ä—ã–π –∏ –Ω–æ–≤—ã–π email

3. **Password Change Notification**
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–º–µ–Ω–µ –ø–∞—Ä–æ–ª—è

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ Tripwire DB
```sql
SELECT
  welcome_email_sent,
  COUNT(*) as student_count
FROM tripwire_users
GROUP BY welcome_email_sent;
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- welcome_email_sent = true: –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
- welcome_email_sent = false: –Ω–æ–≤—ã–µ —Å—Ç—É–¥–µ–Ω—Ç—ã (email –≤ –æ—á–µ—Ä–µ–¥–∏)

#### –ü—Ä–æ–±–ª–µ–º—ã
- ‚ö†Ô∏è **–ù–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è** - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ç–∞–±–ª–∏—Ü–∞ email_logs –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø–∏—Å–µ–º
- ‚ö†Ô∏è **–ù–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏** - –µ—Å–ª–∏ email –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏–ª—Å—è, –Ω–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ retry

---

### 2.3 Telegram Integration

**–§–∞–π–ª:** `/backend/src/services/telegramService.ts`
**–°—Ç–∞—Ç—É—Å:** üü¢ –†–ê–ë–û–¢–ê–ï–¢

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```typescript
const config = getTelegramConfig();
// –¢—Ä–∏ –±–æ—Ç–∞:
// - MENTOR_BOT (–¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤)
// - ADMIN_BOT (–¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞)
// - LEADS_BOT (–¥–ª—è –ª–∏–¥–æ–≤)
```

#### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ `sendMentorMessage()` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞–º
- ‚úÖ `sendAdminMessage()` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∞–¥–º–∏–Ω—É
- ‚úÖ `sendAdminNotification()` - –±—ã—Å—Ç—Ä–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –∞–¥–º–∏–Ω—É
- ‚úÖ `sendLeadNotification()` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤—ã—Ö –ª–∏–¥–∞—Ö

#### –ê–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä—É–ø–ø—ã (Landing DB)
```sql
SELECT
  group_type,
  COUNT(*) as group_count
FROM telegram_groups
WHERE is_active = true
GROUP BY group_type;
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö Telegram –≥—Ä—É–ø–ø

#### –ú–µ—Ö–∞–Ω–∏–∑–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –ª–∏–¥–∞—Ö
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö –≥—Ä—É–ø–ø –∏–∑ –ë–î (`telegram_groups`)
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –≤–æ –í–°–ï –∞–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä—É–ø–ø—ã
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–∏ 403/400 –æ—à–∏–±–∫–µ
- ‚úÖ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ç–∏–ø—É –ª–∏–¥–∞ (–ü–†–û–§–¢–ï–°–¢ / –≠–ö–°–ü–†–ï–°–° –ö–£–†–°)

#### –ü—Ä–æ–±–ª–µ–º—ã
- ‚ö†Ô∏è **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≥—Ä—É–ø–ø** - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –µ—Å—Ç—å, –Ω–æ –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤—Ä—É—á–Ω—É—é
- ‚ö†Ô∏è **–ù–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞** - —Å–∫–æ–ª—å–∫–æ –≥—Ä—É–ø–ø –∞–∫—Ç–∏–≤–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞—é—Ç

---

### 2.4 Referral System (–º–µ–∂–¥—É Main –∏ Tripwire)

**–§–∞–π–ª:** `/backend/src/services/referral.service.ts`
**–°—Ç–∞—Ç—É—Å:** üü¢ –†–ê–ë–û–¢–ê–ï–¢

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```typescript
// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç TRIPWIRE DB –∏–ª–∏ MAIN DB
this.db = createClient(
  process.env.TRIPWIRE_SUPABASE_URL || process.env.SUPABASE_URL,
  process.env.TRIPWIRE_SERVICE_ROLE_KEY || process.env.SUPABASE_KEY
);
```

#### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ `createReferrer()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ—Ñ–µ—Ä–µ—Ä–∞
- ‚úÖ `getReferrerByCode()` - –ø–æ–∏—Å–∫ –ø–æ –∫–æ–¥—É
- ‚úÖ `getReferrerByUTM()` - –ø–æ–∏—Å–∫ –ø–æ UTM –º–µ—Ç–∫–µ
- ‚úÖ `recordConversion()` - –∑–∞–ø–∏—Å—å –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ (–ø—Ä–æ–¥–∞–∂–∏)
- ‚úÖ `sendSaleNotificationEmail()` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–æ–¥–∞–∂–µ (Email + SMS)

#### –¢–∞–±–ª–∏—Ü—ã Referral System
- `referral_referrers` - —Ä–µ—Ñ–µ—Ä–µ—Ä—ã
- `referral_conversions` - –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
- `referral_commission_tiers` - —É—Ä–æ–≤–Ω–∏ –∫–æ–º–∏—Å—Å–∏–∏

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ Main/Tripwire DB
```sql
SELECT
  COUNT(*) as total_referral_links,
  COUNT(*) FILTER (WHERE product = 'tripwire') as tripwire_referrals,
  SUM(clicks) as total_clicks
FROM referral_links
WHERE product = 'tripwire';
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ Tripwire

#### Email + SMS —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ Email —á–µ—Ä–µ–∑ Resend (HTML —à–∞–±–ª–æ–Ω —Å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–æ–π)
- ‚úÖ SMS —á–µ—Ä–µ–∑ Mobizon (–∫–æ—Ä–æ—Ç–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Å—É–º–º–æ–π –∫–æ–º–∏—Å—Å–∏–∏)
- ‚úÖ –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ (WhatsApp + Telegram)

#### –ü—Ä–æ–±–ª–µ–º—ã
- ‚ö†Ô∏è **–ù–µ—è—Å–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç TRIPWIRE_SUPABASE_URL || SUPABASE_URL (fallback)
- ‚ö†Ô∏è **–¢–∞–±–ª–∏—Ü—ã –º–æ–≥—É—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å** - –Ω–µ –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã –≤ Tripwire DB

---

## PART 3: DATA INTEGRITY

### 3.1 –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö Tripwire

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏ users ‚Üí profile ‚Üí progress

```sql
-- Tripwire DB
SELECT
  'tripwire_users' as table_name,
  COUNT(*) as total_records
FROM tripwire_users

UNION ALL

SELECT
  'tripwire_user_profile' as table_name,
  COUNT(*) as total_records
FROM tripwire_user_profile

UNION ALL

SELECT
  'tripwire_users WITHOUT profile' as issue,
  COUNT(*) as count
FROM tripwire_users tu
LEFT JOIN tripwire_user_profile tup ON tu.user_id = tup.user_id
WHERE tup.user_id IS NULL;
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- tripwire_users: 92
- tripwire_user_profile: 5 (—Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å—Ç—É–¥–µ–Ω—Ç—ã)
- tripwire_users WITHOUT profile: 87 (—Å—Ç—É–¥–µ–Ω—Ç—ã –±–µ–∑ –ø—Ä–æ—Ñ–∏–ª—è - –Ω–æ—Ä–º–∞)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ù–û–†–ú–ê - –Ω–µ –≤—Å–µ —Å—Ç—É–¥–µ–Ω—Ç—ã –∏–º–µ—é—Ç –ø—Ä–æ—Ñ–∏–ª—å (—Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ)

---

### 3.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ Sales Manager

#### Tripwire DB

```sql
SELECT
  au.email as sales_manager_email,
  COUNT(tu.id) as students_created,
  SUM(5000) as total_revenue_kzt
FROM tripwire_users tu
JOIN auth.users au ON au.id = tu.created_by_sales_manager_id
GROUP BY au.email
ORDER BY students_created DESC;
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–ª–æ–Ω–∫–∞ `created_by_sales_manager_id` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ tripwire_users!

**–¢–µ–∫—É—â–∞—è —Å—Ö–µ–º–∞:**
- `granted_by` (UUID) - ID –º–µ–Ω–µ–¥–∂–µ—Ä–∞ (–ù–ï FK, –ø—Ä–æ—Å—Ç–æ UUID)
- `manager_name` (TEXT) - –ò–º—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–°—Ç–∞—Ç—É—Å:** ‚ùå –ü–†–û–ë–õ–ï–ú–ê - granted_by –ù–ï —è–≤–ª—è–µ—Ç—Å—è Foreign Key –Ω–∞ auth.users

---

### 3.3 –ù–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

#### Landing BD ‚Üí AmoCRM

```sql
SELECT
  COUNT(*) as total_leads,
  COUNT(*) FILTER (WHERE amocrm_synced = false) as not_synced,
  COUNT(*) FILTER (WHERE amocrm_synced = true) as synced
FROM landing_leads;
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–∏–¥–æ–≤

#### Tripwire ‚Üí AmoCRM

```sql
SELECT
  COUNT(*) as total_students,
  COUNT(*) FILTER (WHERE amocrm_deal_id IS NULL) as without_deal,
  COUNT(*) FILTER (WHERE amocrm_deal_id IS NOT NULL) as with_deal
FROM tripwire_users;
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –±–µ–∑ —Å–¥–µ–ª–∫–∏ –≤ AmoCRM

---

## PART 4: STORAGE STATUS

### 4.1 Tripwire Storage

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ buckets (Tripwire DB)

```sql
SELECT
  name as bucket_name,
  public,
  created_at
FROM storage.buckets
WHERE name IN ('tripwire-certificates', 'tripwire-materials');
```

**–û–∂–∏–¥–∞–µ–º—ã–µ buckets:**
- ‚úÖ `tripwire-certificates` (–¥–ª—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ PDF)
- ‚úÖ `tripwire-materials` (–¥–ª—è –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ —É—Ä–æ–∫–æ–≤)

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤

```sql
SELECT
  bucket_id,
  COUNT(*) as file_count,
  SUM((metadata->>'size')::bigint) / 1024 / 1024 as total_size_mb
FROM storage.objects
GROUP BY bucket_id;
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- tripwire-certificates: 3 —Ñ–∞–π–ª–∞ (~1-2 MB)
- tripwire-materials: 1 —Ñ–∞–π–ª

---

### 4.2 Main Platform Storage

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ buckets (Main DB)

```sql
SELECT
  name as bucket_name,
  public,
  created_at
FROM storage.buckets;
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è:** –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö buckets –≤ Main Platform

---

## PART 5: SECURITY STATUS

### 5.1 RLS Policies - Tripwire DB

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ rowsecurity

```sql
SELECT
  schemaname,
  tablename,
  rowsecurity
FROM pg_tables
WHERE schemaname = 'public'
  AND tablename IN ('tripwire_users', 'lesson_materials', 'lesson_homework')
ORDER BY tablename;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
| –¢–∞–±–ª–∏—Ü–∞ | rowsecurity | –°—Ç–∞—Ç—É—Å |
|---------|-------------|--------|
| tripwire_users | true | ‚úÖ PASS |
| lesson_materials | true | ‚úÖ PASS |
| lesson_homework | true | ‚úÖ PASS |

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–∏—Ç–∏–∫ RLS

```sql
SELECT
  tablename,
  policyname,
  permissive,
  roles,
  cmd
FROM pg_policies
WHERE schemaname = 'public'
  AND tablename IN ('tripwire_users', 'lesson_materials', 'lesson_homework')
ORDER BY tablename, policyname;
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏:**

**tripwire_users:**
- ‚úÖ `service_role_full_access_tripwire_users` (service_role, ALL)
- ‚úÖ `authenticated_read_own_tripwire_users` (authenticated, SELECT)
- ‚úÖ `authenticated_update_own_tripwire_users` (authenticated, UPDATE)
- ‚úÖ `anon_no_access_tripwire_users` (anon, ALL ‚Üí false)

**lesson_materials:**
- ‚úÖ `service_role_full_access_lesson_materials` (service_role, ALL)
- ‚úÖ `authenticated_read_lesson_materials` (authenticated, SELECT)

**lesson_homework:**
- ‚úÖ `service_role_full_access_lesson_homework` (service_role, ALL)
- ‚úÖ `users_read_own_homework` (authenticated, ALL ‚Üí auth.uid() = user_id)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï RLS –ü–û–õ–ò–¢–ò–ö–ò –ü–†–ò–ú–ï–ù–ï–ù–´

---

### 5.2 Service Role Keys –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

**backend/.env:**
```bash
# Main Platform
SUPABASE_URL=https://arqhkacellqbhjhbebfh.supabase.co
SUPABASE_SERVICE_ROLE_KEY=***

# Tripwire
TRIPWIRE_SUPABASE_URL=https://pjmvxecykysfrzppdcto.supabase.co
TRIPWIRE_SERVICE_ROLE_KEY=***

# Landing BD
LANDING_SUPABASE_URL=https://xikaiavwqinamgolmtcy.supabase.co
LANDING_SUPABASE_SERVICE_KEY=***

# Traffic Dashboard
TRAFFIC_SUPABASE_URL=https://oetodaexnjcunklkdlkv.supabase.co
TRAFFIC_SERVICE_ROLE_KEY=***
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–ï –ö–õ–Æ–ß–ò –ó–ê–î–ê–ù–´ –ò –ö–û–†–†–ï–ö–¢–ù–´

---

## PART 6: OUTSTANDING TASKS

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ (—Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è)

#### 1. –†–µ—à–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —Ä–∞–∑—Ä—ã–≤ Traffic Dashboard ‚Üî Tripwire DB

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Sales Manager –∞–≤—Ç–æ—Ä–∏–∑—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `traffic_users` (Traffic DB)
- –°—Ç—É–¥–µ–Ω—Ç—ã —Å–æ–∑–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `auth.users` (Tripwire DB)
- –ú–µ–Ω–µ–¥–∂–µ—Ä—ã –ù–ï —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ auth.users Tripwire DB
- RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç –¥–æ—Å—Ç—É–ø –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –∫ —Å—Ç—É–¥–µ–Ω—Ç–∞–º

**–†–µ—à–µ–Ω–∏—è (–Ω–∞ –≤—ã–±–æ—Ä):**

**–í–∞—Ä–∏–∞–Ω—Ç –ê: –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
1. –°–æ–∑–¥–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –≤ auth.users Tripwire DB
2. –û–±–Ω–æ–≤–∏—Ç—å traffic_users.id ‚Üí auth.users.id (FK)
3. –û–±–Ω–æ–≤–∏—Ç—å tripwire_users.granted_by ‚Üí auth.users.id (FK)
4. –û–±–Ω–æ–≤–∏—Ç—å RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤

**–í–∞—Ä–∏–∞–Ω—Ç –ë: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –ë–î**
1. –°–æ–∑–¥–∞—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä –≤ Traffic DB –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ traffic_users ‚Üí auth.users Tripwire DB
2. –°–æ–∑–¥–∞—Ç—å RPC —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞
3. –û–±–Ω–æ–≤–∏—Ç—å RLS –ø–æ–ª–∏—Ç–∏–∫–∏ —Å —É—á–µ—Ç–æ–º –≤–Ω–µ—à–Ω–∏—Ö UUID

**–í–∞—Ä–∏–∞–Ω—Ç –í: –°–ª–∏—è–Ω–∏–µ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö**
1. –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å traffic_users –≤ Main Platform DB
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–¥–∏–Ω—É—é auth —Å–∏—Å—Ç–µ–º—É
3. –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –µ–¥–∏–Ω–æ–π –ë–î

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –í–´–°–û–ö–ò–ô
**–°—Ä–æ–∫:** 1-2 –Ω–µ–¥–µ–ª–∏

---

#### 2. –°–æ–∑–¥–∞—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

**–ó–∞–¥–∞—á–∏:**
1. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `integration_logs` (Landing DB)
   - service_name: 'amocrm', 'resend', 'telegram', 'mobizon'
   - action: 'sync_lead', 'send_email', 'send_sms'
   - status: 'success', 'failed', 'pending'
   - error_message: TEXT
   - created_at: TIMESTAMPTZ

2. –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã:
   - amoCrmService.ts
   - emailService.ts
   - telegramService.ts
   - mobizon.ts

3. –°–æ–∑–¥–∞—Ç—å –¥–∞—à–±–æ—Ä–¥ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω—ã—Ö/–Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∑–∞ –¥–µ–Ω—å
   - –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—à–∏–±–∫–∏
   - –°—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å AmoCRM

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –°–†–ï–î–ù–ò–ô
**–°—Ä–æ–∫:** 2-3 –Ω–µ–¥–µ–ª–∏

---

#### 3. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**Tripwire DB:**
```sql
-- –ü–æ–∏—Å–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø–æ email
CREATE INDEX IF NOT EXISTS idx_tripwire_users_email
ON tripwire_users(email);

-- –ü–æ–∏—Å–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø–æ granted_by
CREATE INDEX IF NOT EXISTS idx_tripwire_users_granted_by
ON tripwire_users(granted_by);

-- –ü–æ–∏—Å–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø–æ —Å—Ç–∞—Ç—É—Å—É
CREATE INDEX IF NOT EXISTS idx_tripwire_users_status
ON tripwire_users(status);

-- –ü–æ–∏—Å–∫ –ø–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è
CREATE INDEX IF NOT EXISTS idx_tripwire_users_created_at
ON tripwire_users(created_at);
```

**Landing BD:**
```sql
-- –ü–æ–∏—Å–∫ –ª–∏–¥–æ–≤ –ø–æ email
CREATE INDEX IF NOT EXISTS idx_landing_leads_email
ON landing_leads(email);

-- –ü–æ–∏—Å–∫ –Ω–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–∏–¥–æ–≤
CREATE INDEX IF NOT EXISTS idx_landing_leads_amocrm_synced
ON landing_leads(amocrm_synced)
WHERE amocrm_synced = false;
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –°–†–ï–î–ù–ò–ô
**–°—Ä–æ–∫:** 1 –Ω–µ–¥–µ–ª—è

---

### –£–ª—É—á—à–µ–Ω–∏—è (–º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ–∑–∂–µ)

#### 4. –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–æ–≤ –≤ Landing BD

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `lead_tracking` (5 –∑–∞–ø–∏—Å–µ–π)
- `unified_lead_tracking` (168 –∑–∞–ø–∏—Å–µ–π)
- `landing_leads` (~173 –∑–∞–ø–∏—Å–∏)

**–†–µ—à–µ–Ω–∏–µ:**
1. –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤—Å–µ –ª–∏–¥—ã –≤ –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É `landing_leads`
2. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É `source_table` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è
3. –°–æ–∑–¥–∞—Ç—å VIEW –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
4. –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–ò–ó–ö–ò–ô
**–°—Ä–æ–∫:** 3-4 –Ω–µ–¥–µ–ª–∏

---

#### 5. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ email

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ï—Å–ª–∏ email –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏–ª—Å—è, —Å—Ç—É–¥–µ–Ω—Ç –Ω–µ –ø–æ–ª—É—á–∏—Ç –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å
- –ù–µ—Ç —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ email

**–†–µ—à–µ–Ω–∏–µ:**
1. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `email_queue` (Landing DB)
   - id, recipient_email, template_name, params (JSONB), status, attempts, last_error
2. –°–æ–∑–¥–∞—Ç—å cron job –¥–ª—è retry –Ω–µ–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö email
3. –û–±–Ω–æ–≤–∏—Ç—å emailService.ts –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ—á–µ—Ä–µ–¥–∏

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–ò–ó–ö–ò–ô
**–°—Ä–æ–∫:** 2-3 –Ω–µ–¥–µ–ª–∏

---

## PART 7: RECOMMENDATIONS

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è

1. **–†–µ—à–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —Ä–∞–∑—Ä—ã–≤ Traffic ‚Üî Tripwire**
   - –í—ã–±—Ä–∞—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö
   - –û–±–Ω–æ–≤–∏—Ç—å RLS –ø–æ–ª–∏—Ç–∏–∫–∏

2. **–°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π**
   - –¢–∞–±–ª–∏—Ü–∞ integration_logs
   - –î–∞—à–±–æ—Ä–¥ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
   - –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö

3. **–î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
   - –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ email, status, created_at
   - –ß–∞—Å—Ç–∏—á–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤

---

### –£–ª—É—á—à–µ–Ω–∏—è

4. **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–æ–≤**
   - –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤ –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É
   - –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã

5. **–î–æ–±–∞–≤–∏—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ email**
   - Email queue
   - Cron job –¥–ª—è retry

6. **–°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é**
   - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ –≤—Å–µ—Ö 4 –±–∞–∑
   - –°—Ö–µ–º–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
   - Runbook –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π

---

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (—á—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω–æ)

#### –ï–∂–µ–¥–Ω–µ–≤–Ω–æ
- ‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ Tripwire
- ‚úÖ –°—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å AmoCRM
- ‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö email (welcome, certificate)
- ‚úÖ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ª–∏–¥–∞—Ö

#### –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ
- ‚úÖ –°—Ç–∞—Ç—É—Å RLS –ø–æ–ª–∏—Ç–∏–∫
- ‚úÖ –†–∞–∑–º–µ—Ä Storage buckets
- ‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–∏–¥–æ–≤
- ‚úÖ Performance –∏–Ω–¥–µ–∫—Å–æ–≤

#### –ï–∂–µ–º–µ—Å—è—á–Ω–æ
- ‚úÖ –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º
- ‚úÖ –†–µ–≤—å—é RLS –ø–æ–ª–∏—Ç–∏–∫
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤

---

## APPENDIX: DATABASE URLS

| –ù–∞–∑–≤–∞–Ω–∏–µ | URL | –ü—Ä–æ–µ–∫—Ç ID |
|----------|-----|-----------|
| Main Platform | https://arqhkacellqbhjhbebfh.supabase.co | arqhkacellqbhjhbebfh |
| Tripwire Express | https://pjmvxecykysfrzppdcto.supabase.co | pjmvxecykysfrzppdcto |
| Landing BD | https://xikaiavwqinamgolmtcy.supabase.co | xikaiavwqinamgolmtcy |
| Traffic Dashboard | https://oetodaexnjcunklkdlkv.supabase.co | oetodaexnjcunklkdlkv |

---

## CONTACT

**–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ –∞—É–¥–∏—Ç—É:**
Claude Code AI Assistant

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç—á—ë—Ç–∞:** 2025-12-30
**–í–µ—Ä—Å–∏—è:** 1.0

---

# –ö–û–ù–ï–¶ –û–¢–ß–Å–¢–ê
