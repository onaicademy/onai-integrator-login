# üöÄ –§–ò–ù–ê–õ–¨–ù–´–ô –î–ï–ü–õ–û–ô –ù–ê PRODUCTION

**–î–∞—Ç–∞:** 2025-11-19  
**–í—Ä–µ–º—è:** $(Get-Date -Format "HH:mm")  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–Å–ù

---

## üìã –ß–¢–û –î–ï–ü–õ–û–ò–¢–°–Ø

### Backend –∏–∑–º–µ–Ω–µ–Ω–∏—è:
1. ‚úÖ `/api/lessons DELETE endpoint` ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –ø–∞—Ä—Å–∏–Ω–≥ ID (parseInt)
2. ‚úÖ `/api/lessons/reorder PUT endpoint` ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ä—è–¥–∫–∞
3. ‚úÖ `/api/modules/reorder PUT endpoint` ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ä—è–¥–∫–∞
4. ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### Frontend –∏–∑–º–µ–Ω–µ–Ω–∏—è:
1. ‚úÖ `src/pages/Module.tsx` ‚Äî —É–ª—É—á—à–µ–Ω `handleDragEnd` –¥–ª—è —É—Ä–æ–∫–æ–≤ —Å toast-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
2. ‚úÖ `src/pages/Course.tsx` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω drag-and-drop –¥–ª—è –º–æ–¥—É–ª–µ–π
3. ‚úÖ Toast-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ —É—Å–ø–µ—Ö–µ –∏ –æ—à–∏–±–∫–∞—Ö (sonner)

### Database –º–∏–≥—Ä–∞—Ü–∏–∏:
1. ‚úÖ `supabase/migrations/CHECK_ORDER_INDEX.sql` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –ø–æ–ª–µ–π `order_index`

---

## üîß –ü–†–û–¶–ï–°–° –î–ï–ü–õ–û–Ø

### –®–∞–≥ 1: Git Commit –∏ Push ‚úÖ
```bash
git add .
git commit -m "fix: –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–æ–≤ —É–¥–∞–ª–µ–Ω–∏—è, drag-and-drop –∏ order_index –¥–ª—è production"
git checkout main
git merge [—Ç–µ–∫—É—â–∞—è_–≤–µ—Ç–∫–∞]
git push origin main
```

### –®–∞–≥ 2: Backend –¥–µ–ø–ª–æ–π –Ω–∞ DigitalOcean ‚úÖ
```bash
ssh root@207.154.231.30
cd /var/www/onai-integrator-login-main/backend
git stash
git pull origin main
npm install
npm run build
pm2 reload onai-backend --update-env
```

### –®–∞–≥ 3: Frontend –¥–µ–ø–ª–æ–π –Ω–∞ Vercel ‚úÖ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–∏ push –≤ `main` –≤–µ—Ç–∫—É
- Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ Supabase –º–∏–≥—Ä–∞—Ü–∏–π ‚è≥
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ `order_index` –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö `lessons` –∏ `modules`
- –ï—Å–ª–∏ –ø–æ–ª–µ–π –Ω–µ—Ç ‚Äî –≤—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ SQL Editor

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –ü–û–°–õ–ï –î–ï–ü–õ–û–Ø

### Backend Health Check:
- [ ] `https://api.onai.academy/api/health` ‚Äî 200 OK
- [ ] `https://api.onai.academy/api/debug/env` ‚Äî 200 OK

### –¢–µ—Å—Ç —É–¥–∞–ª–µ–Ω–∏—è —É—Ä–æ–∫–∞:
- [ ] –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ https://onai.academy
- [ ] –û—Ç–∫—Ä—ã—Ç—å –∫—É—Ä—Å ‚Üí –º–æ–¥—É–ª—å
- [ ] –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è –Ω–∞ —É—Ä–æ–∫–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: —É—Ä–æ–∫ —É–¥–∞–ª–µ–Ω, –Ω–µ—Ç –æ—à–∏–±–æ–∫ 404

### –¢–µ—Å—Ç drag-and-drop —É—Ä–æ–∫–æ–≤:
- [ ] –í –º–æ–¥—É–ª–µ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç—å —É—Ä–æ–∫ –Ω–∞ –¥—Ä—É–≥—É—é –ø–æ–∑–∏—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–æ—Å—Ç "–ü–æ—Ä—è–¥–æ–∫ –æ–±–Ω–æ–≤–ª—ë–Ω"
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É ‚Äî –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è

### –¢–µ—Å—Ç drag-and-drop –º–æ–¥—É–ª–µ–π:
- [ ] –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∫—É—Ä—Å–∞ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç—å –º–æ–¥—É–ª—å –Ω–∞ –¥—Ä—É–≥—É—é –ø–æ–∑–∏—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–æ—Å—Ç "–ü–æ—Ä—è–¥–æ–∫ –æ–±–Ω–æ–≤–ª—ë–Ω"
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É ‚Äî –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ backend:
- [ ] `pm2 logs onai-backend` ‚Äî –Ω–µ—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫
- [ ] –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —É—Å–ø–µ—à–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã DELETE –∏ reorder

---

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –î–ï–ü–õ–û–Ø

### Backend:
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –û–ë–ù–û–í–õ–Å–ù
- **Health Endpoint:** ‚úÖ 200 OK
- **PM2 Status:** ‚úÖ ONLINE
- **Git Pull:** ‚úÖ –£—Å–ø–µ—à–Ω–æ (commit 2fc7084)
- **Build:** ‚ö†Ô∏è –ï—Å—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (–æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç @aws-sdk –º–æ–¥—É–ª–∏, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
- **OPENAI_API_KEY:** ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω

### Frontend:
- **–°—Ç–∞—Ç—É—Å:** ‚è≥ –û–∂–∏–¥–∞–µ—Ç Vercel –¥–µ–ø–ª–æ—è
- **URL:** https://onai.academy
- **Vercel Dashboard:** https://vercel.com/dashboard

### Database:
- **order_index –≤ lessons:** ‚è≥ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è
- **order_index –≤ modules:** ‚è≥ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è

---

## üîç –õ–û–ì–ò –ò –û–®–ò–ë–ö–ò

### Backend –ª–æ–≥–∏:
```bash
pm2 logs onai-backend --lines 100
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫:
```bash
pm2 logs onai-backend --lines 100 | grep -i "error\|delete\|reorder"
```

---

## ‚ö†Ô∏è –ï–°–õ–ò –í–û–ó–ù–ò–ö–õ–ò –û–®–ò–ë–ö–ò

### –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π:
```bash
ssh root@207.154.231.30
cd /var/www/onai-integrator-login-main/backend
git reset --hard HEAD~1
pm2 reload onai-backend --update-env
```

### –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞:
```bash
npm run build
pm2 reload onai-backend --update-env
```

---

## ‚úÖ –ò–¢–û–ì–û–í–´–ô –°–¢–ê–¢–£–°

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –î–ï–ü–õ–û–ô –ó–ê–í–ï–†–®–Å–ù

### –í—ã–ø–æ–ª–Ω–µ–Ω–æ:
- ‚úÖ Git commit –∏ push –≤ main (commit: 2fc7084)
- ‚úÖ Backend –æ–±–Ω–æ–≤–ª—ë–Ω –Ω–∞ DigitalOcean
- ‚úÖ PM2 –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω —Å --update-env
- ‚úÖ OPENAI_API_KEY –æ–±–Ω–æ–≤–ª—ë–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- ‚úÖ Health endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç (200 OK)

### –û–∂–∏–¥–∞–µ—Ç—Å—è:
- ‚è≥ Frontend –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Vercel (–ø—Ä–∏ push –≤ main)
- ‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —É–¥–∞–ª–µ–Ω–∏—è –∏ drag-and-drop –Ω–∞ production

---

**–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –¥–µ–ø–ª–æ—è:** 2025-11-19  
**–í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞:** $(Get-Date -Format "HH:mm")

