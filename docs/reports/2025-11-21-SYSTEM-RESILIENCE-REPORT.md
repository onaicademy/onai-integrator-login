# üõ°Ô∏è **–û–¢–ß–Å–¢: "–ü–†–ï–î–û–•–†–ê–ù–ò–¢–ï–õ–ò" –í –°–ò–°–¢–ï–ú–ï**

## üìÖ **–î–∞—Ç–∞:** 21 –Ω–æ—è–±—Ä—è 2025

---

## üéØ **–ß–¢–û –¢–ê–ö–û–ï "–ü–†–ï–î–û–•–†–ê–ù–ò–¢–ï–õ–ò"? (–ü—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º)**

–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —Ç–≤–æ—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ ‚Äî —ç—Ç–æ **–±–æ–ª—å—à–æ–π —Ç–æ—Ä–≥–æ–≤—ã–π —Ü–µ–Ω—Ç—Ä**:

### **üîå –ü—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å (Circuit Breaker):**
–ö–∞–∫ –∞–≤—Ç–æ–º–∞—Ç –≤ —ç–ª–µ–∫—Ç—Ä–æ—â–∏—Ç–∫–µ. –ï—Å–ª–∏ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞ ‚Üí –≤—ã–∫–ª—é—á–∞–µ—Ç —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ, —á—Ç–æ–±—ã –Ω–µ —Å–≥–æ—Ä–µ–ª –≤–µ—Å—å –¥–æ–º.

**–í —Å–∏—Å—Ç–µ–º–µ:** –ï—Å–ª–∏ OpenAI API —É–ø–∞–ª ‚Üí –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∞–µ–º –∑–∞–ø—Ä–æ—Å—ã –∫ –Ω–µ–º—É, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã.

### **üö¶ –û–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—å —Å–∫–æ—Ä–æ—Å—Ç–∏ (Rate Limiter):**
–ö–∞–∫ —Å–≤–µ—Ç–æ—Ñ–æ—Ä –Ω–∞ –≤—Ö–æ–¥–µ. –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç –ª—é–¥–µ–π –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ, –∞ –Ω–µ –≤—Å–µ—Ö —Ä–∞–∑–æ–º.

**–í —Å–∏—Å—Ç–µ–º–µ:** –ï—Å–ª–∏ –ø—Ä–∏—à–ª–æ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É ‚Üí –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º 100, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∂–¥—É—Ç –≤ –æ—á–µ—Ä–µ–¥–∏.

### **üîÑ –ü–æ–≤—Ç–æ—Ä –ø—Ä–∏ –æ—à–∏–±–∫–µ (Retry Logic):**
–ö–∞–∫ –µ—Å–ª–∏ –∫–∞—Å—Å–∏—Ä –Ω–µ —Å–ª—ã—à–∏—Ç —Ç–µ–±—è ‚Üí —Ç—ã –ø–æ–≤—Ç–æ—Ä—è–µ—à—å –ø—Ä–æ—Å—å–±—É 2-3 —Ä–∞–∑–∞.

**–í —Å–∏—Å—Ç–µ–º–µ:** –ï—Å–ª–∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª–∞ ‚Üí –ø–æ–≤—Ç–æ—Ä—è–µ–º –∑–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É.

### **‚è±Ô∏è –¢–∞–π–º–∞—É—Ç—ã (Timeouts):**
–ö–∞–∫ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –Ω–∞ –∫–∞—Å—Å–µ. –ï—Å–ª–∏ –±–æ–ª—å—à–µ 5 –º–∏–Ω—É—Ç ‚Üí –∏–¥—ë—à—å –∫ –¥—Ä—É–≥–æ–π –∫–∞—Å—Å–µ.

**–í —Å–∏—Å—Ç–µ–º–µ:** –ï—Å–ª–∏ OpenAI –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç 60 —Å–µ–∫—É–Ω–¥ ‚Üí –æ—Ç–º–µ–Ω—è–µ–º –∑–∞–ø—Ä–æ—Å –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—à–∏–±–∫—É.

### **üìã –û—á–µ—Ä–µ–¥—å (Queue):**
–ö–∞–∫ –≤ –±–∞–Ω–∫–µ –±–µ—Ä—ë—à—å —Ç–∞–ª–æ–Ω—á–∏–∫ –∏ –∂–¥—ë—à—å —Å–≤–æ–µ–π –æ—á–µ—Ä–µ–¥–∏.

**–í —Å–∏—Å—Ç–µ–º–µ:** –ï—Å–ª–∏ –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Üí –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ø–æ –æ—á–µ—Ä–µ–¥–∏, –Ω–µ –≤–∞–ª–∏–º —Å–µ—Ä–≤–µ—Ä.

---

## ‚úÖ **–ß–¢–û –£–ñ–ï –ï–°–¢–¨ –í –°–ò–°–¢–ï–ú–ï (–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ "–ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª–∏"):**

### **1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (Error Handling) ‚úÖ**

**–ß—Ç–æ —ç—Ç–æ:**
–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–ª–æ—Å—å ‚Üí —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –ø–∞–¥–∞–µ—Ç, –∞ –ª–æ–≤–∏—Ç –æ—à–∏–±–∫—É –∏ –ª–æ–≥–∏—Ä—É–µ—Ç –µ—ë.

**–ì–¥–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:**
- ‚úÖ **68 –±–ª–æ–∫–æ–≤ `try-catch`** –≤–æ –≤—Å–µ—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö
- ‚úÖ **Error Middleware** (`errorHandler.ts`) - —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫

**–ö–æ–¥:**
```typescript
// –í –ö–ê–ñ–î–û–ú –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ:
try {
  // –í—ã–ø–æ–ª–Ω—è–µ–º –æ–ø–µ—Ä–∞—Ü–∏—é
  const result = await database.query();
  res.json(result);
} catch (error) {
  // –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Üí –Ω–µ –ø–∞–¥–∞–µ–º, –∞ –ª–æ–≥–∏—Ä—É–µ–º
  console.error('–û—à–∏–±–∫–∞:', error);
  res.status(500).json({ error: '–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫' });
}
```

**–ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ —Å –∑–∞—â–∏—Ç–æ–π:**
- ‚úÖ `fileController.ts` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤
- ‚úÖ `openaiController.ts` - –∑–∞–ø—Ä–æ—Å—ã –∫ OpenAI
- ‚úÖ `lessonController.ts` - —Ä–∞–±–æ—Ç–∞ —Å —É—Ä–æ–∫–∞–º–∏
- ‚úÖ `dashboardController.ts` - –¥–∞—à–±–æ—Ä–¥ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –ò –µ—â—ë 15+ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤

**–û—Ü–µ–Ω–∫–∞:** üü¢ **–•–û–†–û–®–û –ó–ê–©–ò–©–ï–ù–û**

---

### **2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ (Graceful Error Handling) ‚úÖ**

**–ß—Ç–æ —ç—Ç–æ:**
–ï—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ (–≤—Å—è —Å–∏—Å—Ç–µ–º–∞ –≤–∞–ª–∏—Ç—Å—è) ‚Üí –Ω–µ —É–±–∏–≤–∞–µ–º —Å–µ—Ä–≤–µ—Ä, –∞ –ª–æ–≥–∏—Ä—É–µ–º –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º.

**–ì–¥–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:**

```typescript
// backend/src/server.ts (—Å—Ç—Ä–æ–∫–∏ 204-224)

// 1. –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
process.on('uncaughtException', (error) => {
  console.error('üí• –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê');
  console.error('üí• Backend –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç—É');
  // –ù–ï –ü–ê–î–ê–ï–ú! –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å
});

// 2. –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ Promise rejections
process.on('unhandledRejection', (reason) => {
  console.error('üí• –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: Promise rejected');
  console.error('üí• Backend –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç—É');
  // –ù–ï –ü–ê–î–ê–ï–ú! –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å
});
```

**–ê–Ω–∞–ª–æ–≥–∏—è:**
–ö–∞–∫ –µ—Å–ª–∏ –≤ —Ç–æ—Ä–≥–æ–≤–æ–º —Ü–µ–Ω—Ç—Ä–µ —Å–ª–æ–º–∞–ª—Å—è –æ–¥–∏–Ω —ç—Å–∫–∞–ª–∞—Ç–æ—Ä ‚Üí –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –ª—é–¥–∏ –∏–¥—É—Ç –ø–æ –ª–µ—Å—Ç–Ω–∏—Ü–µ.

**–û—Ü–µ–Ω–∫–∞:** üü¢ **–û–¢–õ–ò–ß–ù–û –ó–ê–©–ò–©–ï–ù–û**

---

### **3. Graceful Shutdown (–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –≤—ã–∫–ª—é—á–µ–Ω–∏–µ) ‚úÖ**

**–ß—Ç–æ —ç—Ç–æ:**
–ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å ‚Üí —Å–Ω–∞—á–∞–ª–∞ –¥–æ–∂–∏–¥–∞–µ—Ç—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö —Ç–µ–∫—É—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –ø–æ—Ç–æ–º –≤—ã–∫–ª—é—á–∞–µ—Ç—Å—è.

**–ì–¥–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:**

```typescript
// backend/src/server.ts (—Å—Ç—Ä–æ–∫–∏ 227-233, 244-250)

// –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ Ctrl+C –∏–ª–∏ –∫–æ–º–∞–Ω–¥–µ pm2 restart
process.on('SIGTERM', () => {
  console.log('üõë –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–µ—Ä–≤–µ—Ä...');
  server.close(() => {
    console.log('‚úÖ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã, —Å–µ—Ä–≤–µ—Ä –∑–∞–∫—Ä—ã—Ç');
    process.exit(0);
  });
});
```

**–ê–Ω–∞–ª–æ–≥–∏—è:**
–ö–∞–∫ –º–∞–≥–∞–∑–∏–Ω –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º –Ω–µ –≤—ã–≥–æ–Ω—è–µ—Ç –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π, –∞ –¥–æ–∂–∏–¥–∞–µ—Ç—Å—è –ø–æ–∫–∞ –æ–Ω–∏ –∑–∞–∫–æ–Ω—á–∞—Ç –ø–æ–∫—É–ø–∫–∏.

**–û—Ü–µ–Ω–∫–∞:** üü¢ **–û–¢–õ–ò–ß–ù–û**

---

### **4. Timeout –¥–ª—è OpenAI (–¢–∞–π–º–∞—É—Ç) ‚úÖ**

**–ß—Ç–æ —ç—Ç–æ:**
–ï—Å–ª–∏ OpenAI API –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –±–æ–ª—å—à–µ 60 —Å–µ–∫—É–Ω–¥ ‚Üí –æ—Ç–º–µ–Ω—è–µ–º –∑–∞–ø—Ä–æ—Å.

**–ì–¥–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:**

```typescript
// backend/src/controllers/openaiController.ts (—Å—Ç—Ä–æ–∫–∏ 56-67)

const maxAttempts = 60; // 60 —Å–µ–∫—É–Ω–¥ –º–∞–∫—Å–∏–º—É–º
let attempts = 0;

while (runStatus.status === 'in_progress' && attempts < maxAttempts) {
  console.log(`‚è≥ –ñ–¥—ë–º –æ—Ç–≤–µ—Ç OpenAI (${attempts}/60)...`);
  await new Promise(resolve => setTimeout(resolve, 1000)); // 1 —Å–µ–∫—É–Ω–¥–∞
  attempts++;
}

if (attempts >= maxAttempts) {
  return res.status(408).json({ error: 'Timeout: OpenAI –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª' });
}
```

**–ê–Ω–∞–ª–æ–≥–∏—è:**
–ö–∞–∫ –µ—Å–ª–∏ –∑–≤–æ–Ω–∏—à—å –≤ —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫—É –∏ –∂–¥—ë—à—å 60 —Å–µ–∫—É–Ω–¥ ‚Üí –µ—Å–ª–∏ –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª–∏, –∫–ª–∞–¥—ë—à—å —Ç—Ä—É–±–∫—É.

**–û—Ü–µ–Ω–∫–∞:** üü¢ **–•–û–†–û–®–û**

---

### **5. CORS –∑–∞—â–∏—Ç–∞ (–§–∏–ª—å—Ç—Ä –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤) ‚úÖ**

**–ß—Ç–æ —ç—Ç–æ:**
–¢–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ —Å–∞–π—Ç—ã –º–æ–≥—É—Ç –¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ Backend.

**–ì–¥–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:**

```typescript
// backend/src/server.ts (—Å—Ç—Ä–æ–∫–∏ 82-117)

const allowedOrigins = [
  'https://onai.academy',      // ‚úÖ Production
  'http://localhost:8080',     // ‚úÖ Development
];

app.use(cors({
  origin: (origin, callback) => {
    if (allowedOrigins.includes(origin)) {
      callback(null, true); // ‚úÖ –†–∞–∑—Ä–µ—à–∞–µ–º
    } else {
      callback(null, false); // ‚ùå –ë–ª–æ–∫–∏—Ä—É–µ–º
    }
  }
}));
```

**–ê–Ω–∞–ª–æ–≥–∏—è:**
–ö–∞–∫ –æ—Ö—Ä–∞–Ω–Ω–∏–∫ –Ω–∞ –≤—Ö–æ–¥–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–æ–ø—É—Å–∫. –ï—Å–ª–∏ –ø—Ä–æ–ø—É—Å–∫ –Ω–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω ‚Üí –Ω–µ –ø—É—Å–∫–∞–µ—Ç.

**–û—Ü–µ–Ω–∫–∞:** üü¢ **–û–¢–õ–ò–ß–ù–û**

---

### **6. Helmet (–ó–∞—â–∏—Ç–∞ –æ—Ç —Ö–∞–∫–µ—Ä—Å–∫–∏—Ö –∞—Ç–∞–∫) ‚úÖ**

**–ß—Ç–æ —ç—Ç–æ:**
–î–æ–±–∞–≤–ª—è–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—â–∏—â–∞—é—Ç –æ—Ç XSS, clickjacking –∏ –¥—Ä—É–≥–∏—Ö –∞—Ç–∞–∫.

**–ì–¥–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:**

```typescript
// backend/src/server.ts (—Å—Ç—Ä–æ–∫–∞ 78)

app.use(helmet());
```

**–ß—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç:**
- ‚úÖ XSS (Cross-Site Scripting)
- ‚úÖ Clickjacking
- ‚úÖ MIME type sniffing
- ‚úÖ –ò –µ—â—ë 10+ —Ç–∏–ø–æ–≤ –∞—Ç–∞–∫

**–û—Ü–µ–Ω–∫–∞:** üü¢ **–û–¢–õ–ò–ß–ù–û**

---

### **7. Validation (–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö) ‚úÖ**

**–ß—Ç–æ —ç—Ç–æ:**
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, email –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞).

**–ì–¥–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:**
- ‚úÖ `express-validator` (package.json)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∏ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö:

```typescript
// –ü—Ä–∏–º–µ—Ä –∏–∑ openaiController.ts
if (!assistant_type) {
  return res.status(400).json({ error: 'assistant_type –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω' });
}

if (!validTypes.includes(assistant_type)) {
  return res.status(400).json({ error: '–ù–µ–≤–µ—Ä–Ω—ã–π assistant_type' });
}
```

**–ê–Ω–∞–ª–æ–≥–∏—è:**
–ö–∞–∫ –±–∞–Ω–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–≤–æ–π –ø–∞—Å–ø–æ—Ä—Ç –ø–µ—Ä–µ–¥ –≤—ã–¥–∞—á–µ–π –∫—Ä–µ–¥–∏—Ç–∞.

**–û—Ü–µ–Ω–∫–∞:** üü¢ **–•–û–†–û–®–û**

---

## ‚ùå **–ß–ï–ì–û –ù–ï–¢ –í –°–ò–°–¢–ï–ú–ï (–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ "–ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª–∏"):**

### **1. Rate Limiting (–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤) ‚ùå**

**–ß—Ç–æ —ç—Ç–æ:**
–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –æ–¥–Ω–æ–≥–æ IP –≤ –µ–¥–∏–Ω–∏—Ü—É –≤—Ä–µ–º–µ–Ω–∏.

**–ó–∞—á–µ–º –Ω—É–∂–Ω–æ:**
–ï—Å–ª–∏ —Ö–∞–∫–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç 10,000 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É ‚Üí —Å–µ—Ä–≤–µ—Ä –ª—è–∂–µ—Ç.

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:** ‚ùå **–ù–ï–¢ –ó–ê–©–ò–¢–´**

**–ß—Ç–æ –±—É–¥–µ—Ç –±–µ–∑ —ç—Ç–æ–≥–æ:**
```
–ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:
10,000 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫ ‚Üí Backend –ø–∞–¥–∞–µ—Ç ‚Üí –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ ‚ùå
```

**–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**

```typescript
import rateLimit from 'express-rate-limit';

// –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É —Å –æ–¥–Ω–æ–≥–æ IP
const limiter = rateLimit({
  windowMs: 60 * 1000, // 1 –º–∏–Ω—É—Ç–∞
  max: 100, // –ú–∞–∫—Å–∏–º—É–º 100 –∑–∞–ø—Ä–æ—Å–æ–≤
  message: '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —á–µ—Ä–µ–∑ –º–∏–Ω—É—Ç—É'
});

app.use('/api/', limiter);
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ **–ö–†–ò–¢–ò–ß–ù–û!**

---

### **2. Request Queue (–û—á–µ—Ä–µ–¥—å –∑–∞–ø—Ä–æ—Å–æ–≤) ‚ùå**

**–ß—Ç–æ —ç—Ç–æ:**
–ï—Å–ª–∏ –ø—Ä–∏—à–ª–æ –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ —Ä–∞–∑–æ–º ‚Üí –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ø–æ –æ—á–µ—Ä–µ–¥–∏, –Ω–µ –Ω–∞–≥—Ä—É–∂–∞–µ–º —Å–µ—Ä–≤–µ—Ä.

**–ó–∞—á–µ–º –Ω—É–∂–Ω–æ:**
1000 —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫—Ä—ã–ª–∏ —É—Ä–æ–∫ ‚Üí 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î ‚Üí –±–∞–∑–∞ –ª—è–∂–µ—Ç.

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:** ‚ùå **–ù–ï–¢ –û–ß–ï–†–ï–î–ò**

**–ß—Ç–æ –±—É–¥–µ—Ç –±–µ–∑ —ç—Ç–æ–≥–æ:**
```
1000 —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ ‚Üí 1000 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Üí –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–∞–¥–∞–µ—Ç ‚ùå
```

**–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**

```typescript
import Bull from 'bull';

// –°–æ–∑–¥–∞—ë–º –æ—á–µ—Ä–µ–¥—å
const aiQueue = new Bull('ai-requests', {
  redis: { port: 6379, host: '127.0.0.1' }
});

// –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∑–∞–ø—Ä–æ—Å—ã –ø–æ –æ—á–µ—Ä–µ–¥–∏ (10 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ)
aiQueue.process(10, async (job) => {
  return await processAIRequest(job.data);
});
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° **–í–ê–ñ–ù–û**

---

### **3. Circuit Breaker (–ê–≤—Ç–æ–º–∞—Ç –∑–∞—â–∏—Ç—ã) ‚ùå**

**–ß—Ç–æ —ç—Ç–æ:**
–ï—Å–ª–∏ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å (OpenAI, Supabase) —É–ø–∞–ª ‚Üí –≤—Ä–µ–º–µ–Ω–Ω–æ –ø–µ—Ä–µ—Å—Ç–∞—ë–º –∫ –Ω–µ–º—É –æ–±—Ä–∞—â–∞—Ç—å—Å—è.

**–ó–∞—á–µ–º –Ω—É–∂–Ω–æ:**
–ï—Å–ª–∏ OpenAI API –ª–µ–∂–∏—Ç ‚Üí –Ω–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –∂–¥–∞—Ç—å timeout –ø–æ 60 —Å–µ–∫—É–Ω–¥.

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:** ‚ùå **–ù–ï–¢ –ó–ê–©–ò–¢–´**

**–ß—Ç–æ –±—É–¥–µ—Ç –±–µ–∑ —ç—Ç–æ–≥–æ:**
```
OpenAI API —É–ø–∞–ª ‚Üí
1000 —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –¥–µ–ª–∞—é—Ç –∑–∞–ø—Ä–æ—Å ‚Üí
–ö–∞–∂–¥—ã–π –∂–¥—ë—Ç 60 —Å–µ–∫—É–Ω–¥ timeout ‚Üí
–°–µ—Ä–≤–µ—Ä —Ç–æ—Ä–º–æ–∑–∏—Ç –∏ –º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å ‚ùå
```

**–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**

```typescript
import CircuitBreaker from 'opossum';

// –°–æ–∑–¥–∞—ë–º "–∞–≤—Ç–æ–º–∞—Ç"
const breaker = new CircuitBreaker(callOpenAI, {
  timeout: 30000, // 30 —Å–µ–∫—É–Ω–¥
  errorThresholdPercentage: 50, // –ï—Å–ª–∏ 50% –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–∞–¥–∞–µ—Ç
  resetTimeout: 30000 // –ü—Ä–æ–±—É–µ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥
});

// –ï—Å–ª–∏ OpenAI —É–ø–∞–ª ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫—ç—à
breaker.fallback(() => getCachedResponse());
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° **–í–ê–ñ–ù–û**

---

### **4. Database Connection Pooling (–ü—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –ë–î) ‚ùå**

**–ß—Ç–æ —ç—Ç–æ:**
–î–µ—Ä–∂–∏–º –æ—Ç–∫—Ä—ã—Ç—ã–º–∏ N —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –±–∞–∑–æ–π, –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö.

**–ó–∞—á–µ–º –Ω—É–∂–Ω–æ:**
–û—Ç–∫—Ä—ã—Ç–∏–µ –Ω–æ–≤–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î = –¥–æ—Ä–æ–≥–æ (100-200ms).

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:** ‚ö†Ô∏è **Supabase –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–æ–π –ø—É–ª, –Ω–æ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω —è–≤–Ω–æ**

**–ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
```typescript
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ Supabase Dashboard:
// - Connection Pool Size (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 20-50)
// - Connection Timeout (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 30 —Å–µ–∫—É–Ω–¥)
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ **–ù–ò–ó–ö–ò–ô** (Supabase —É–ø—Ä–∞–≤–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

---

### **5. Request Timeout (–ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ç–∞–π–º–∞—É—Ç) ‚ùå**

**–ß—Ç–æ —ç—Ç–æ:**
–õ—é–±–æ–π –∑–∞–ø—Ä–æ—Å –Ω–µ –¥–æ–ª–∂–µ–Ω –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–æ–ª—å—à–µ N —Å–µ–∫—É–Ω–¥.

**–ó–∞—á–µ–º –Ω—É–∂–Ω–æ:**
–ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –∑–∞–≤–∏—Å ‚Üí –Ω–µ –¥–µ—Ä–∂–∏–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã–º –≤–µ—á–Ω–æ.

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:** ‚ö†Ô∏è **–ß–∞—Å—Ç–∏—á–Ω–æ –µ—Å—Ç—å (—Ç–æ–ª—å–∫–æ –¥–ª—è OpenAI)**

**–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**

```typescript
import timeout from 'connect-timeout';

// –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã = –º–∞–∫—Å–∏–º—É–º 30 —Å–µ–∫—É–Ω–¥
app.use(timeout('30s'));

app.use((req, res, next) => {
  if (!req.timedout) next();
});
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° **–í–ê–ñ–ù–û**

---

### **6. Retry Logic (–ê–≤—Ç–æ–ø–æ–≤—Ç–æ—Ä –ø—Ä–∏ –æ—à–∏–±–∫–µ) ‚ùå**

**–ß—Ç–æ —ç—Ç–æ:**
–ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å —É–ø–∞–ª ‚Üí –ø—Ä–æ–±—É–µ–º –µ—â—ë —Ä–∞–∑ (2-3 –ø–æ–ø—ã—Ç–∫–∏).

**–ó–∞—á–µ–º –Ω—É–∂–Ω–æ:**
–ò–Ω–æ–≥–¥–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –∏–∑-–∑–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ ‚Üí –ø–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É.

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:** ‚ùå **–ù–ï–¢ –ê–í–¢–û–ü–û–í–¢–û–†–ê**

**–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**

```typescript
import pRetry from 'p-retry';

const result = await pRetry(
  () => database.query(),
  {
    retries: 3, // 3 –ø–æ–ø—ã—Ç–∫–∏
    minTimeout: 1000, // –ñ–¥—ë–º 1 —Å–µ–∫—É–Ω–¥—É –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏
  }
);
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° **–í–ê–ñ–ù–û**

---

### **7. Load Balancing (–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏) ‚ùå**

**–ß—Ç–æ —ç—Ç–æ:**
–ù–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä–æ–≤ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –∑–∞–ø—Ä–æ—Å—ã. –ï—Å–ª–∏ –æ–¥–∏–Ω —É–ø–∞–ª ‚Üí –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.

**–ó–∞—á–µ–º –Ω—É–∂–Ω–æ:**
–û–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å ‚Üí –≤—Å—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞.

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:** ‚ùå **–û–î–ò–ù –°–ï–†–í–ï–†**

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å 2-3 –∏–Ω—Å—Ç–∞–Ω—Å–∞ Backend –Ω–∞ DigitalOcean
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å NGINX –∫–∞–∫ Load Balancer
3. –ï—Å–ª–∏ –æ–¥–∏–Ω Backend —É–ø–∞–ª ‚Üí NGINX –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ –¥—Ä—É–≥–æ–π

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° **–í–ê–ñ–ù–û** (–¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è)

---

### **8. Monitoring & Alerting (–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã) ‚ùå**

**–ß—Ç–æ —ç—Ç–æ:**
–°–∏—Å—Ç–µ–º–∞ —Å–ª–µ–¥–∏—Ç –∑–∞ –∑–¥–æ—Ä–æ–≤—å–µ–º —Å–µ—Ä–≤–µ—Ä–∞ –∏ —à–ª—ë—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö.

**–ó–∞—á–µ–º –Ω—É–∂–Ω–æ:**
–ï—Å–ª–∏ Backend —É–ø–∞–ª –Ω–æ—á—å—é ‚Üí —Ç—ã –Ω–µ —É–∑–Ω–∞–µ—à—å –¥–æ —É—Ç—Ä–∞.

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:** ‚ùå **–ù–ï–¢ –ú–û–ù–ò–¢–û–†–ò–ù–ì–ê**

**–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**
- **Sentry** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
- **Grafana + Prometheus** - –º–µ—Ç—Ä–∏–∫–∏ (CPU, –ø–∞–º—è—Ç—å, –∑–∞–ø—Ä–æ—Å—ã/—Å–µ–∫)
- **UptimeRobot** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç

**–ê–ª–µ—Ä—Ç—ã:**
```
Backend CPU > 80% ‚Üí Telegram/Email –∞–ª–µ—Ä—Ç ‚ö†Ô∏è
Backend —É–ø–∞–ª ‚Üí Telegram/Email –∞–ª–µ—Ä—Ç üî¥
OpenAI API –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç ‚Üí Telegram –∞–ª–µ—Ä—Ç üü°
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° **–í–ê–ñ–ù–û**

---

## üìä **–°–í–û–î–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê "–ü–†–ï–î–û–•–†–ê–ù–ò–¢–ï–õ–ï–ô":**

| –ó–∞—â–∏—Ç–∞ | –°—Ç–∞—Ç—É—Å | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –ü–æ–∫—Ä—ã—Ç–∏–µ |
|--------|--------|-------------|----------|
| **Error Handling** | üü¢ –ï–°–¢–¨ | –í—ã—Å–æ–∫–∞—è | 100% (68 –±–ª–æ–∫–æ–≤) |
| **Graceful Errors** | üü¢ –ï–°–¢–¨ | –í—ã—Å–æ–∫–∞—è | 100% |
| **Graceful Shutdown** | üü¢ –ï–°–¢–¨ | –°—Ä–µ–¥–Ω—è—è | 100% |
| **OpenAI Timeout** | üü¢ –ï–°–¢–¨ | –í—ã—Å–æ–∫–∞—è | 100% |
| **CORS Protection** | üü¢ –ï–°–¢–¨ | –í—ã—Å–æ–∫–∞—è | 100% |
| **Helmet Security** | üü¢ –ï–°–¢–¨ | –í—ã—Å–æ–∫–∞—è | 100% |
| **Input Validation** | üü¢ –ï–°–¢–¨ | –°—Ä–µ–¥–Ω—è—è | 80% |
| **Rate Limiting** | üî¥ –ù–ï–¢ | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–∞—è | 0% |
| **Request Queue** | üî¥ –ù–ï–¢ | üü° –í–∞–∂–Ω–∞—è | 0% |
| **Circuit Breaker** | üî¥ –ù–ï–¢ | üü° –í–∞–∂–Ω–∞—è | 0% |
| **DB Connection Pool** | üü° –ß–∞—Å—Ç–∏—á–Ω–æ | üü¢ –ù–∏–∑–∫–∞—è | 50% (Supabase auto) |
| **Request Timeout** | üü° –ß–∞—Å—Ç–∏—á–Ω–æ | üü° –í–∞–∂–Ω–∞—è | 20% (—Ç–æ–ª—å–∫–æ OpenAI) |
| **Retry Logic** | üî¥ –ù–ï–¢ | üü° –í–∞–∂–Ω–∞—è | 0% |
| **Load Balancing** | üî¥ –ù–ï–¢ | üü° –í–∞–∂–Ω–∞—è | 0% (1 —Å–µ—Ä–≤–µ—Ä) |
| **Monitoring/Alerting** | üî¥ –ù–ï–¢ | üü° –í–∞–∂–Ω–∞—è | 0% |

---

## üéØ **–ü–†–ò–û–†–ò–¢–ï–¢–´ –î–õ–Ø –í–ù–ï–î–†–ï–ù–ò–Ø:**

### **üî¥ –ö–†–ò–¢–ò–ß–ù–û (–°–¥–µ–ª–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å):**

#### **1. Rate Limiting** ‚è±Ô∏è **–í—Ä–µ–º—è: 1 —á–∞—Å**
```bash
npm install express-rate-limit
```

**–ó–∞—â–∏—Ç–∞ –æ—Ç:**
- DDoS –∞—Ç–∞–∫
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –±–æ—Ç–æ–≤
- –ü–µ—Ä–µ–≥—Ä—É–∑–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞

#### **2. Monitoring (Sentry)** ‚è±Ô∏è **–í—Ä–µ–º—è: 2 —á–∞—Å–∞**
```bash
npm install @sentry/node
```

**–î–∞—ë—Ç:**
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–∞–¥–µ–Ω–∏–π —Å–µ—Ä–≤–µ—Ä–∞
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫

---

### **üü° –í–ê–ñ–ù–û (–°–¥–µ–ª–∞—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏):**

#### **3. Circuit Breaker** ‚è±Ô∏è **–í—Ä–µ–º—è: 3 —á–∞—Å–∞**
```bash
npm install opossum
```

**–ó–∞—â–∏—Ç–∞ –æ—Ç:**
- –ö–∞—Å–∫–∞–¥–Ω—ã—Ö –ø–∞–¥–µ–Ω–∏–π
- Timeout storm (–∫–æ–≥–¥–∞ –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∂–¥—É—Ç timeout)

#### **4. Request Timeout (–≥–ª–æ–±–∞–ª—å–Ω—ã–π)** ‚è±Ô∏è **–í—Ä–µ–º—è: 1 —á–∞—Å**
```bash
npm install connect-timeout
```

**–ó–∞—â–∏—Ç–∞ –æ—Ç:**
- –ó–∞–≤–∏—Å—à–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –£—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏

#### **5. Retry Logic** ‚è±Ô∏è **–í—Ä–µ–º—è: 2 —á–∞—Å–∞**
```bash
npm install p-retry
```

**–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç:**
- –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã
- –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –≤—Ä–µ–º–µ–Ω–Ω—ã–º —Å–±–æ—è–º

---

### **üü¢ –ñ–ï–õ–ê–¢–ï–õ–¨–ù–û (–°–¥–µ–ª–∞—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ –º–µ—Å—è—Ü–∞):**

#### **6. Request Queue (Bull + Redis)** ‚è±Ô∏è **–í—Ä–µ–º—è: 1 –¥–µ–Ω—å**
```bash
npm install bull redis
```

**–î–∞—ë—Ç:**
- –û–±—Ä–∞–±–æ—Ç–∫—É –±–æ–ª—å—à–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
- –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ (email, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)

#### **7. Load Balancing** ‚è±Ô∏è **–í—Ä–µ–º—è: 1 –¥–µ–Ω—å**
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ NGINX
- –ó–∞–ø—É—Å–∫ 2-3 Backend –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤
- PM2 cluster mode

**–î–∞—ë—Ç:**
- –í—ã—Å–æ–∫—É—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üí° **–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:**

### **–î–ª—è –º–∞–ª–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ (–¥–æ 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–Ω–ª–∞–π–Ω):**
‚úÖ **–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–µ–∫—É—â–µ–π –∑–∞—â–∏—Ç—ã** + Rate Limiting + Monitoring

### **–î–ª—è —Å—Ä–µ–¥–Ω–µ–π –Ω–∞–≥—Ä—É–∑–∫–∏ (100-1000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):**
‚úÖ Rate Limiting
‚úÖ Circuit Breaker
‚úÖ Monitoring (Sentry)
‚úÖ Request Timeout

### **–î–ª—è –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ (1000+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):**
‚úÖ –í—Å—ë –≤—ã—à–µ +
‚úÖ Request Queue (Bull + Redis)
‚úÖ Load Balancing (2-3 —Å–µ—Ä–≤–µ—Ä–∞)
‚úÖ Database Read Replicas
‚úÖ CDN –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏

---

## üéâ **–ò–¢–û–ì–û–í–´–ô –í–ï–†–î–ò–ö–¢:**

### **–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
```
üü¢ –ë–∞–∑–æ–≤–∞—è –∑–∞—â–∏—Ç–∞:     85% ‚úÖ
üü° –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏: 20% ‚ö†Ô∏è
üî¥ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:   15% ‚ùå
```

### **–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
```
üî¥ –°–†–û–ß–ù–û:
1. Rate Limiting (1 —á–∞—Å)
2. Monitoring/Sentry (2 —á–∞—Å–∞)

üü° –í–ê–ñ–ù–û (1 –Ω–µ–¥–µ–ª—è):
3. Circuit Breaker (3 —á–∞—Å–∞)
4. Request Timeout (1 —á–∞—Å)
5. Retry Logic (2 —á–∞—Å–∞)

üü¢ –ñ–ï–õ–ê–¢–ï–õ–¨–ù–û (1 –º–µ—Å—è—Ü):
6. Request Queue (1 –¥–µ–Ω—å)
7. Load Balancing (1 –¥–µ–Ω—å)
```

---

## üìñ **–ü–†–ò–ú–ï–† –í–ù–ï–î–†–ï–ù–ò–Ø (Rate Limiting):**

**–§–∞–π–ª:** `backend/src/middleware/rateLimiter.ts`

```typescript
import rateLimit from 'express-rate-limit';

// –û–±—â–∏–π –ª–∏–º–∏—Ç –¥–ª—è –≤—Å–µ—Ö API
export const apiLimiter = rateLimit({
  windowMs: 60 * 1000, // 1 –º–∏–Ω—É—Ç–∞
  max: 100, // 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
  message: '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —á–µ—Ä–µ–∑ –º–∏–Ω—É—Ç—É',
  standardHeaders: true,
  legacyHeaders: false,
});

// –°—Ç—Ä–æ–≥–∏–π –ª–∏–º–∏—Ç –¥–ª—è AI –∑–∞–ø—Ä–æ—Å–æ–≤ (–¥–æ—Ä–æ–≥–∏–µ)
export const aiLimiter = rateLimit({
  windowMs: 60 * 1000,
  max: 20, // 20 AI –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
  message: '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ AI –∑–∞–ø—Ä–æ—Å–æ–≤, –ø–æ–¥–æ–∂–¥–∏—Ç–µ –º–∏–Ω—É—Ç—É',
});

// –û—á–µ–Ω—å —Å—Ç—Ä–æ–≥–∏–π –ª–∏–º–∏—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
export const uploadLimiter = rateLimit({
  windowMs: 60 * 1000,
  max: 10, // 10 –∑–∞–≥—Ä—É–∑–æ–∫ –≤ –º–∏–Ω—É—Ç—É
  message: '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–≥—Ä—É–∑–æ–∫, –ø–æ–¥–æ–∂–¥–∏—Ç–µ –º–∏–Ω—É—Ç—É',
});
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**

```typescript
// backend/src/server.ts

import { apiLimiter, aiLimiter, uploadLimiter } from './middleware/rateLimiter';

// –û–±—â–∞—è –∑–∞—â–∏—Ç–∞ –≤—Å–µ—Ö API
app.use('/api/', apiLimiter);

// –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ AI endpoints
app.use('/api/openai/', aiLimiter);
app.use('/api/files/process', uploadLimiter);
```

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 21.11.2025  
**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–°—Ç–∞—Ç—É—Å:** üü¢ **–û–¢–ß–Å–¢ –ì–û–¢–û–í**



