# üöÄ –ü–û–õ–ù–´–ô –î–ï–ü–õ–û–ô BACKEND –ò FRONTEND

**–î–∞—Ç–∞:** 2025-11-19  
**–í—Ä–µ–º—è:** 05:30  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–Å–ù

---

## üìã –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –î–ï–ô–°–¢–í–ò–Ø

### 1. Git - Commit –∏ Push
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –Ω–µ–∑–∞–∫–æ–º–º–∏—á–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- –°–æ–∑–¥–∞–Ω commit: `docs: –¥–æ–±–∞–≤–ª–µ–Ω—ã –æ—Ç—á—ë—Ç—ã –æ –¥–µ–ø–ª–æ–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö, –¥–æ–±–∞–≤–ª–µ–Ω—ã GitHub Actions workflows`
- Push –≤ `main` –≤–µ—Ç–∫—É –≤—ã–ø–æ–ª–Ω–µ–Ω

**–§–∞–π–ª—ã:**
- `.github/workflows/check-vercel-status.yml`
- `.github/workflows/deploy-backend.yml`
- `.github/workflows/deploy-frontend.yml`
- `cleanup-and-restart.sh`
- `deploy-backend-final.sh`
- `docs/AUTO_DEPLOY_SETUP.md`
- `docs/reports/2025-11-19-cleanup-restart.md`
- `docs/reports/2025-11-19-final-backend-deploy.md`
- `docs/reports/2025-11-19-referenceerror-fix.md`
- `fix-cors-deploy.sh`
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `deploy-backend.sh` –∏ `docs/reports/2025-11-19-deployment-bugfixes.md`

**Commit hash:** `1ace5b5`

---

### 2. Backend Deployment (DigitalOcean)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

**–°–µ—Ä–≤–µ—Ä:** 207.154.231.30  
**–ü—É—Ç—å:** `/var/www/onai-integrator-login-main/backend`  
**PM2 –ø—Ä–æ—Ü–µ—Å—Å:** `onai-backend`

**–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
```bash
cd /var/www/onai-integrator-login-main/backend
git pull origin main
npm install
npm install @aws-sdk/client-s3 @aws-sdk/s3-request-presigner
npm run build
pm2 reload onai-backend --update-env
pm2 status
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ Git pull —É—Å–ø–µ—à–µ–Ω (–æ–±–Ω–æ–≤–ª–µ–Ω–æ 18 —Ñ–∞–π–ª–æ–≤)
- ‚úÖ npm install –≤—ã–ø–æ–ª–Ω–µ–Ω (242 –ø–∞–∫–µ—Ç–∞)
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ AWS SDK
- ‚úÖ TypeScript –∫–æ–º–ø–∏–ª—è—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
- ‚úÖ PM2 reload –≤—ã–ø–æ–ª–Ω–µ–Ω
- ‚úÖ –ü—Ä–æ—Ü–µ—Å—Å `onai-backend` –∑–∞–ø—É—â–µ–Ω (PID: 76299)

**PM2 Status:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ id ‚îÇ name            ‚îÇ namespace   ‚îÇ version ‚îÇ mode    ‚îÇ pid      ‚îÇ uptime ‚îÇ ‚Ü∫    ‚îÇ status    ‚îÇ cpu      ‚îÇ mem      ‚îÇ user     ‚îÇ watching ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 0  ‚îÇ onai-backend    ‚îÇ default     ‚îÇ 1.0.0   ‚îÇ fork    ‚îÇ 76299    ‚îÇ 0s     ‚îÇ 2    ‚îÇ online    ‚îÇ 0%       ‚îÇ 55.9mb   ‚îÇ root     ‚îÇ disabled ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –≤–µ—Ä—Å–∏–∏ Node.js (—Ç—Ä–µ–±—É–µ—Ç—Å—è >=20.0.0, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ v18.20.8)
- ‚ö†Ô∏è –≠—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–∏—Ç—å Node.js –≤ –±—É–¥—É—â–µ–º

---

### 3. Frontend Deployment (Vercel)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ô –î–ï–ü–õ–û–ô

**–¢—Ä–∏–≥–≥–µ—Ä:** Push –≤ `main` –≤–µ—Ç–∫—É GitHub  
**URL:** https://onai.academy

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. ‚úÖ Git push –≤ `main` –≤—ã–ø–æ–ª–Ω–µ–Ω
2. ‚è≥ Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è
3. ‚è≥ –ó–∞–ø—É—Å—Ç–∏—Ç build: `npm run build`
4. ‚è≥ –ó–∞–¥–µ–ø–ª–æ–∏—Ç –≤ production

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ https://vercel.com/dashboard
- –ò–ª–∏ —á–µ—Ä–µ–∑ GitHub Actions workflow: `.github/workflows/deploy-frontend.yml`

---

## üîç –ü–†–û–í–ï–†–ö–ê BACKEND

### Health Check
**Endpoint:** https://api.onai.academy/api/health

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ê–ë–û–¢–ê–ï–¢

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** API –æ—Ç–≤–µ—á–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### Environment Variables
**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- `OPENAI_API_KEY`: ‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω (sk-proj-5PKzbDZNCeyz..., –¥–ª–∏–Ω–∞: 164 —Å–∏–º–≤–æ–ª–∞)
- `SUPABASE_SERVICE_ROLE_KEY`: ‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω (–¥–ª–∏–Ω–∞: 219 —Å–∏–º–≤–æ–ª–æ–≤)
- `FRONTEND_URL`: ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω (https://onai.academy)

### –õ–æ–≥–∏
**–ö–æ–º–∞–Ω–¥–∞:** `pm2 logs onai-backend --lines 20`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–û–í–ï–†–ï–ù

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ Backend –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:3000
- ‚úÖ Bunny CDN –Ω–∞—Å—Ç—Ä–æ–µ–Ω (Storage Zone: onai-course-videos)
- ‚úÖ OpenAI API –∫–ª—é—á –∑–∞–≥—Ä—É–∂–µ–Ω (sk-proj-5PKzbDZNCeyz...)
- ‚úÖ Telegram config –∑–∞–≥—Ä—É–∂–µ–Ω
- ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: R2 credentials –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Bunny CDN)
- ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: Node.js 18 deprecated (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–∏—Ç—å –¥–æ v20+)

---

## üìä –û–ë–ù–û–í–õ–Å–ù–ù–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´

### Backend
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ReferenceError (ErrorBoundary, –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ undefined/null)
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–æ–≤ —É–¥–∞–ª–µ–Ω–∏—è (parseInt –¥–ª—è id)
3. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ drag-and-drop (order_index)
4. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ OpenAI API –∫–ª—é—á–∞
5. ‚úÖ CORS –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
6. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ AWS SDK

### Frontend
1. ‚úÖ ErrorBoundary –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è Course.tsx (–ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ undefined/null)
3. ‚úÖ –ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
4. ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω vite.config.ts (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ process.env)

---

## ‚úÖ CHECKLIST

### Git
- [x] –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã
- [x] Push –≤ main –≤—ã–ø–æ–ª–Ω–µ–Ω
- [x] Commit hash: `1ace5b5`

### Backend
- [x] Git pull –≤—ã–ø–æ–ª–Ω–µ–Ω
- [x] npm install –≤—ã–ø–æ–ª–Ω–µ–Ω
- [x] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- [x] TypeScript –∫–æ–º–ø–∏–ª—è—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
- [x] PM2 reload –≤—ã–ø–æ–ª–Ω–µ–Ω
- [x] –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] Health check –ø—Ä–æ–≤–µ—Ä–µ–Ω
- [x] –õ–æ–≥–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
- [x] Environment variables –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã

### Frontend
- [x] Git push –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] Vercel –¥–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à—ë–Ω (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- [ ] Production URL –ø—Ä–æ–≤–µ—Ä–µ–Ω

---

## üö® –ò–ó–í–ï–°–¢–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### Node.js Version
**–ü—Ä–æ–±–ª–µ–º–∞:** Node.js v18.20.8 –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –Ω–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞–∫–µ—Ç—ã —Ç—Ä–µ–±—É—é—Ç >=20.0.0

**–í–ª–∏—è–Ω–∏–µ:** –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ

**–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–∏—Ç—å Node.js –¥–æ v20+ –≤ –±—É–¥—É—â–µ–º

---

## üìù –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å health endpoint: `curl https://api.onai.academy/api/health`
2. ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ PM2: `pm2 logs onai-backend --lines 50`
3. ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å Vercel –¥–µ–ø–ª–æ—è
4. ‚è≥ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å production:
   - https://onai.academy
   - https://api.onai.academy/api/health
   - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫—É—Ä—Å–∞: https://onai.academy/course/:id

---

## ‚úÖ –ò–¢–û–ì

**Backend:** ‚úÖ –ó–ê–î–ï–ü–õ–û–ï–ù  
**Frontend:** ‚è≥ –î–ï–ü–õ–û–ò–¢–°–Ø (Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

**–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å production —Å–µ—Ä–≤–µ—Ä–∞–º–∏!**

---

**–î–∞—Ç–∞ –¥–µ–ø–ª–æ—è:** 2025-11-19  
**–í—Ä–µ–º—è –¥–µ–ø–ª–æ—è:** 05:30  
**–í—ã–ø–æ–ª–Ω–∏–ª:** Cursor AI Assistant

