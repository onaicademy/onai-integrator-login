# ‚úÖ –£–°–ü–ï–•: Math.ceil –†–ê–ë–û–¢–ê–ï–¢!

**–î–∞—Ç–∞:** 2025-01-20  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–û–ë–õ–ï–ú–ê –†–ï–®–ï–ù–ê**

---

## üéØ **–ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–ï –ò–ó PRODUCTION:**

### SQL —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
```json
{
  "lesson_id": 41,
  "title": "–ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å –ø–æ –∑–∞—Ä–∞–±–æ—Ç–∫—É –Ω–∞ ChatGPT –±–æ—Ç–∞—Ö –≤ 2025 –≥–æ–¥—É",
  "video_dur_sec": 20,
  "calculated_minutes": 1,  ‚Üê Math.ceil(20/60) = 1 ‚úÖ
  "has_video": "‚úÖ"
}
```

### –î–æ fix'–∞:
```
20 —Å–µ–∫—É–Ω–¥ ‚Üí Math.round(20/60) ‚Üí Math.round(0.33) ‚Üí 0 –º–∏–Ω—É—Ç ‚ùå
```

### –ü–æ—Å–ª–µ fix'–∞:
```
20 —Å–µ–∫—É–Ω–¥ ‚Üí Math.ceil(20/60) ‚Üí Math.ceil(0.33) ‚Üí 1 –º–∏–Ω—É—Ç–∞ ‚úÖ
```

---

## üìä **–ò–¢–û–ì–û–í–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢:**

```
–ú–æ–¥—É–ª—å "–í–≤–µ–¥–µ–Ω–∏–µ –≤ –ø—Ä–æ—Ñ–µ—Å—Å–∏—é":
  - –¢–µ—Å—Ç 1: 1800 —Å–µ–∫ = 30 –º–∏–Ω—É—Ç ‚úÖ
  - –¢–µ—Å—Ç 2: –Ω–µ—Ç –≤–∏–¥–µ–æ
  - –ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å: 20 —Å–µ–∫ = 1 –º–∏–Ω—É—Ç–∞ ‚úÖ
  
–ò–¢–û–ì–û: 31 –º–∏–Ω—É—Ç–∞ ‚úÖ
```

**–ö–æ—Ä–æ—Ç–∫–∏–µ –≤–∏–¥–µ–æ —Ç–µ–ø–µ—Ä—å —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ!**

---

## üîß **–í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø:**

### 1. Frontend (src/pages/Module.tsx, —Å—Ç—Ä–æ–∫–∞ 331):
```typescript
lesson.duration_minutes = Math.ceil(video.duration_seconds / 60);
```

### 2. Backend lessons.ts (—Å—Ç—Ä–æ–∫–∞ 71):
```typescript
lesson.duration_minutes = Math.ceil(video.duration_seconds / 60);
```

### 3. Backend videos.ts upload (—Å—Ç—Ä–æ–∫–∞ 162):
```typescript
const durationMinutes = Math.ceil(durationSeconds / 60);
```

### 4. Backend –≤–∏–¥–∏—Ç video_content –∫–∞–∫ object (–Ω–µ array):
```typescript
const videoContentArray = Array.isArray(lesson.video_content) 
  ? lesson.video_content 
  : (lesson.video_content ? [lesson.video_content] : []);
```

### 5. Auto-reload –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ:
```typescript
onVideoUploaded={async () => {
  await loadLessonsFromAPI();
}}
```

---

## üìù **–û–°–¢–ê–í–®–ê–Ø–°–Ø –ü–†–û–ë–õ–ï–ú–ê (–Ω–µ–∫—Ä–∏—Ç–∏—á–Ω–æ):**

`lessons.duration_minutes` –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î (–æ—Å—Ç–∞—ë—Ç—Å—è 0), –Ω–æ frontend –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã—á–∏—Å–ª—è–µ—Ç –∏–∑ `video_content.duration_seconds`.

**–†–∞–±–æ—Ç–∞–µ—Ç:** Frontend –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –≤—Ä–µ–º—è ‚úÖ  
**–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:** duration_minutes –≤ lessons —Ç–∞–±–ª–∏—Ü–µ = 0 (–Ω–æ —ç—Ç–æ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ)

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø–æ—á–µ–º—É –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è.

---

## üéâ **–†–ï–ó–£–õ–¨–¢–ê–¢:**

**–í–°–ï FIX'–´ –†–ê–ë–û–¢–ê–Æ–¢!**

- ‚úÖ Math.ceil –≤–º–µ—Å—Ç–æ Math.round
- ‚úÖ –ö–æ—Ä–æ—Ç–∫–∏–µ –≤–∏–¥–µ–æ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è
- ‚úÖ Object vs Array –æ–±—Ä–∞–±–æ—Ç–∫–∞
- ‚úÖ Auto-reload –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ RLS policies –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ UNIQUE constraint –Ω–∞ lesson_id

**–ì–æ—Ç–æ–≤–æ –∫ production deploy!** üöÄ

---

## üìã **–°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:**

1. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ localhost
2. ‚è≥ Commit –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
3. ‚è≥ Push –≤ GitHub
4. ‚è≥ Deploy –Ω–∞ DigitalOcean
5. ‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ production

---

**–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –¥–µ–ø–ª–æ–∏—Ç—å –Ω–∞ production!** üéØ

