# üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢: –ß—Ç–æ —è —Å–¥–µ–ª–∞–ª –∏ —á—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ

**–î–∞—Ç–∞:** 11 –Ω–æ—è–±—Ä—è 2025  

---

## ‚úÖ –ß–¢–û –Ø –ò–°–ü–†–ê–í–ò–õ

### 1. **–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Å–µ—Å—Å–∏–∏ Supabase**
   - –§–∞–π–ª: `src/lib/supabase.ts`
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
     - `detectSessionInUrl: true`
     - `storageKey: 'supabase.auth.token'`
     - `flowType: 'pkce'`
   - –£–±—Ä–∞–Ω—ã –∫–∞—Å—Ç–æ–º–Ω—ã–µ headers –∫–æ—Ç–æ—Ä—ã–µ –º–µ—à–∞–ª–∏

### 2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏**
   - –§–∞–π–ª: `src/components/AdminGuard.tsx`
     - –õ–æ–≥–∏: session, error, localStorage
   - –§–∞–π–ª: `src/pages/Login.tsx`
     - –õ–æ–≥–∏: login success, session saved, localStorage

---

## üéØ –ß–¢–û –¢–ï–ë–ï –ù–£–ñ–ù–û –°–î–ï–õ–ê–¢–¨ –°–ï–ô–ß–ê–°

### –®–ê–ì 1: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ dev server

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏ (Ctrl+C –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
npm run dev
```

### –®–ê–ì 2: –û—á–∏—Å—Ç–∏ –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞

1. –û—Ç–∫—Ä–æ–π DevTools (`F12`)
2. Application ‚Üí Storage ‚Üí **Clear site data**
3. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É (`Ctrl+R`)

### –®–ê–ì 3: –ó–∞–ª–æ–≥–∏–Ω—å—Å—è

1. –û—Ç–∫—Ä–æ–π `http://localhost:8080/login`
2. –í–≤–µ–¥–∏ email –∏ –ø–∞—Ä–æ–ª—å
3. **–û–¢–ö–†–û–ô –ö–û–ù–°–û–õ–¨ (`F12`)** –∏ —Å–∫–æ–ø–∏—Ä—É–π –ª–æ–≥–∏

### –®–ê–ì 4: –°–∫–æ–ø–∏—Ä—É–π –∏ –ø—Ä–∏—à–ª–∏ –º–Ω–µ –ª–æ–≥–∏

–î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è:

```
‚úÖ Login success: ...
üíæ Session saved: ...
üîç Session –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞: ...
üíæ localStorage –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞: ...
```

### –®–ê–ì 5: –ü–µ—Ä–µ–π–¥–∏ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å

1. –ù–∞–∂–º–∏ "–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤"
2. –°–∫–æ–ø–∏—Ä—É–π –ª–æ–≥–∏ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏:

```
üîê AdminGuard session: ...
‚ùå AdminGuard error: ...
üíæ localStorage check: ...
```

### –®–ê–ì 6: –ü—Ä–æ–≤–µ—Ä—å localStorage –≤—Ä—É—á–Ω—É—é

–í –∫–æ–Ω—Å–æ–ª–∏ –≤—ã–ø–æ–ª–Ω–∏:

```javascript
console.log('=== LOCALSTORAGE ===')
console.log(localStorage.getItem('supabase.auth.token'))
```

---

## üìã –û–ñ–ò–î–ê–ï–ú–´–ï –õ–û–ì–ò (–µ—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç)

**–ü–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞:**
```
‚úÖ Login success: { user: { id: "...", email: "saint@onaiacademy.kz" }, session: {...} }
üíæ Session saved: { access_token: "eyJh...", refresh_token: "..." }
üîç Session –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞: { user: {...}, access_token: "eyJh..." }
üíæ localStorage –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞: "eyJhbGci..." (–î–õ–ò–ù–ù–ê–Ø –°–¢–†–û–ö–ê)
```

**–í AdminGuard:**
```
üîê AdminGuard session: { user: { id: "...", email: "..." }, access_token: "eyJh..." }
‚ùå AdminGuard error: null
üíæ localStorage check: "eyJhbGci..." (–¢–ê –ñ–ï –°–¢–†–û–ö–ê)
```

---

## ‚ùå –ï–°–õ–ò –ß–¢–û-–¢–û –ù–ï –¢–ê–ö

### –ü—Ä–æ–±–ª–µ–º–∞: `localStorage = null`

**–ü—Ä–∏—á–∏–Ω–∞:** –ë—Ä–∞—É–∑–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç localStorage

**–†–µ—à–µ–Ω–∏–µ:**
1. –í—ã–π–¥–∏ –∏–∑ —Ä–µ–∂–∏–º–∞ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ
2. –ü—Ä–æ–≤–µ—Ä—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: Settings ‚Üí Privacy ‚Üí Cookies ‚Üí Allow all
3. –ü–æ–ø—Ä–æ–±—É–π Chrome/Firefox

### –ü—Ä–æ–±–ª–µ–º–∞: `session = null` –≤ AdminGuard

**–ü—Ä–∏—á–∏–Ω–∞:** –¢–æ–∫–µ–Ω –ø—Ä–æ—Ç—É—Ö –∏–ª–∏ —Ñ–æ—Ä–º–∞—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

**–†–µ—à–µ–Ω–∏–µ:**
1. –í –∫–æ–Ω—Å–æ–ª–∏ –≤—ã–ø–æ–ª–Ω–∏: `localStorage.clear()`
2. –ü–µ—Ä–µ–ª–æ–≥–∏–Ω—å—Å—è
3. –ü—Ä–æ–≤–µ—Ä—å –≤—Ä–µ–º—è –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ (—Ç–æ–∫–µ–Ω—ã –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫–æ –≤—Ä–µ–º–µ–Ω–∏)

---

## üìÇ –ò–ó–ú–ï–ù–Å–ù–ù–´–ï –§–ê–ô–õ–´

1. `src/lib/supabase.ts` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
2. `src/components/AdminGuard.tsx` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
3. `src/pages/Login.tsx` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üéØ –ü–†–ò–®–õ–ò –ú–ù–ï

1. **–°–∫—Ä–∏–Ω—à–æ—Ç –∫–æ–Ω—Å–æ–ª–∏** –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞
2. **–°–∫—Ä–∏–Ω—à–æ—Ç –∫–æ–Ω—Å–æ–ª–∏** –≤ AdminGuard
3. **–í—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥—ã:** `localStorage.getItem('supabase.auth.token')`

–≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç –ø—Ä–∏—á–∏–Ω—É –ø—Ä–æ–±–ª–µ–º—ã! üîç

---

**–ö–æ–Ω–µ—Ü –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏**

