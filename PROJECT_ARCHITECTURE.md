# üèóÔ∏è ONAI ACADEMY - –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê

**–ü—Ä–æ–µ–∫—Ç:** OnAI Academy Integrator + Tripwire Product  
**–í–µ—Ä—Å–∏—è:** 2.0  
**–î–∞—Ç–∞:** –î–µ–∫–∞–±—Ä—å 2025

---

## üìã –û–ì–õ–ê–í–õ–ï–ù–ò–ï

1. [–û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞](#–æ–±—â–∞—è-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
2. [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
3. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
4. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø–∞–ø–æ–∫)
5. [–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#–∫–ª—é—á–µ–≤—ã–µ-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
6. [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö](#–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö)
7. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
8. [–ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏](#–ø—Ä–∞–≤–∏–ª–∞-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
9. [–î–µ–ø–ª–æ–π](#–¥–µ–ø–ª–æ–π)
10. [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)

---

## üéØ –û–ë–©–ê–Ø –°–¢–†–£–ö–¢–£–†–ê

–ü—Ä–æ–µ–∫—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ **3 –æ—Å–Ω–æ–≤–Ω—ã—Ö —á–∞—Å—Ç–µ–π**:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  FRONTEND (React + Vite + TypeScript)   ‚îÇ
‚îÇ  - Public Landing (/)                    ‚îÇ
‚îÇ  - Tripwire Product (/tripwire/*)       ‚îÇ
‚îÇ  - Admin Panel (/admin/*)               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚Üì API calls
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  BACKEND (Node.js + Express + TS)       ‚îÇ
‚îÇ  - REST API (/api/*)                    ‚îÇ
‚îÇ  - Integrations (AmoCRM, Email, SMS)    ‚îÇ
‚îÇ  - Business Logic                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚Üì Database
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  SUPABASE (PostgreSQL + Auth)           ‚îÇ
‚îÇ  - Users, Leads, Progress, Certificates ‚îÇ
‚îÇ  - Authentication (JWT)                 ‚îÇ
‚îÇ  - Real-time subscriptions              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üõ†Ô∏è –¢–ï–•–ù–û–õ–û–ì–ò–ß–ï–°–ö–ò–ô –°–¢–ï–ö

### Frontend
- **Framework:** React 18 + TypeScript
- **Build tool:** Vite 5
- **Routing:** React Router v6
- **UI Library:** Shadcn/ui (Radix UI + Tailwind CSS)
- **Animations:** Framer Motion
- **Icons:** Lucide React
- **State:** React Hooks (useState, useEffect, useContext)
- **Forms:** React Hook Form (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### Backend
- **Runtime:** Node.js 18+
- **Framework:** Express.js
- **Language:** TypeScript
- **Process Manager:** PM2
- **HTTP Client:** Axios
- **Validation:** Zod (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **Error Tracking:** Sentry

### Database & Auth
- **Database:** Supabase (PostgreSQL 15)
- **ORM:** Supabase Client (–Ω–µ Prisma/TypeORM)
- **Auth:** Supabase Auth (JWT)
- **RLS:** Row-Level Security –≤–∫–ª—é—á—ë–Ω

### Infrastructure
- **Hosting:** DigitalOcean Droplet
- **Web Server:** Nginx (reverse proxy)
- **Process Manager:** PM2
- **SSL:** Let's Encrypt
- **Deployment:** rsync + SSH

### Integrations
- **CRM:** AmoCRM (API v4)
- **Email:** Resend
- **SMS:** Mobizon
- **AI:** OpenAI API (GPT-4)
- **Monitoring:** Sentry
- **Notifications:** Telegram Bot (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üèõÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø

### Frontend Architecture

```
src/
‚îú‚îÄ‚îÄ pages/              # –°—Ç—Ä–∞–Ω–∏—Ü—ã (routing)
‚îÇ   ‚îú‚îÄ‚îÄ Home.tsx           # Landing page
‚îÇ   ‚îú‚îÄ‚îÄ tripwire/          # Tripwire –ø—Ä–æ–¥—É–∫—Ç
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TripwireProfile.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TripwireLesson.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TripwireProductPage.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ components/    # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Tripwire
‚îÇ   ‚îî‚îÄ‚îÄ admin/             # –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
‚îÇ       ‚îú‚îÄ‚îÄ TripwireManager.tsx
‚îÇ       ‚îî‚îÄ‚îÄ components/
‚îú‚îÄ‚îÄ components/         # –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ ui/               # Shadcn/ui –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ lib/                # –£—Ç–∏–ª–∏—Ç—ã –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ supabase.ts       # Supabase client
‚îÇ   ‚îî‚îÄ‚îÄ utils.ts          # –•–µ–ª–ø–µ—Ä—ã
‚îú‚îÄ‚îÄ hooks/              # Custom React hooks
‚îú‚îÄ‚îÄ context/            # React Context (–µ—Å–ª–∏ –µ—Å—Ç—å)
‚îî‚îÄ‚îÄ utils/              # –£—Ç–∏–ª–∏—Ç—ã (Sentry –∏ —Ç.–¥.)
```

**–ü—Ä–∏–Ω—Ü–∏–ø—ã:**
- ‚úÖ –û–¥–∏–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç = –æ–¥–∏–Ω —Ñ–∞–π–ª
- ‚úÖ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤ `/components`
- ‚úÖ –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤ `/pages/*/components`
- ‚úÖ UI-kit (Shadcn) –≤ `/components/ui`

---

### Backend Architecture

```
backend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ server.ts           # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª (Express app)
‚îÇ   ‚îú‚îÄ‚îÄ routes/             # API —Ä–æ—É—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.ts            # /api/auth/*
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tripwire.ts        # /api/tripwire/*
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin.ts           # /api/admin/*
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ short-links.ts     # /api/short-links/*
‚îÇ   ‚îú‚îÄ‚îÄ services/           # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ amoCrmService.ts   # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è AmoCRM
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ emailService.ts    # –û—Ç–ø—Ä–∞–≤–∫–∞ email
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ smsService.ts      # –û—Ç–ø—Ä–∞–≤–∫–∞ SMS
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ urlShortener.ts    # –ö–æ—Ä–æ—Ç–∫–∏–µ —Å—Å—ã–ª–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ middleware/         # Express middleware
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ authMiddleware.ts  # –ü—Ä–æ–≤–µ—Ä–∫–∞ JWT
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ errorHandler.ts    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ utils/              # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logger.ts          # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ retryWithBackoff.ts # Retry –¥–ª—è API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ alerting.ts        # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sentryMonitoring.ts # Sentry
‚îÇ   ‚îî‚îÄ‚îÄ lib/
‚îÇ       ‚îî‚îÄ‚îÄ supabase.ts        # Supabase client
‚îú‚îÄ‚îÄ ecosystem.config.js     # PM2 –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ .env                    # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```

**–ü—Ä–∏–Ω—Ü–∏–ø—ã:**
- ‚úÖ –†–æ—É—Ç—ã —Ç–æ–ª—å–∫–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è, –ª–æ–≥–∏–∫–∞ –≤ `services/`
- ‚úÖ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î —á–µ—Ä–µ–∑ Supabase Client
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
- ‚úÖ Middleware –¥–ª—è auth, CORS, error handling

---

## üìÅ –°–¢–†–£–ö–¢–£–†–ê –ü–ê–ü–û–ö

### Root Level

```
onai-integrator-login/
‚îú‚îÄ‚îÄ src/                    # Frontend –∫–æ–¥
‚îú‚îÄ‚îÄ backend/                # Backend –∫–æ–¥
‚îú‚îÄ‚îÄ supabase/               # Supabase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ migrations/         # SQL –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ public/                 # –°—Ç–∞—Ç–∏–∫–∞ (index.html, images)
‚îú‚îÄ‚îÄ deploy-now.ps1          # –°–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è (PowerShell)
‚îú‚îÄ‚îÄ package.json            # Frontend dependencies
‚îú‚îÄ‚îÄ vite.config.ts          # Vite –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ tailwind.config.js      # Tailwind CSS
‚îú‚îÄ‚îÄ tsconfig.json           # TypeScript –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ .env.local              # –õ–æ–∫–∞–ª—å–Ω—ã–µ env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
```

### Supabase Migrations

```
supabase/migrations/
‚îú‚îÄ‚îÄ 20250114_create_short_links.sql
‚îú‚îÄ‚îÄ 20250115_add_performance_indexes.sql
‚îú‚îÄ‚îÄ 20250115_create_integration_tokens.sql
‚îî‚îÄ‚îÄ ... (–¥—Ä—É–≥–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏)
```

**–ü—Ä–∞–≤–∏–ª–∞ –º–∏–≥—Ä–∞—Ü–∏–π:**
- ‚úÖ –§–æ—Ä–º–∞—Ç –∏–º–µ–Ω–∏: `YYYYMMDD_–æ–ø–∏—Å–∞–Ω–∏–µ.sql`
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ Supabase Dashboard SQL Editor
- ‚úÖ –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (—Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ)
- ‚úÖ –í—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ ROLLBACK –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

---

## üîë –ö–õ–Æ–ß–ï–í–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´

### 1. Tripwire Product (–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–Ω–ª–∞–π–Ω-–∫—É—Ä—Å —Å —É—Ä–æ–∫–∞–º–∏, –∑–∞–¥–∞–Ω–∏—è–º–∏, –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º–∏

**–°—Ç—Ä–∞–Ω–∏—Ü—ã:**
- `/tripwire/profile` - –ü—Ä–æ—Ñ–∏–ª—å —Å—Ç—É–¥–µ–Ω—Ç–∞ + –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
- `/tripwire/lesson/:id` - –£—Ä–æ–∫ —Å –≤–∏–¥–µ–æ –∏ –∑–∞–¥–∞–Ω–∏–µ–º
- `/tripwire/product` - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ–¥—É–∫—Ç–∞

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `TripwireProfile.tsx` - –ü—Ä–æ—Ñ–∏–ª—å —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
- `Achievements.tsx` - –°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π (–ø—Ä–µ–º–∏—É–º –¥–∏–∑–∞–π–Ω)
- `TripwireLesson.tsx` - –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Ä–æ–∫–∞
- `LessonCard.tsx` - –ö–∞—Ä—Ç–æ—á–∫–∞ —É—Ä–æ–∫–∞

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AmoCRM:**
- –ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —É—Ä–æ–∫–∞ ‚Üí –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —ç—Ç–∞–ø —Å–¥–µ–ª–∫–∏ –≤ AmoCRM
- –≠—Ç–∞–ø—ã: Lesson 1, Lesson 2, Lesson 3, ... completed

---

### 2. Admin Panel (–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏, –ª–∏–¥–∞–º–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–°—Ç—Ä–∞–Ω–∏—Ü—ã:**
- `/admin/tripwire-manager` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏ Tripwire
- `/admin/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –¥–∞—à–±–æ—Ä–¥

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `TripwireManager.tsx` - –¢–∞–±–ª–∏—Ü–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
- `StatsCards.tsx` - –ö–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- `SalesChart.tsx` - –ì—Ä–∞—Ñ–∏–∫–∏ –ø—Ä–æ–¥–∞–∂
- `CreateUserForm.tsx` - –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç—É–¥–µ–Ω—Ç–∞

**–ó–∞—â–∏—Ç–∞:**
- ‚úÖ –†–æ—É—Ç `/admin/*` –∑–∞—â–∏—â—ë–Ω middleware `requireAdmin()`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ `admin` –≤ JWT —Ç–æ–∫–µ–Ω–µ

---

### 3. Public Landing

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –õ–µ–Ω–¥–∏–Ω–≥ –¥–ª—è –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ª–∏–¥–æ–≤

**–°—Ç—Ä–∞–Ω–∏—Ü—ã:**
- `/` - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞

**–§–æ—Ä–º—ã:**
- Email ‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `landing_leads`
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AmoCRM (—Å–æ–∑–¥–∞–Ω–∏–µ —Å–¥–µ–ª–∫–∏)

---

### 4. URL Shortener (–ö–æ—Ä–æ—Ç–∫–∏–µ —Å—Å—ã–ª–∫–∏)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫ –¥–ª—è SMS (—ç–∫–æ–Ω–æ–º–∏—è —Å–∏–º–≤–æ–ª–æ–≤)

**Endpoint:** `/api/short-links/*`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```typescript
// –°–æ–∑–¥–∞—Ç—å –∫–æ—Ä–æ—Ç–∫—É—é —Å—Å—ã–ª–∫—É
POST /api/short-links/create
{ "original_url": "https://onai.academy/tripwire/lesson/1" }
‚Üí { "short_code": "abc123", "short_url": "https://onai.academy/l/abc123" }

// –†–µ–¥–∏—Ä–µ–∫—Ç
GET /l/abc123
‚Üí 302 Redirect to original_url
```

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** –¢–∞–±–ª–∏—Ü–∞ `short_links` —Å –ø–æ–ª—è–º–∏ `short_code`, `original_url`, `clicks`

---

## üóÑÔ∏è –ë–ê–ó–ê –î–ê–ù–ù–´–•

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

#### 1. `users` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (Supabase Auth)
```sql
- id (UUID, PK)
- email (string, unique)
- created_at (timestamp)
```

#### 2. `tripwire_users` - –°—Ç—É–¥–µ–Ω—Ç—ã Tripwire
```sql
- id (UUID, PK)
- user_id (UUID, FK ‚Üí users)
- email (string)
- name (string)
- modules_completed (int)
- total_lessons_completed (int)
- amocrm_lead_id (int, nullable)
- created_at, updated_at
```

#### 3. `tripwire_progress` - –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —É—Ä–æ–∫–∞–º
```sql
- id (UUID, PK)
- tripwire_user_id (UUID, FK)
- lesson_id (int)
- module_id (int)
- is_completed (boolean)
- completed_at (timestamp, nullable)
- time_spent (int, seconds)
- created_at, updated_at
```

#### 4. `user_achievements` - –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
```sql
- id (UUID, PK)
- user_id (UUID, FK)
- achievement_id (string)
- unlocked_at (timestamp)
- created_at
```

#### 5. `certificates` - –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
```sql
- id (UUID, PK)
- user_id (UUID, FK)
- certificate_url (string)
- issued_at (timestamp)
- created_at
```

#### 6. `landing_leads` - –õ–∏–¥—ã —Å –ª–µ–Ω–¥–∏–Ω–≥–∞
```sql
- id (UUID, PK)
- email (string)
- phone (string, nullable)
- name (string, nullable)
- amocrm_lead_id (int, nullable)
- amocrm_synced (boolean)
- created_at
```

#### 7. `short_links` - –ö–æ—Ä–æ—Ç–∫–∏–µ —Å—Å—ã–ª–∫–∏
```sql
- id (UUID, PK)
- short_code (string, unique, index)
- original_url (text)
- clicks (int, default 0)
- created_at, updated_at
```

#### 8. `integration_tokens` - –¢–æ–∫–µ–Ω—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π ‚≠ê NEW
```sql
- service_name (string, PK) # 'amocrm', 'stripe', ...
- access_token (text)
- refresh_token (text, nullable)
- expires_at (timestamp, nullable)
- metadata (jsonb)
- updated_at, created_at
```

### –ò–Ω–¥–µ–∫—Å—ã (Performance)

```sql
-- Tripwire Progress
CREATE INDEX idx_tripwire_progress_user_lesson ON tripwire_progress(tripwire_user_id, lesson_id);
CREATE INDEX idx_tripwire_progress_module_completed ON tripwire_progress(module_id, is_completed);

-- Tripwire Users
CREATE INDEX idx_tripwire_users_email ON tripwire_users(email);
CREATE INDEX idx_tripwire_users_user_id ON tripwire_users(user_id);

-- Achievements
CREATE INDEX idx_user_achievements_user_created ON user_achievements(user_id, created_at DESC);

-- Short Links
CREATE INDEX idx_short_links_code ON short_links(short_code);

-- Landing Leads
CREATE INDEX idx_landing_leads_email ON landing_leads(email);
CREATE INDEX idx_landing_leads_synced ON landing_leads(amocrm_synced);
```

### RLS (Row-Level Security)

**–í–∫–ª—é—á–µ–Ω–æ –Ω–∞ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö!**

**–ü–æ–ª–∏—Ç–∏–∫–∏:**
- `tripwire_users`: –°—Ç—É–¥–µ–Ω—Ç –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ—é –∑–∞–ø–∏—Å—å
- `tripwire_progress`: –°—Ç—É–¥–µ–Ω—Ç –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å
- `user_achievements`: –°—Ç—É–¥–µ–Ω—Ç –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
- `integration_tokens`: –¢–æ–ª—å–∫–æ `service_role` (backend)

---

## üîó –ò–ù–¢–ï–ì–†–ê–¶–ò–ò

### 1. AmoCRM (CRM —Å–∏—Å—Ç–µ–º–∞)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∞–º–∏, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –≤–æ—Ä–æ–Ω–∫–∏ –ø—Ä–æ–¥–∞–∂

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env):**
```bash
AMOCRM_SUBDOMAIN=your_subdomain
AMOCRM_ACCESS_TOKEN=...
AMOCRM_REFRESH_TOKEN=...
AMOCRM_CLIENT_ID=...
AMOCRM_CLIENT_SECRET=...
AMOCRM_PIPELINE_ID=10350882
AMOCRM_STAGE_LESSON_1=...
AMOCRM_STAGE_LESSON_2=...
AMOCRM_STAGE_LESSON_3=...
```

**–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –¢–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ë–î (`integration_tokens`)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Refresh Token
- ‚úÖ –ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —É—Ä–æ–∫–∞ ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç—Ç–∞–ø–∞ —Å–¥–µ–ª–∫–∏
- ‚úÖ Retry —Å exponential backoff –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

**–§–∞–π–ª—ã:**
- `backend/src/services/amoCrmService.ts`

**API Endpoints:**
- `POST /api/tripwire/complete-lesson` ‚Üí –æ–±–Ω–æ–≤–ª—è–µ—Ç —ç—Ç–∞–ø –≤ AmoCRM

---

### 2. Resend (Email —Å–µ—Ä–≤–∏—Å)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ç–ø—Ä–∞–≤–∫–∞ email (–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–∏—Å—å–º–∞, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env):**
```bash
RESEND_API_KEY=re_...
RESEND_FROM_EMAIL=noreply@onai.academy
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```typescript
import { resend } from '@/services/emailService';

await resend.emails.send({
  from: 'noreply@onai.academy',
  to: 'user@example.com',
  subject: 'Welcome to OnAI Academy',
  html: '<h1>Hello!</h1>'
});
```

**Retry:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `retryEmail()` –∏–∑ `retryWithBackoff.ts`

---

### 3. Mobizon (SMS —Å–µ—Ä–≤–∏—Å)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ç–ø—Ä–∞–≤–∫–∞ SMS (–∫–æ—Ä–æ—Ç–∫–∏–µ —Å—Å—ã–ª–∫–∏, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env):**
```bash
MOBIZON_API_KEY=...
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```typescript
import { sendSMS } from '@/services/smsService';

await sendSMS({
  to: '+380501234567',
  text: 'Your lesson: https://onai.academy/l/abc123'
});
```

**Retry:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `retrySMS()` –∏–∑ `retryWithBackoff.ts`

---

### 4. OpenAI API

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –∞–Ω–∞–ª–∏–∑ –∑–∞–¥–∞–Ω–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env):**
```bash
OPENAI_API_KEY=sk-...
```

**Retry:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `retryOpenAI()` –∏–∑ `retryWithBackoff.ts`

---

### 5. Sentry (Error Monitoring)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ production

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env):**
```bash
# Backend
SENTRY_DSN_BACKEND=https://...@sentry.io/...
SENTRY_ENVIRONMENT=production

# Frontend
VITE_SENTRY_DSN=https://...@sentry.io/...
```

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:**
- Frontend: `src/utils/sentryMonitoring.ts`
- Backend: `backend/src/utils/sentryMonitoring.ts`

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç:**
- ‚úÖ –û—à–∏–±–∫–∏ JavaScript (frontend)
- ‚úÖ –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è (backend)
- ‚úÖ API –æ—à–∏–±–∫–∏ (>= 500)
- ‚úÖ –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (failed payments, etc.)

---

## üìè –ü–†–ê–í–ò–õ–ê –†–ê–ó–†–ê–ë–û–¢–ö–ò

### Git Workflow

**–í–µ—Ç–∫–∏:**
- `main` - Production (—Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è)
- `develop` - Development (—Ç–µ–∫—É—â–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
- `feature/*` - –§–∏—á–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ü—Ä–∞–≤–∏–ª–∞ –∫–æ–º–º–∏—Ç–æ–≤:**
```bash
# ‚úÖ –•–æ—Ä–æ—à–∏–µ –∫–æ–º–º–∏—Ç—ã
git commit -m "Add user achievements system"
git commit -m "Fix AmoCRM token refresh logic"
git commit -m "Update performance indexes"

# ‚ùå –ü–ª–æ—Ö–∏–µ –∫–æ–º–º–∏—Ç—ã
git commit -m "fix"
git commit -m "update"
git commit -m "WIP"
```

**–ü–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º:**
- ‚úÖ –ö–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –ù–µ—Ç console.log (–∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ logger)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ —Å–ª–æ–º–∞–ª–æ—Å—å

---

### Code Style

#### TypeScript

**–ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ:**
```typescript
// ‚úÖ –•–æ—Ä–æ—à–æ
const userName = 'John';
const MAX_RETRIES = 3;
interface UserProfile { ... }
function getUserById(id: string) { ... }

// ‚ùå –ü–ª–æ—Ö–æ
const user_name = 'John';  // snake_case (—Ç–æ–ª—å–∫–æ –¥–ª—è –ë–î)
const maxretries = 3;      // –±–µ–∑ underscores –¥–ª—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç
```

**–ò–º–ø–æ—Ä—Ç—ã:**
```typescript
// ‚úÖ –•–æ—Ä–æ—à–æ - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∏ –ø–æ—Ä—è–¥–æ–∫
import React, { useState } from 'react';
import { useNavigate } from 'react-router-dom';

import { Button } from '@/components/ui/button';
import { supabase } from '@/lib/supabase';

// ‚ùå –ü–ª–æ—Ö–æ - —Ö–∞–æ—Ç–∏—á–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫
import { supabase } from '@/lib/supabase';
import React from 'react';
import { Button } from '@/components/ui/button';
```

**Async/await:**
```typescript
// ‚úÖ –•–æ—Ä–æ—à–æ
try {
  const response = await api.get('/users');
  console.log(response.data);
} catch (error) {
  logger.error('Failed to fetch users:', error);
}

// ‚ùå –ü–ª–æ—Ö–æ
api.get('/users').then((response) => {
  console.log(response.data);
}).catch((error) => {
  console.error(error);
});
```

---

#### React Components

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:**
```tsx
import React, { useState, useEffect } from 'react';
import { Button } from '@/components/ui/button';

interface Props {
  userId: string;
  onComplete?: () => void;
}

export function UserProfile({ userId, onComplete }: Props) {
  // 1. State
  const [user, setUser] = useState(null);
  const [loading, setLoading] = useState(true);
  
  // 2. Effects
  useEffect(() => {
    loadUser();
  }, [userId]);
  
  // 3. Handlers
  const loadUser = async () => { ... };
  const handleSubmit = () => { ... };
  
  // 4. Render
  if (loading) return <div>Loading...</div>;
  
  return (
    <div>
      <h1>{user.name}</h1>
      <Button onClick={handleSubmit}>Save</Button>
    </div>
  );
}
```

**–ü—Ä–∞–≤–∏–ª–∞:**
- ‚úÖ –û–¥–∏–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç = –æ–¥–∏–Ω —Ñ–∞–π–ª
- ‚úÖ Props —á–µ—Ä–µ–∑ interface (–Ω–µ inline types)
- ‚úÖ Destructure props –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ Early return –¥–ª—è loading/error states

---

### Database Queries

**Supabase Client:**
```typescript
// ‚úÖ –•–æ—Ä–æ—à–æ - —á–∏—Å—Ç—ã–π –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∑–∞–ø—Ä–æ—Å
const { data, error } = await supabase
  .from('tripwire_users')
  .select('*')
  .eq('email', email)
  .single();

if (error) {
  logger.error('Database error:', error);
  throw error;
}

// ‚ùå –ü–ª–æ—Ö–æ - –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
const { data } = await supabase
  .from('tripwire_users')
  .select('*');
// –ß—Ç–æ –µ—Å–ª–∏ error?
```

**N+1 Problem - –ò–ó–ë–ï–ì–ê–¢–¨!**
```typescript
// ‚ùå –ü–õ–û–•–û - N+1 –∑–∞–ø—Ä–æ—Å–æ–≤
const users = await supabase.from('tripwire_users').select('*');
for (const user of users.data) {
  const progress = await supabase
    .from('tripwire_progress')
    .select('*')
    .eq('tripwire_user_id', user.id);
  // 1 + N –∑–∞–ø—Ä–æ—Å–æ–≤!
}

// ‚úÖ –•–û–†–û–®–û - 1 –∑–∞–ø—Ä–æ—Å —Å JOIN
const { data } = await supabase
  .from('tripwire_users')
  .select(`
    *,
    tripwire_progress(*)
  `);
// –¢–æ–ª—å–∫–æ 1 –∑–∞–ø—Ä–æ—Å!
```

---

### API Error Handling

**Backend:**
```typescript
// ‚úÖ –•–æ—Ä–æ—à–æ - –ø–æ–ª–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
app.post('/api/tripwire/complete-lesson', async (req, res) => {
  try {
    const { userId, lessonId } = req.body;
    
    if (!userId || !lessonId) {
      return res.status(400).json({ 
        error: 'Missing required fields' 
      });
    }
    
    const result = await completeLesson(userId, lessonId);
    
    res.json({ success: true, data: result });
  } catch (error) {
    logger.error('Complete lesson error:', error);
    res.status(500).json({ 
      error: 'Internal server error' 
    });
  }
});

// ‚ùå –ü–ª–æ—Ö–æ - –Ω–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
app.post('/api/tripwire/complete-lesson', async (req, res) => {
  const result = await completeLesson(req.body.userId, req.body.lessonId);
  res.json(result);
  // –ß—Ç–æ –µ—Å–ª–∏ –æ—à–∏–±–∫–∞?
});
```

---

### Logging

**–ù–û–í–û–ï: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `logger` –≤–º–µ—Å—Ç–æ `console.log`**

```typescript
import { logger } from '@/utils/logger';

// ‚úÖ –•–æ—Ä–æ—à–æ - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
logger.debug('User data:', user);           // –¢–æ–ª—å–∫–æ –≤ dev
logger.info('User created:', user.id);      // Dev + prod
logger.warn('API rate limit approaching');  // –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
logger.error('Database error:', error);     // –û—à–∏–±–∫–∏

// –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
logger.request('POST', '/api/users', 201, 45);
logger.externalApi('AmoCRM', 'update_deal', true, 150);

// ‚ùå –ü–ª–æ—Ö–æ - console.log –≤ production
console.log('User:', user);  // –ë—É–¥–µ—Ç —Å–ø–∞–º–∏—Ç—å –ª–æ–≥–∏!
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ .env:**
```bash
# Development
LOG_LEVEL=debug  # –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—Å—ë

# Production
LOG_LEVEL=warn   # –¢–æ–ª—å–∫–æ warn + error
```

---

### Security

**–ó–∞—â–∏—Ç–∞ —Ä–æ—É—Ç–æ–≤ (Backend):**
```typescript
import { requireAuth, requireAdmin } from '@/middleware/authMiddleware';

// ‚úÖ –•–æ—Ä–æ—à–æ - –∑–∞—â–∏—â—ë–Ω–Ω—ã–π —Ä–æ—É—Ç
app.get('/api/admin/users', requireAdmin, async (req, res) => {
  // –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã –º–æ–≥—É—Ç –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
});

// ‚ùå –ü–ª–æ—Ö–æ - –Ω–µ–∑–∞—â–∏—â—ë–Ω–Ω—ã–π —Ä–æ—É—Ç
app.get('/api/admin/users', async (req, res) => {
  // –õ—é–±–æ–π –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø!
});
```

**JWT Token:**
```typescript
// ‚úÖ –•–æ—Ä–æ—à–æ - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
const token = req.headers.authorization?.replace('Bearer ', '');
const { data, error } = await supabase.auth.getUser(token);

if (error || !data.user) {
  return res.status(401).json({ error: 'Unauthorized' });
}

// ‚ùå –ü–ª–æ—Ö–æ - –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏
const userId = req.body.userId;  // –õ—é–±–æ–π –º–æ–∂–µ—Ç –ø–µ—Ä–µ–¥–∞—Ç—å –ª—é–±–æ–π userId!
```

**RLS –≤ Supabase:**
- ‚úÖ –í–∫–ª—é—á–µ–Ω–æ –Ω–∞ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ Backend –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `service_role` –∫–ª—é—á (–ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø)

---

## üöÄ –î–ï–ü–õ–û–ô

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

**–°–µ—Ä–≤–µ—Ä:**
- OS: Ubuntu 20.04+
- Node.js: 18+
- PM2: –ø–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è
- Nginx: –ø–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è
- SSL: Let's Encrypt

**–î–æ–º–µ–Ω—ã:**
- Frontend: `https://onai.academy`
- API: `https://api.onai.academy`

---

### –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è

#### 1. –°–±–æ—Ä–∫–∞ Frontend

```bash
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
npm run build

# –†–µ–∑—É–ª—å—Ç–∞—Ç: dist/ –ø–∞–ø–∫–∞ —Å HTML, CSS, JS
```

#### 2. –°–±–æ—Ä–∫–∞ Backend

```bash
cd backend
npx tsc --skipLibCheck

# –†–µ–∑—É–ª—å—Ç–∞—Ç: backend/dist/ —Å JS —Ñ–∞–π–ª–∞–º–∏
```

#### 3. –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–í–∞—Ä–∏–∞–Ω—Ç A: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
```powershell
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
.\deploy-now.ps1
```

**–í–∞—Ä–∏–∞–Ω—Ç B: –†—É—á–Ω–æ–π**
```bash
# Frontend
rsync -avz --delete \
  -e "ssh -i ~/.ssh/id_rsa" \
  dist/ \
  root@207.154.231.30:/var/www/onai-integrator-login-main/

# Backend
rsync -avz \
  -e "ssh -i ~/.ssh/id_rsa" \
  backend/dist/ \
  backend/ecosystem.config.js \
  root@207.154.231.30:/var/www/onai-integrator-login-main/backend/

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ backend
ssh -i ~/.ssh/id_rsa root@207.154.231.30 '
  cd /var/www/onai-integrator-login-main/backend &&
  pm2 restart onai-backend
'
```

#### 4. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –ë–î

```bash
# –û—Ç–∫—Ä—ã—Ç—å Supabase Dashboard
# https://supabase.com/dashboard/project/YOUR_PROJECT/sql

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å SQL –∏–∑:
# supabase/migrations/YYYYMMDD_–Ω–∞–∑–≤–∞–Ω–∏–µ.sql
```

**–í–ê–ñ–ù–û:** –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –í–†–£–ß–ù–£–Æ —á–µ—Ä–µ–∑ Dashboard (–Ω–µ —á–µ—Ä–µ–∑ CLI)

---

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

```bash
# 1. –°—Ç–∞—Ç—É—Å PM2
ssh -i ~/.ssh/id_rsa root@207.154.231.30 'pm2 status'
# –û–∂–∏–¥–∞–µ—Ç—Å—è: onai-backend = online

# 2. Health Check
curl -s https://api.onai.academy/api/health/deep | jq '.'
# –û–∂–∏–¥–∞–µ—Ç—Å—è: status = "healthy"

# 3. Frontend –¥–æ—Å—Ç—É–ø–µ–Ω
curl -I https://onai.academy
# –û–∂–∏–¥–∞–µ—Ç—Å—è: 200 OK

# 4. –õ–æ–≥–∏ –±–µ–∑ –æ—à–∏–±–æ–∫
ssh -i ~/.ssh/id_rsa root@207.154.231.30 'pm2 logs onai-backend --lines 50 --nostream'
```

---

### –û—Ç–∫–∞—Ç –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

```bash
# 1. –û—Ç–∫–∞—Ç–∏—Ç—å –∫–æ–¥ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∫–æ–º–º–∏—Ç
git checkout HEAD~1

# 2. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å
npm run build
cd backend && npx tsc --skipLibCheck

# 3. –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å
rsync -avz ...

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
pm2 restart onai-backend
```

---

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì

### Health Check Endpoints

```bash
# –ü—Ä–æ—Å—Ç–æ–π health check
GET /api/health
‚Üí { "status": "ok" }

# –î–µ—Ç–∞–ª—å–Ω—ã–π health check (NEW)
GET /api/health/deep
‚Üí {
  "status": "healthy",
  "uptime": "2h 15m 30s",
  "memory": { "usagePercent": "45%" },
  "warnings": []
}
```

### PM2 Monitoring

```bash
# –°—Ç–∞—Ç—É—Å –ø—Ä–æ—Ü–µ—Å—Å–∞
pm2 status

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
pm2 logs onai-backend

# –õ–æ–≥–∏ —Ç–æ–ª—å–∫–æ –æ—à–∏–±–æ–∫
pm2 logs onai-backend --err

# –ú–µ—Ç—Ä–∏–∫–∏ (CPU, Memory)
pm2 monit

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ
pm2 info onai-backend
```

### Sentry Dashboard

- **URL:** https://sentry.io/organizations/YOUR_ORG/issues/
- **–§–∏–ª—å—Ç—Ä—ã:** 
  - Environment: production
  - Project: onai-backend, onai-frontend

### Database Monitoring

```sql
-- –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
SELECT query, mean_exec_time, calls
FROM pg_stat_statements
ORDER BY mean_exec_time DESC
LIMIT 10;

-- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤
SELECT schemaname, tablename, indexname, idx_scan
FROM pg_stat_user_indexes
WHERE schemaname = 'public'
ORDER BY idx_scan DESC;

-- –†–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü
SELECT 
  schemaname,
  tablename,
  pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) AS size
FROM pg_tables
WHERE schemaname = 'public'
ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;
```

---

## üîß –ù–û–í–´–ï –£–¢–ò–õ–ò–¢–´ (—Å –¥–µ–∫–∞–±—Ä—è 2025)

### 1. Logger (`backend/src/utils/logger.ts`)

**–ó–∞–º–µ–Ω–∞ `console.log` —Å —É—Ä–æ–≤–Ω—è–º–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è**

```typescript
import { logger } from '@/utils/logger';

logger.debug('–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è');    // –¢–æ–ª—å–∫–æ dev
logger.info('–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è');         // Dev + prod
logger.warn('–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ');           // –í—Å–µ–≥–¥–∞
logger.error('–û—à–∏–±–∫–∞');                  // –í—Å–µ–≥–¥–∞

// –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
logger.request('GET', '/api/users', 200, 45);
logger.externalApi('AmoCRM', 'update_deal', true, 150);
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:** `LOG_LEVEL=warn` –≤ `.env`

---

### 2. Retry with Backoff (`backend/src/utils/retryWithBackoff.ts`)

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API**

```typescript
import { retryAmoCRM, retryEmail, retrySMS, retryOpenAI } from '@/utils/retryWithBackoff';

// AmoCRM —Å —É–º–Ω—ã–º–∏ –ø–æ–≤—Ç–æ—Ä–∞–º–∏
const deal = await retryAmoCRM(
  async () => await amoClient.get(`/api/v4/leads/${dealId}`),
  'Get Deal'
);

// Email —Å –ø–æ–≤—Ç–æ—Ä–∞–º–∏
await retryEmail(
  async () => await resend.emails.send({ ... }),
  'Send Welcome Email'
);
```

**–õ–æ–≥–∏–∫–∞:** 1s ‚Üí 2s ‚Üí 4s ‚Üí 8s —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π

---

### 3. Alerting (`backend/src/utils/alerting.ts`)

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ —Å–±–æ—è—Ö**

```typescript
import { sendAlert, trackIntegrationFailure } from '@/utils/alerting';

// –û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–∞
await sendAlert('AmoCRM –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç 5 –º–∏–Ω—É—Ç', 'critical');

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–±–æ–µ–≤
trackIntegrationFailure('amocrm', 'update_deal', false);  // –û—à–∏–±–∫–∞
// –ü–æ—Å–ª–µ 5 –æ—à–∏–±–æ–∫ –ø–æ–¥—Ä—è–¥ ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–ª–µ—Ä—Ç –∞–¥–º–∏–Ω–∞–º

// –°–±—Ä–æ—Å –ø—Ä–∏ —É—Å–ø–µ—Ö–µ
trackIntegrationFailure('amocrm', 'update_deal', true);
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:** `TELEGRAM_BOT_TOKEN`, `ADMIN_TELEGRAM_CHAT_ID` –≤ `.env`

---

## üìö –í–ê–ñ–ù–´–ï –î–û–ö–£–ú–ï–ù–¢–´

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

- **`PROJECT_ARCHITECTURE.md`** (—ç—Ç–æ—Ç —Ñ–∞–π–ª) - –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **`backend/OPTIMIZATION_DEPLOYMENT_GUIDE.md`** - –ì–∞–π–¥ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º
- **`QUICK_OPTIMIZATION_CHECKLIST.md`** - –ë—ã—Å—Ç—Ä—ã–π —á–µ–∫–ª–∏—Å—Ç
- **`backend/AUTO_RESTART_DEPLOYMENT_GUIDE.md`** - –ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ backend
- **`DEPLOYMENT_GUIDE_DIGITALOCEAN.md`** - –î–µ–ø–ª–æ–π –Ω–∞ DigitalOcean

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–æ–∫–∏

- **`SUPABASE_DATABASE_SCHEMA_DOCUMENTATION.md`** - –°—Ö–µ–º–∞ –ë–î
- **`URL_SHORTENER_DOCUMENTATION.md`** - –ö–æ—Ä–æ—Ç–∫–∏–µ —Å—Å—ã–ª–∫–∏
- **`SENTRY_SETUP.md`** - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Sentry

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ü–†–ê–í–ò–õ–ê

### ‚ùå –ß–¢–û –ù–ï–õ–¨–ó–Ø –î–ï–õ–ê–¢–¨

1. **–ù–ï –î–ï–ü–õ–û–ò–¢–¨ –Ω–∞ Vercel** - —Ç–æ–ª—å–∫–æ DigitalOcean —á–µ—Ä–µ–∑ rsync
2. **–ù–ï –ö–û–ú–ú–ò–¢–ò–¢–¨ .env —Ñ–∞–π–ª—ã** - —Ç–æ–ª—å–∫–æ .env.example
3. **–ù–ï –†–ï–î–ê–ö–¢–ò–†–û–í–ê–¢–¨ —Å—Ç–∞—Ä—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏** - —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ
4. **–ù–ï –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨ console.log –≤ production** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `logger`
5. **–ù–ï –•–ê–†–î–ö–û–î–ò–¢–¨ —Ç–æ–∫–µ–Ω—ã/–∫–ª—é—á–∏** - —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ .env
6. **–ù–ï –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨ –æ—à–∏–±–∫–∏ –ë–î** - –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å `error`
7. **–ù–ï –î–ï–õ–ê–¢–¨ N+1 –∑–∞–ø—Ä–æ—Å—ã** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å JOIN
8. **–ù–ï –ó–ê–ë–´–í–ê–¢–¨ –ø—Ä–æ RLS** - –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### ‚úÖ –ß–¢–û –ù–£–ñ–ù–û –î–ï–õ–ê–¢–¨

1. **–í–°–ï–ì–î–ê —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ** –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
2. **–í–°–ï–ì–î–ê –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ª–æ–≥–∏** –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
3. **–í–°–ï–ì–î–ê –¥–µ–ª–∞—Ç—å –±—ç–∫–∞–ø –ë–î** –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
4. **–í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å try/catch** –¥–ª—è async –æ–ø–µ—Ä–∞—Ü–∏–π
5. **–í–°–ï–ì–î–ê –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏** (—á–µ—Ä–µ–∑ `logger.error`)
6. **–í–°–ï–ì–î–ê –ø—Ä–æ–≤–µ—Ä—è—Ç—å health check** –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
7. **–í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å TypeScript** (–Ω–µ any!)
8. **–í–°–ï–ì–î–ê –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É**

---

## üéì ONBOARDING –î–õ–Ø –ù–û–í–´–• –†–ê–ó–†–ê–ë–û–¢–ß–ò–ö–û–í

### –î–µ–Ω—å 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `npm install` + `cd backend && npm install`
3. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å `.env.example` ‚Üí `.env.local` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ: `npm run dev` (frontend) + `cd backend && npm run dev`
5. –û—Ç–∫—Ä—ã—Ç—å http://localhost:5173

### –î–µ–Ω—å 2: –ò–∑—É—á–µ–Ω–∏–µ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã

1. –ü—Ä–æ—á–∏—Ç–∞—Ç—å `PROJECT_ARCHITECTURE.md` (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
2. –ò–∑—É—á–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫
3. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã: `TripwireProfile`, `TripwireLesson`
4. –ò–∑—É—á–∏—Ç—å API endpoints –≤ `backend/src/routes/`

### –î–µ–Ω—å 3: –ü–µ—Ä–≤—ã–π –∫–æ–º–º–∏—Ç

1. –í—ã–±—Ä–∞—Ç—å –ø—Ä–æ—Å—Ç—É—é –∑–∞–¥–∞—á—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑–º–µ–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
2. –°–æ–∑–¥–∞—Ç—å –≤–µ—Ç–∫—É: `git checkout -b feature/my-first-change`
3. –°–¥–µ–ª–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
5. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏ —Å–æ–∑–¥–∞—Ç—å PR

### –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- **Supabase Docs:** https://supabase.com/docs
- **Shadcn/ui:** https://ui.shadcn.com
- **React Router:** https://reactrouter.com
- **Express.js:** https://expressjs.com
- **PM2 Docs:** https://pm2.keymetrics.io

---

## üìû –ö–û–ù–¢–ê–ö–¢–´ –ò –ü–û–î–î–ï–†–ñ–ö–ê

### –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å:

- **–î–µ–ø–ª–æ–µ–º:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `DEPLOYMENT_GUIDE_DIGITALOCEAN.md`
- **–ë–î:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `SUPABASE_DATABASE_SCHEMA_DOCUMENTATION.md`
- **–û—à–∏–±–∫–∞–º–∏:** –û—Ç–∫—Ä—ã—Ç—å Sentry Dashboard
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –∏ –ª–æ–≥–∏ PM2

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**1. Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
pm2 logs onai-backend --err --lines 100

# –ß–∞—Å—Ç—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
# - .env –Ω–µ –æ–±–Ω–æ–≤–ª—ë–Ω
# - –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
# - –ü–æ—Ä—Ç –∑–∞–Ω—è—Ç
```

**2. AmoCRM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω—ã –≤ –ë–î
SELECT service_name, LEFT(access_token, 20), expires_at 
FROM integration_tokens 
WHERE service_name = 'amocrm';

# –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω—ã –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
```

**3. Frontend –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–µ–ª—ã–π —ç–∫—Ä–∞–Ω**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (F12 ‚Üí Console)
# –ß–∞—Å—Ç—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
# - .env.local –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω (VITE_SUPABASE_URL –∏ —Ç.–¥.)
# - CORS –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ backend
# - API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
```

---

## üîÑ –í–ï–†–°–ò–û–ù–ò–†–û–í–ê–ù–ò–ï

**–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è:** 2.0 (–î–µ–∫–∞–±—Ä—å 2025)

**Changelog:**
- **v2.0** (–î–µ–∫–∞–±—Ä—å 2025):
  - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω–¥–µ–∫—Å—ã –ë–î –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
  - ‚úÖ –¢–æ–∫–µ–Ω—ã AmoCRM —Ç–µ–ø–µ—Ä—å –≤ –ë–î (–Ω–µ –≤ –ø–∞–º—è—Ç–∏)
  - ‚úÖ –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Å —É—Ä–æ–≤–Ω—è–º–∏
  - ‚úÖ Retry with exponential backoff –¥–ª—è API
  - ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤ –ø—Ä–∏ —Å–±–æ—è—Ö
  - ‚úÖ Health check endpoint `/api/health/deep`
  - ‚úÖ –ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ backend —á–µ—Ä–µ–∑ PM2

- **v1.x** (–î–æ –¥–µ–∫–∞–±—Ä—è 2025):
  - –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å Tripwire
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è AmoCRM
  - Admin –ø–∞–Ω–µ–ª—å
  - URL Shortener

---

## üìù –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç - **–≥–ª–∞–≤–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã** –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ø—Ä–æ–µ–∫—Ç–∞.

**–ü—Ä–∏ –≤–Ω–µ—Å–µ–Ω–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ technical docs
- ‚úÖ –°–æ–æ–±—â–∏—Ç—å –∫–æ–º–∞–Ω–¥–µ –æ breaking changes

**–î–ª—è AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–≤:**
- –í—Å–µ–≥–¥–∞ —á–∏—Ç–∞—Ç—å —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –ø–µ—Ä–µ–¥ —Ä–∞–±–æ—Ç–æ–π —Å –∫–æ–¥–æ–º
- –°–ª–µ–¥–æ–≤–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–º –ø—Ä–∏–Ω—Ü–∏–ø–∞–º
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- –ù–µ –Ω–∞—Ä—É—à–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

**–í–µ—Ä—Å–∏—è:** 2.0  
**–î–∞—Ç–∞:** –î–µ–∫–∞–±—Ä—å 2025  
**–ê–≤—Ç–æ—Ä:** OnAI Academy Team  

‚úÖ **–ì–û–¢–û–í–û –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ!**
