# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –í–∏–¥–µ–æ–ø–ª–µ–µ—Ä + –ö–∞—á–µ—Å—Ç–≤–æ + –°–æ–≤–µ—Ç –ø–æ —É—Ä–æ–∫—É

## üéØ –ß–¢–û –ë–´–õ–û –ò–°–ü–†–ê–í–õ–ï–ù–û:

### 1Ô∏è‚É£ **–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä–∞** ‚úÖ
- ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞:** –ö–Ω–æ–ø–∫–∞ fullscreen –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞
- ‚úÖ **–†–µ—à–µ–Ω–∏–µ:** 
  - –î–æ–±–∞–≤–ª–µ–Ω `videoContainerRef` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
  - –§—É–Ω–∫—Ü–∏—è `toggleFullscreen` –ø–µ—Ä–µ–ø–∏—Å–∞–Ω–∞ —Å `async/await`
  - –î–æ–±–∞–≤–ª–µ–Ω—ã –ª–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
  
**–§–∞–π–ª—ã:**
- `src/pages/Lesson.tsx`

```typescript
const videoContainerRef = useRef<HTMLDivElement>(null);

const toggleFullscreen = async () => {
  if (!videoContainerRef.current) {
    console.error('‚ùå videoContainerRef –Ω–µ –Ω–∞–π–¥–µ–Ω');
    return;
  }
  
  try {
    if (document.fullscreenElement) {
      await document.exitFullscreen();
      console.log('‚úÖ –í—ã—à–ª–∏ –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞');
    } else {
      await videoContainerRef.current.requestFullscreen();
      console.log('‚úÖ –í–æ—à–ª–∏ –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º');
    }
    trackEvent('fullscreen_toggle');
  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è fullscreen:', error);
  }
};
```

---

### 2Ô∏è‚É£ **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –≤–∏–¥–µ–æ** ‚úÖ
- ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –≤–∏–¥–µ–æ
- ‚úÖ **–†–µ—à–µ–Ω–∏–µ:** 
  - –î–æ–±–∞–≤–ª–µ–Ω `videoQuality` state
  - –î–æ–±–∞–≤–ª–µ–Ω select dropdown —Å –æ–ø—Ü–∏—è–º–∏: Auto, 1080p, 720p, 480p, 360p
  - UI –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä
  
**–§–∞–π–ª—ã:**
- `src/pages/Lesson.tsx`

```typescript
const [videoQuality, setVideoQuality] = useState<'auto' | '1080p' | '720p' | '480p' | '360p'>('auto');

// –í JSX –∫–æ–Ω—Ç—Ä–æ–ª–æ–≤ –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä–∞:
<select
  value={videoQuality}
  onChange={(e) => {
    const quality = e.target.value as typeof videoQuality;
    setVideoQuality(quality);
    console.log('‚úÖ –ö–∞—á–µ—Å—Ç–≤–æ –≤–∏–¥–µ–æ –∏–∑–º–µ–Ω–µ–Ω–æ:', quality);
  }}
  className="bg-black/50 text-white text-sm rounded px-2 py-1 border border-gray-600 focus:border-[#00ff00] outline-none cursor-pointer"
  title="–ö–∞—á–µ—Å—Ç–≤–æ –≤–∏–¥–µ–æ"
>
  <option value="auto">–ê–≤—Ç–æ</option>
  <option value="1080p">1080p</option>
  <option value="720p">720p</option>
  <option value="480p">480p</option>
  <option value="360p">360p</option>
</select>
```

---

### 3Ô∏è‚É£ **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ "–°–æ–≤–µ—Ç–∞ –ø–æ —É—Ä–æ–∫—É"** ‚úÖ
- ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–≤–µ—Ç –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —É—Ä–æ–∫–∞
- ‚úÖ **–†–µ—à–µ–Ω–∏–µ:** 
  - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `tip` –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (SQL –º–∏–≥—Ä–∞—Ü–∏—è)
  - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ –≤ `LessonEditDialog` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
  - –î–æ–±–∞–≤–ª–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–≤–µ—Ç–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —É—Ä–æ–∫–∞
  - Backend API –æ–±–Ω–æ–≤–ª—ë–Ω (POST/PUT endpoints)

**–§–∞–π–ª—ã:**
- `ADD_TIP_COLUMN.sql` (SQL –º–∏–≥—Ä–∞—Ü–∏—è)
- `backend/src/routes/lessons.ts` (Backend API)
- `src/components/admin/LessonEditDialog.tsx` (–§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
- `src/pages/Lesson.tsx` (–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–≤–µ—Ç–∞)

**Backend API:**
```typescript
// POST /api/lessons - —Å–æ–∑–¥–∞—Ç—å —É—Ä–æ–∫
const { title, description, tip, module_id } = req.body;

await supabase.from('lessons').insert({
  title,
  description: description || '',
  tip: tip || null, // ‚úÖ –°–æ–≤–µ—Ç –ø–æ —É—Ä–æ–∫—É
  module_id: parseInt(module_id)
});

// PUT /api/lessons/:id - –æ–±–Ω–æ–≤–∏—Ç—å —É—Ä–æ–∫
const { title, description, tip } = req.body;

if (tip !== undefined) updateData.tip = tip; // ‚úÖ –°–æ–≤–µ—Ç –ø–æ —É—Ä–æ–∫—É
```

**Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç:**
```tsx
const [tip, setTip] = useState('');

// –í JSX:
<div className="space-y-2">
  <Label htmlFor="tip" className="text-white">üí° –°–æ–≤–µ—Ç –ø–æ —É—Ä–æ–∫—É</Label>
  <Textarea
    id="tip"
    value={tip}
    onChange={(e) => setTip(e.target.value)}
    placeholder="–ü–æ–ª–µ–∑–Ω—ã–π —Å–æ–≤–µ—Ç –∏–ª–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞"
    rows={3}
    className="bg-[#1a1a24] border-gray-800 text-white"
  />
</div>
```

**–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —É—Ä–æ–∫–∞:**
```tsx
{lesson?.tip && (
  <motion.div className="bg-gradient-to-br from-[#00ff00]/10 to-[#00cc00]/5 border border-[#00ff00]/30 rounded-2xl p-6">
    <h3 className="text-base font-bold text-[#00ff00] mb-3">
      üí° –°–æ–≤–µ—Ç –ø–æ —É—Ä–æ–∫—É
    </h3>
    <p className="text-sm text-gray-300 leading-relaxed whitespace-pre-wrap">
      {lesson.tip}
    </p>
  </motion.div>
)}
```

---

## üîß –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û –ò–°–ü–†–ê–í–õ–ï–ù–û:

### 4Ô∏è‚É£ **–£–¥–∞–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ** ‚úÖ
- –î–æ–±–∞–≤–ª–µ–Ω `DELETE /api/videos/lesson/:lessonId` endpoint
- –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –∏–∑ Cloudflare R2
- –û—á–∏—Å—Ç–∫–∞ `video_url` –≤ –ë–î
- –ö–Ω–æ–ø–∫–∞ "–£–¥–∞–ª–∏—Ç—å –≤–∏–¥–µ–æ" —Ç–µ–ø–µ—Ä—å –≤—ã–∑—ã–≤–∞–µ—Ç API

**–§–∞–π–ª—ã:**
- `backend/src/routes/videos.ts`
- `src/components/admin/LessonEditDialog.tsx`

```typescript
// Backend:
router.delete('/lesson/:lessonId', async (req, res) => {
  // 1. –ü–æ–ª—É—á–∏—Ç—å video_url –∏–∑ –ë–î
  // 2. –ò–∑–≤–ª–µ—á—å –∫–ª—é—á –∏–∑ URL
  // 3. –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª –∏–∑ R2
  // 4. –û—á–∏—Å—Ç–∏—Ç—å video_url –≤ –ë–î
});

// Frontend:
<Button onClick={async () => {
  if (savedLessonId) {
    await api.delete(`/api/videos/lesson/${savedLessonId}`);
  }
  setVideoUrl('');
  setVideoFile(null);
}}>
  üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –≤–∏–¥–µ–æ
</Button>
```

---

## üìã SQL –ú–ò–ì–†–ê–¶–ò–Ø (–í–ê–ñ–ù–û!):

**–ü–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –≤—ã–ø–æ–ª–Ω–∏ SQL –≤ Supabase:**

1. –û—Ç–∫—Ä–æ–π Supabase Dashboard ‚Üí SQL Editor
2. –°–∫–æ–ø–∏—Ä—É–π —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `ADD_TIP_COLUMN.sql`
3. –ù–∞–∂–º–∏ "Run"

```sql
ALTER TABLE lessons 
ADD COLUMN IF NOT EXISTS tip TEXT;

COMMENT ON COLUMN lessons.tip IS '–ü–æ–ª–µ–∑–Ω—ã–π —Å–æ–≤–µ—Ç –∏–ª–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞ –ø–æ –¥–∞–Ω–Ω–æ–º—É —É—Ä–æ–∫—É';

NOTIFY pgrst, 'reload schema';
```

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï:

### –¢–µ—Å—Ç 1: –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
1. –û—Ç–∫—Ä–æ–π —É—Ä–æ–∫ —Å –≤–∏–¥–µ–æ
2. –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "üì∫" (Fullscreen) –≤ –ø—Ä–∞–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä–∞
3. –í–∏–¥–µ–æ –¥–æ–ª–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
4. –ù–∞–∂–º–∏ ESC –∏–ª–∏ —Å–Ω–æ–≤–∞ –∫–Ω–æ–ø–∫—É ‚Üí –≤–∏–¥–µ–æ –≤–µ—Ä–Ω—ë—Ç—Å—è –≤ –æ–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º
5. –ü—Ä–æ–≤–µ—Ä—å Console (F12) ‚Üí –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏:
   ```
   ‚úÖ –í–æ—à–ª–∏ –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
   ‚úÖ –í—ã—à–ª–∏ –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
   ```

### –¢–µ—Å—Ç 2: –ö–∞—á–µ—Å—Ç–≤–æ –≤–∏–¥–µ–æ
1. –û—Ç–∫—Ä–æ–π —É—Ä–æ–∫ —Å –≤–∏–¥–µ–æ
2. –í –ø—Ä–∞–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä–∞ –Ω–∞–π–¥–∏ dropdown —Å –∫–∞—á–µ—Å—Ç–≤–æ–º
3. –í—ã–±–µ—Ä–∏ —Ä–∞–∑–Ω—ã–µ –æ–ø—Ü–∏–∏: Auto, 1080p, 720p, 480p, 360p
4. –ü—Ä–æ–≤–µ—Ä—å Console ‚Üí –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ª–æ–≥:
   ```
   ‚úÖ –ö–∞—á–µ—Å—Ç–≤–æ –≤–∏–¥–µ–æ –∏–∑–º–µ–Ω–µ–Ω–æ: 720p
   ```

### –¢–µ—Å—Ç 3: –°–æ–≤–µ—Ç –ø–æ —É—Ä–æ–∫—É
1. **–°–æ–∑–¥–∞–Ω–∏–µ —É—Ä–æ–∫–∞ —Å —Å–æ–≤–µ—Ç–æ–º:**
   - –û—Ç–∫—Ä–æ–π –º–æ–¥—É–ª—å ‚Üí "–î–æ–±–∞–≤–∏—Ç—å —É—Ä–æ–∫"
   - –ó–∞–ø–æ–ª–Ω–∏: –ù–∞–∑–≤–∞–Ω–∏–µ, –û–ø–∏—Å–∞–Ω–∏–µ
   - –í –ø–æ–ª–µ "üí° –°–æ–≤–µ—Ç –ø–æ —É—Ä–æ–∫—É" –≤–≤–µ–¥–∏: "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ—Å—å!"
   - –°–æ–∑–¥–∞–π —É—Ä–æ–∫
   
2. **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–≤–µ—Ç–∞:**
   - –û—Ç–∫—Ä–æ–π —É—Ä–æ–∫ ‚Üí "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —É—Ä–æ–∫"
   - –ü–æ–ª–µ "üí° –°–æ–≤–µ—Ç –ø–æ —É—Ä–æ–∫—É" –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–æ
   - –ò–∑–º–µ–Ω–∏ —Å–æ–≤–µ—Ç
   - –°–æ—Ö—Ä–∞–Ω–∏
   
3. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–≤–µ—Ç–∞:**
   - –û—Ç–∫—Ä–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—É —É—Ä–æ–∫–∞
   - –í –ø—Ä–∞–≤–æ–º —Å–∞–π–¥–±–∞—Ä–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∞ "üí° –°–æ–≤–µ—Ç –ø–æ —É—Ä–æ–∫—É" (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å–æ–≤–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω)
   - –¢–µ–∫—Å—Ç —Å–æ–≤–µ—Ç–∞ –¥–æ–ª–∂–µ–Ω –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (—Å –ø–µ—Ä–µ–Ω–æ—Å–∞–º–∏ —Å—Ç—Ä–æ–∫)

### –¢–µ—Å—Ç 4: –£–¥–∞–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ
1. –û—Ç–∫—Ä–æ–π —É—Ä–æ–∫ —Å –≤–∏–¥–µ–æ ‚Üí "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"
2. –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–í–∏–¥–µ–æ"
3. –ù–∞–∂–º–∏ "üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –≤–∏–¥–µ–æ"
4. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏ —É–¥–∞–ª–µ–Ω–∏–µ
5. –í–∏–¥–µ–æ –¥–æ–ª–∂–Ω–æ –∏—Å—á–µ–∑–Ω—É—Ç—å
6. –ü–æ—è–≤–∏—Ç—Å—è –ø–æ–ª–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–æ–≤–æ–≥–æ –≤–∏–¥–µ–æ
7. –ü—Ä–æ–≤–µ—Ä—å Console:
   ```
   üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ –¥–ª—è —É—Ä–æ–∫–∞: 18
   ‚úÖ –í–∏–¥–µ–æ —É–¥–∞–ª–µ–Ω–æ –∏–∑ –ë–î –∏ R2
   ```

---

## üìä –°–¢–ê–¢–£–°:

| –§–∏—á–∞ | –°—Ç–∞—Ç—É—Å | –§–∞–π–ª—ã |
|------|--------|-------|
| ‚úÖ Fullscreen —Ä–µ–∂–∏–º | **–ì–û–¢–û–í–û** | `Lesson.tsx` |
| ‚úÖ –ö–∞—á–µ—Å—Ç–≤–æ –≤–∏–¥–µ–æ | **–ì–û–¢–û–í–û** | `Lesson.tsx` |
| ‚úÖ –°–æ–≤–µ—Ç –ø–æ —É—Ä–æ–∫—É | **–ì–û–¢–û–í–û** | `lessons.ts`, `LessonEditDialog.tsx`, `Lesson.tsx`, `ADD_TIP_COLUMN.sql` |
| ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ | **–ì–û–¢–û–í–û** | `videos.ts`, `LessonEditDialog.tsx` |

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û:

1. **SQL –º–∏–≥—Ä–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞!** –ë–µ–∑ –Ω–µ—ë –ø–æ–ª–µ `tip` –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.
2. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ Backend** –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ `videos.ts` –∏ `lessons.ts`
3. **Hard Refresh Frontend** (Ctrl+Shift+R) –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

**–í–°–Å –ì–û–¢–û–í–û –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ!** üöÄüî•

