# üöÄ –î–ï–ü–õ–û–ô EDGE FUNCTION

## ‚úÖ –ß–¢–û –£–ñ–ï –°–î–ï–õ–ê–ù–û:

1. ‚úÖ –°–æ–∑–¥–∞–Ω–∞ Edge Function: `supabase/functions/create-student/index.ts`
2. ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω StudentsActivity.tsx –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ—É–Ω–∫—Ü–∏–µ–π
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–±–æ—Ä —Ä–æ–ª–∏ (–°—Ç—É–¥–µ–Ω—Ç / –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç)
4. ‚úÖ –ö–æ–¥ –∑–∞–¥–µ–ø–ª–æ–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä

---

## üéØ –û–°–¢–ê–õ–û–°–¨: –ó–ê–î–ï–ü–õ–û–ò–¢–¨ EDGE FUNCTION –í SUPABASE

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Supabase CLI (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

**–ï—Å–ª–∏ —É —Ç–µ–±—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Supabase CLI:**

```bash
cd "/Users/miso/Documents/MVP onAI Academy Platform/onai-integrator-login"

# –õ–æ–≥–∏–Ω –≤ Supabase
supabase login

# –õ–∏–Ω–∫ –∫ –ø—Ä–æ–µ–∫—Ç—É
supabase link --project-ref capdjvokjdivxjfdddmx

# –î–µ–ø–ª–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
supabase functions deploy create-student
```

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ Supabase Dashboard (–ü–†–û–©–ï)

**–ï—Å–ª–∏ –Ω–µ—Ç CLI, —Å–æ–∑–¥–∞–π —Ñ—É–Ω–∫—Ü–∏—é –≤—Ä—É—á–Ω—É—é:**

1. **–û—Ç–∫—Ä–æ–π Supabase Dashboard:**
   ```
   https://supabase.com/dashboard/project/capdjvokjdivxjfdddmx/functions
   ```

2. **–ù–∞–∂–º–∏ "Create a new function"**

3. **–ù–∞—Å—Ç—Ä–æ–π —Ñ—É–Ω–∫—Ü–∏—é:**
   - **Name:** `create-student`
   - **Region:** –ë–ª–∏–∂–∞–π—à–∏–π —Ä–µ–≥–∏–æ–Ω
   - **Verify JWT:** –û—Ç–∫–ª—é—á–∏ (–µ—Å–ª–∏ —Å–æ–∑–¥–∞—ë–º —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É)

4. **–°–∫–æ–ø–∏—Ä—É–π –∫–æ–¥ –∏–∑:**
   ```
   supabase/functions/create-student/index.ts
   ```

5. **–í—Å—Ç–∞–≤—å –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä —Ñ—É–Ω–∫—Ü–∏–∏**

6. **–ù–∞–∂–º–∏ "Deploy"**

---

## üß™ –ü–†–û–í–ï–†–ö–ê: –†–ê–ë–û–¢–ê–ï–¢ –õ–ò –§–£–ù–ö–¶–ò–Ø

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–ª–∞—Å—å

**–û—Ç–∫—Ä–æ–π:**
```
https://supabase.com/dashboard/project/capdjvokjdivxjfdddmx/functions
```

–î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ñ—É–Ω–∫—Ü–∏—è `create-student` —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "Active"

---

### –¢–µ—Å—Ç 2: –ü–æ–ø—Ä–æ–±—É–π —Å–æ–∑–¥–∞—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É

1. **–í–æ–π–¥–∏ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –∫–∞–∫ –∞–¥–º–∏–Ω:**
   ```
   https://onai.academy/admin/students-activity
   ```

2. **–ù–∞–∂–º–∏ "–î–æ–±–∞–≤–∏—Ç—å —É—á–µ–Ω–∏–∫–∞"**

3. **–ó–∞–ø–æ–ª–Ω–∏ —Ñ–æ—Ä–º—É:**
   ```
   Email: test.student@gmail.com
   –ò–º—è: –¢–µ—Å—Ç–æ–≤—ã–π –°—Ç—É–¥–µ–Ω—Ç
   –†–æ–ª—å: –°—Ç—É–¥–µ–Ω—Ç
   ```

4. **–ù–∞–∂–º–∏ "–°–æ–∑–¥–∞—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞"**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –º–æ–¥–∞–ª–∫–∞ —Å email –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º
- ‚úÖ –°—Ç—É–¥–µ–Ω—Ç –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ
- ‚úÖ –ú–æ–∂–Ω–æ –≤–æ–π—Ç–∏ –ø–æ–¥ —ç—Ç–∏–º–∏ —É—á—ë—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

---

## üêõ –ï–°–õ–ò –ù–ï –†–ê–ë–û–¢–ê–ï–¢

### –û—à–∏–±–∫–∞: "Failed to invoke function"

**–ü—Ä–∏—á–∏–Ω–∞:** –§—É–Ω–∫—Ü–∏—è –Ω–µ –∑–∞–¥–µ–ø–ª–æ–µ–Ω–∞ –∏–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∞ –≤ –∫–æ–¥–µ

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –µ—Å—Ç—å –≤ Supabase Dashboard
2. –ü–æ—Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ Dashboard
3. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

---

### –û—à–∏–±–∫–∞: "Failed to create user"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Ç –ø—Ä–∞–≤ —É service_role key

**–†–µ—à–µ–Ω–∏–µ:**
–ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –≤ Supabase Project Settings ‚Üí API –µ—Å—Ç—å `service_role` key

---

### –û—à–∏–±–∫–∞: "Email already exists"

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ –µ—Å—Ç—å

**–†–µ—à–µ–Ω–∏–µ:**
–ò—Å–ø–æ–ª—å–∑—É–π –¥—Ä—É–≥–æ–π email –∏–ª–∏ —É–¥–∞–ª–∏ —Å—Ç–∞—Ä–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
```
https://supabase.com/dashboard/project/capdjvokjdivxjfdddmx/auth/users
```

---

## ‚úÖ –ü–û–°–õ–ï –£–°–ü–ï–®–ù–û–ì–û –î–ï–ü–õ–û–Ø:

**–¢–µ–ø–µ—Ä—å –º–æ–∂–µ—à—å:**
1. ‚úÖ –°–æ–∑–¥–∞–≤–∞—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
2. ‚úÖ –í—ã–±–∏—Ä–∞—Ç—å —Ä–æ–ª—å (–°—Ç—É–¥–µ–Ω—Ç / –¢–µ—Ö—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç)
3. ‚úÖ –ü–æ–ª—É—á–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞
4. ‚úÖ –°—Ç—É–¥–µ–Ω—Ç—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ `auth.users` –ò `public.users`
5. ‚úÖ –°—Ç—É–¥–µ–Ω—Ç—ã –º–æ–≥—É—Ç —Å—Ä–∞–∑—É –≤–æ–π—Ç–∏ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É

---

## üéØ –ö–ê–ö –î–û–ë–ê–í–õ–Ø–¢–¨ –°–¢–£–î–ï–ù–¢–û–í:

1. –û—Ç–∫—Ä–æ–π: `https://onai.academy/admin/students-activity`
2. –ù–∞–∂–º–∏: "–î–æ–±–∞–≤–∏—Ç—å —É—á–µ–Ω–∏–∫–∞"
3. –ó–∞–ø–æ–ª–Ω–∏: Email, –ò–º—è, –†–æ–ª—å
4. –ù–∞–∂–º–∏: "–°–æ–∑–¥–∞—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞"
5. –°–∫–æ–ø–∏—Ä—É–π: Email –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å
6. –û—Ç–ø—Ä–∞–≤—å —Å—Ç—É–¥–µ–Ω—Ç—É: Email, –ø–∞—Ä–æ–ª—å –∏ —Å—Å—ã–ª–∫—É –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É

---

**–ü–æ–ø—Ä–æ–±—É–π —Å–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ –∏ —Å–∫–∞–∂–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç! üöÄ**

