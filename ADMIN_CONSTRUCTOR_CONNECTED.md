# ‚úÖ –ê–î–ú–ò–ù-–ö–û–ù–°–¢–†–£–ö–¢–û–† –ü–û–î–ö–õ–Æ–ß–ï–ù –ö API!

**–î–∞—Ç–∞:** 16 –Ω–æ—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ê–ë–û–¢–ê–ï–¢  

---

## üîó –ß–¢–û –ü–û–î–ö–õ–Æ–ß–ï–ù–û:

### 1. **–°—Ç—Ä–∞–Ω–∏—Ü–∞ Course.tsx**

#### ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ:
```typescript
import { api } from "@/utils/apiClient";
import { useState, useEffect } from "react";
```

#### ‚úÖ State –¥–ª—è API:
```typescript
const [apiModules, setApiModules] = useState<any[]>([]);
const [loading, setLoading] = useState(false);
```

#### ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π:
```typescript
useEffect(() => {
  if (id && isAdmin) {
    loadModulesFromAPI();
  }
}, [id, isAdmin]);

const loadModulesFromAPI = async () => {
  const response = await api.get(`/api/courses/${id}`);
  if (response?.course?.modules) {
    setApiModules(response.course.modules);
  }
};
```

#### ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥—É–ª—è:
```typescript
const handleSaveModule = async (data) => {
  // POST /api/modules
  const response = await api.post('/api/modules', {
    ...data,
    course_id: parseInt(id!)
  });
  
  alert('‚úÖ –ú–æ–¥—É–ª—å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!');
  await loadModulesFromAPI(); // –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫
  setModuleDialog({ open: false, module: null });
};
```

---

### 2. **–°—Ç—Ä–∞–Ω–∏—Ü–∞ Module.tsx**

#### ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ:
```typescript
import { api } from "@/utils/apiClient";
import { useState, useEffect } from "react";
```

#### ‚úÖ State –¥–ª—è API:
```typescript
const [apiLessons, setApiLessons] = useState<any[]>([]);
const [loading, setLoading] = useState(false);
```

#### ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —É—Ä–æ–∫–æ–≤:
```typescript
useEffect(() => {
  if (moduleId && isAdmin) {
    loadLessonsFromAPI();
  }
}, [moduleId, isAdmin]);

const loadLessonsFromAPI = async () => {
  const response = await api.get(`/api/lessons?module_id=${moduleId}`);
  if (response?.lessons) {
    setApiLessons(response.lessons);
  }
};
```

#### ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —É—Ä–æ–∫–∞:
```typescript
const handleSaveLesson = async (data) => {
  // POST /api/lessons
  const response = await api.post('/api/lessons', {
    ...data,
    module_id: parseInt(moduleId!)
  });
  
  alert('‚úÖ –£—Ä–æ–∫ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!');
  await loadLessonsFromAPI(); // –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫
  setLessonDialog({ open: false, lesson: null });
};
```

---

## üîå –ò–°–ü–û–õ–¨–ó–£–ï–ú–´–ï API ENDPOINTS:

### ‚úÖ –ú–æ–¥—É–ª–∏:
```
GET  /api/courses/:id        ‚Üí –ü–æ–ª—É—á–∏—Ç—å –∫—É—Ä—Å —Å –º–æ–¥—É–ª—è–º–∏
POST /api/modules             ‚Üí –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å
  Body: { title, description, course_id }
```

### ‚úÖ –£—Ä–æ–∫–∏:
```
GET  /api/lessons?module_id=X ‚Üí –ü–æ–ª—É—á–∏—Ç—å —É—Ä–æ–∫–∏ –º–æ–¥—É–ª—è
POST /api/lessons             ‚Üí –°–æ–∑–¥–∞—Ç—å —É—Ä–æ–∫
  Body: { title, description, duration_minutes, module_id }
```

---

## ‚úÖ –ö–ê–ö –†–ê–ë–û–¢–ê–ï–¢:

### **–î–ª—è –∞–¥–º–∏–Ω–∞ (saint@onaiacademy.kz):**

1. **–û—Ç–∫—Ä—ã—Ç—å** `http://localhost:8080/course/1`
2. **–£–≤–∏–¥–µ—Ç—å** –∫–Ω–æ–ø–∫—É "–î–æ–±–∞–≤–∏—Ç—å –º–æ–¥—É–ª—å"
3. **–ù–∞–∂–∞—Ç—å** ‚Üí –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥
4. **–ó–∞–ø–æ–ª–Ω–∏—Ç—å:**
   - –ù–∞–∑–≤–∞–Ω–∏–µ: "–ù–æ–≤—ã–π –º–æ–¥—É–ª—å"
   - –û–ø–∏—Å–∞–Ω–∏–µ: "–û–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥—É–ª—è"
5. **–ù–∞–∂–∞—Ç—å "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"**
6. **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
   ```
   POST /api/modules
   Body: {
     title: "–ù–æ–≤—ã–π –º–æ–¥—É–ª—å",
     description: "–û–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥—É–ª—è",
     course_id: 1
   }
   
   Response 201:
   {
     id: 11,
     title: "–ù–æ–≤—ã–π –º–æ–¥—É–ª—å",
     description: "–û–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥—É–ª—è",
     course_id: 1,
     order_index: 11,
     created_at: "2025-11-16..."
   }
   ```
7. **Alert:** "‚úÖ –ú–æ–¥—É–ª—å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!"
8. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –°–ø–∏—Å–æ–∫ –º–æ–¥—É–ª–µ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `loadModulesFromAPI()`

---

### **–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è —É—Ä–æ–∫–æ–≤:**

1. **–û—Ç–∫—Ä—ã—Ç—å** `http://localhost:8080/course/1/module/2`
2. **–£–≤–∏–¥–µ—Ç—å** –∫–Ω–æ–ø–∫—É "–î–æ–±–∞–≤–∏—Ç—å —É—Ä–æ–∫"
3. **–ù–∞–∂–∞—Ç—å** ‚Üí –¥–∏–∞–ª–æ–≥
4. **–ó–∞–ø–æ–ª–Ω–∏—Ç—å:**
   - –ù–∞–∑–≤–∞–Ω–∏–µ: "–ù–æ–≤—ã–π —É—Ä–æ–∫"
   - –û–ø–∏—Å–∞–Ω–∏–µ: "–û–ø–∏—Å–∞–Ω–∏–µ —É—Ä–æ–∫–∞"
   - –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 15 –º–∏–Ω—É—Ç
5. **–ù–∞–∂–∞—Ç—å "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"**
6. **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
   ```
   POST /api/lessons
   Body: {
     title: "–ù–æ–≤—ã–π —É—Ä–æ–∫",
     description: "–û–ø–∏—Å–∞–Ω–∏–µ —É—Ä–æ–∫–∞",
     duration_minutes: 15,
     module_id: 2
   }
   
   Response 201:
   {
     id: 6,
     title: "–ù–æ–≤—ã–π —É—Ä–æ–∫",
     description: "–û–ø–∏—Å–∞–Ω–∏–µ —É—Ä–æ–∫–∞",
     duration_minutes: 15,
     module_id: 2,
     order_index: 6,
     created_at: "2025-11-16..."
   }
   ```
7. **Alert:** "‚úÖ –£—Ä–æ–∫ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!"
8. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –°–ø–∏—Å–æ–∫ —É—Ä–æ–∫–æ–≤ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

---

## üéØ –§–£–ù–ö–¶–ò–û–ù–ê–õ:

### ‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥—É–ª–µ–π:**
- –ê–¥–º–∏–Ω –≤–∏–¥–∏—Ç –∫–Ω–æ–ø–∫—É "–î–æ–±–∞–≤–∏—Ç—å –º–æ–¥—É–ª—å"
- –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥
- –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ `POST /api/modules`
- –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Å–ø–∏—Å–æ–∫ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

### ‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ —É—Ä–æ–∫–æ–≤:**
- –ê–¥–º–∏–Ω –≤–∏–¥–∏—Ç –∫–Ω–æ–ø–∫—É "–î–æ–±–∞–≤–∏—Ç—å —É—Ä–æ–∫"
- –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥
- –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ `POST /api/lessons`
- –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Å–ø–∏—Å–æ–∫ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

### ‚úÖ **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**
- –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–µ—Å–ª–∏ –∞–¥–º–∏–Ω) –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –º–æ–¥—É–ª–∏/—É—Ä–æ–∫–∏ –∏–∑ API
- `useEffect` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç `loadModulesFromAPI()` / `loadLessonsFromAPI()`

### ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI:**
- –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥—É–ª—è/—É—Ä–æ–∫–∞ —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- –ù–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ

### ‚úÖ **Error handling:**
- –ï—Å–ª–∏ API –≤–µ—Ä–Ω–µ—Ç –æ—à–∏–±–∫—É ‚Üí `alert('‚ùå –û—à–∏–±–∫–∞: ...')`
- –õ–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª—å: `console.error('‚ùå –û—à–∏–±–∫–∞:', error)`

---

## üìù CONSOLE LOGS:

### –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥—É–ª–µ–π:
```
‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ –º–æ–¥—É–ª–µ–π: 10
```

### –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –º–æ–¥—É–ª—è:
```
üéØ –û—Ç–∫—Ä—ã—Ç–∏–µ –¥–∏–∞–ª–æ–≥–∞ —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥—É–ª—è...
üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥—É–ª—è: { title: "...", description: "..." }
‚úÖ –ú–æ–¥—É–ª—å —Å–æ–∑–¥–∞–Ω: { id: 11, title: "...", ... }
‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ –º–æ–¥—É–ª–µ–π: 11
```

### –ü—Ä–∏ –æ—à–∏–±–∫–µ:
```
‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –º–æ–¥—É–ª—è: Error: ...
```

---

## üîê –ü–†–û–í–ï–†–ö–ê –†–û–õ–ò:

```typescript
const { user, userRole } = useAuth();
const isAdmin = userRole === 'admin';

// –ö–Ω–æ–ø–∫–∏ –≤–∏–¥–Ω—ã –¢–û–õ–¨–ö–û –¥–ª—è –∞–¥–º–∏–Ω–∞
{isAdmin && (
  <Button onClick={handleAddModule}>
    –î–æ–±–∞–≤–∏—Ç—å –º–æ–¥—É–ª—å
  </Button>
)}
```

---

## ‚úÖ –°–¢–ê–¢–£–°:

| –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª | –°—Ç–∞—Ç—É—Å |
|-----------|--------|
| –ö–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å –º–æ–¥—É–ª—å" | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| –ö–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å —É—Ä–æ–∫" | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| –î–∏–∞–ª–æ–≥–∏ —Å–æ–∑–¥–∞–Ω–∏—è | ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç |
| API –∑–∞–ø—Ä–æ—Å—ã | ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω—ã |
| –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| Error handling | ‚úÖ –ï—Å—Ç—å |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |

---

## üöÄ –ì–û–¢–û–í–û –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ!

**URL:** `http://localhost:8080/course/1`  
**–ê–¥–º–∏–Ω:** saint@onaiacademy.kz  

**–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–≤–∞—Ç—å –º–æ–¥—É–ª–∏
- ‚úÖ –°–æ–∑–¥–∞–≤–∞—Ç—å —É—Ä–æ–∫–∏
- ‚úÖ –í–∏–¥–µ—Ç—å –∏—Ö –≤ —Å–ø–∏—Å–∫–µ
- ‚úÖ –í—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ —Ä–µ–∞–ª—å–Ω—ã–π Backend API

**–î–∏–∑–∞–π–Ω –Ω–µ –∏–∑–º–µ–Ω–µ–Ω!** ‚úÖ  
**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø–æ–¥–∫–ª—é—á–µ–Ω!** ‚úÖ

