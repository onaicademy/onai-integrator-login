# üèÜ –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –°–ò–°–¢–ï–ú–´ –î–û–°–¢–ò–ñ–ï–ù–ò–ô

## üìã –û–ü–ò–°–ê–ù–ò–ï –°–ò–°–¢–ï–ú–´

**–ß—Ç–æ —ç—Ç–æ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π (badges) –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ.

**–ó–∞—á–µ–º –Ω—É–∂–Ω–æ:** –ú–æ—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∫ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–º—É –æ–±—É—á–µ–Ω–∏—é, –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏–≥—Ä–æ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç (–≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è).

**–ö–∞–∫ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å:** –ö–∞–∂–¥–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –¥–∞–µ—Ç XP (–æ–ø—ã—Ç), –ø–æ–≤—ã—à–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –Ω–æ–≤—ã–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.

---

## üóÇÔ∏è –°–¢–†–£–ö–¢–£–†–ê –ë–ê–ó–´ –î–ê–ù–ù–´–•

### 1. `achievements` - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
**–ß—Ç–æ —ç—Ç–æ:** –ú–∞—Å—Ç–µ—Ä-—Ç–∞–±–ª–∏—Ü–∞ —Å–æ –≤—Å–µ–º–∏ –≤–æ–∑–º–æ–∂–Ω—ã–º–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã (69 —à—Ç—É–∫).  
**–ó–∞—á–µ–º:** –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è.  
**–í–ª–∏—è–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞–∫–∏–µ –Ω–∞–≥—Ä–∞–¥—ã –ø–æ–ª—É—á–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞ —Å–≤–æ–∏ –¥–µ–π—Å—Ç–≤–∏—è.

```sql
CREATE TABLE achievements (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  title TEXT NOT NULL,                    -- –ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
  description TEXT NOT NULL,              -- –û–ø–∏—Å–∞–Ω–∏–µ —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å
  icon TEXT NOT NULL,                     -- –≠–º–æ–¥–∑–∏ –∏–∫–æ–Ω–∫–∞
  rarity TEXT CHECK (rarity IN ('common', 'rare', 'epic', 'legendary')),
  xp_requirement INTEGER DEFAULT 0,       -- –°–∫–æ–ª—å–∫–æ XP –Ω—É–∂–Ω–æ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è
  created_at TIMESTAMPTZ DEFAULT NOW()
);

COMMENT ON TABLE achievements IS '–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã. –≠—Ç–æ —à–∞–±–ª–æ–Ω—ã –Ω–∞–≥—Ä–∞–¥, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å.';
COMMENT ON COLUMN achievements.rarity IS '–†–µ–¥–∫–æ—Å—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—É—á–∞–µ–º–æ–≥–æ XP –∏ –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ.';
```

### 2. `user_achievements` - –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º
**–ß—Ç–æ —ç—Ç–æ:** –¢–∞–±–ª–∏—Ü–∞ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º–∏ —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.  
**–ó–∞—á–µ–º:** –•—Ä–∞–Ω–∏—Ç—å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∂–¥–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ –ø–æ –∫–∞–∂–¥–æ–º—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—é.  
**–í–ª–∏—è–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∫–æ–ª—å–∫–æ –æ—Å—Ç–∞–ª–æ—Å—å –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞–≥—Ä–∞–¥—ã –∏ –∫–æ–≥–¥–∞ –æ–Ω–∞ –±—ã–ª–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞.

```sql
CREATE TABLE user_achievements (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
  achievement_id TEXT NOT NULL,           -- ID –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ (achievements-config.ts)
  current_value INTEGER DEFAULT 0,        -- –¢–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä 5 —É—Ä–æ–∫–æ–≤ –∏–∑ 10)
  required_value INTEGER NOT NULL,        -- –¢—Ä–µ–±—É–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
  is_completed BOOLEAN DEFAULT FALSE,     -- –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ?
  started_at TIMESTAMPTZ DEFAULT NOW(),   -- –ö–æ–≥–¥–∞ –Ω–∞—á–∞–ª–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å
  completed_at TIMESTAMPTZ,               -- –ö–æ–≥–¥–∞ –∑–∞–≤–µ—Ä—à–∏–ª–∏
  unlocked_at TIMESTAMPTZ,                -- –ö–æ–≥–¥–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏ (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–∑–∂–µ completed_at)
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW(),
  
  UNIQUE(user_id, achievement_id)         -- –û–¥–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –æ–¥–∏–Ω —Ä–∞–∑
);

CREATE INDEX idx_user_achievements_user_id ON user_achievements(user_id);
CREATE INDEX idx_user_achievements_completed ON user_achievements(user_id, is_completed);

COMMENT ON TABLE user_achievements IS '–ü—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ç—Ä–∏–≥–≥–µ—Ä—ã –ø—Ä–∏ –¥–µ–π—Å—Ç–≤–∏—è—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.';
COMMENT ON COLUMN user_achievements.current_value IS '–¢–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å. –ù–∞–ø—Ä–∏–º–µ—Ä: —É—Ä–æ–∫–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–æ, –¥–Ω–µ–π streak, –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ XP.';
COMMENT ON COLUMN user_achievements.is_completed IS 'TRUE –∫–æ–≥–¥–∞ current_value >= required_value. –¢—Ä–∏–≥–≥–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —ç—Ç–æ –ø–æ–ª–µ.';
```

### 3. `achievement_history` - –ò—Å—Ç–æ—Ä–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
**–ß—Ç–æ —ç—Ç–æ:** –ñ—É—Ä–Ω–∞–ª –≤—Å–µ—Ö –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π —Å –¥–∞—Ç–∞–º–∏ –∏ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–º XP.  
**–ó–∞—á–µ–º:** –î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è timeline –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –ø–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º.  
**–í–ª–∏—è–Ω–∏–µ:** –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∏–≥—Ä–æ–≤—É—é –º–µ—Ö–∞–Ω–∏–∫—É, —Ç–æ–ª—å–∫–æ –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –∏—Å—Ç–æ—Ä–∏—é.

```sql
CREATE TABLE achievement_history (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
  achievement_id TEXT NOT NULL,
  xp_earned INTEGER NOT NULL,             -- –°–∫–æ–ª—å–∫–æ XP –ø–æ–ª—É—á–∏–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
  notification_seen BOOLEAN DEFAULT FALSE, -- –ü–æ–∫–∞–∑–∞–ª–∏ –ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ?
  unlocked_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_achievement_history_user ON achievement_history(user_id, unlocked_at DESC);

COMMENT ON TABLE achievement_history IS '–•—Ä–æ–Ω–æ–ª–æ–≥–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.';
COMMENT ON COLUMN achievement_history.notification_seen IS 'FALSE –ø–æ–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —É–≤–∏–¥–µ–ª popup —Å –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ–º.';
```

### 4. `user_stats` - –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
**–ß—Ç–æ —ç—Ç–æ:** –°—á–µ—Ç—á–∏–∫–∏ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ (—É—Ä–æ–∫–∏, —Å–æ–æ–±—â–µ–Ω–∏—è, streak).  
**–ó–∞—á–µ–º:** –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ –º–µ—Ç—Ä–∏–∫–∞–º –±–µ–∑ —Å–ª–æ–∂–Ω—ã—Ö JOIN –∑–∞–ø—Ä–æ—Å–æ–≤.  
**–í–ª–∏—è–Ω–∏–µ:** –≠—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è —Ç—Ä–∏–≥–≥–µ—Ä—è—Ç –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –∏ –ø–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è.

```sql
CREATE TABLE user_stats (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID UNIQUE REFERENCES users(id) ON DELETE CASCADE,
  
  -- –û–±—É—á–µ–Ω–∏–µ
  lessons_completed INTEGER DEFAULT 0,          -- –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —É—Ä–æ–∫–æ–≤
  modules_completed INTEGER DEFAULT 0,          -- –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –º–æ–¥—É–ª–µ–π
  courses_completed INTEGER DEFAULT 0,          -- –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –∫—É—Ä—Å–æ–≤
  total_study_time_minutes INTEGER DEFAULT 0,   -- –û–±—â–µ–µ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è
  
  -- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
  current_streak INTEGER DEFAULT 0,             -- –¢–µ–∫—É—â–∞—è —Å–µ—Ä–∏—è –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥
  longest_streak INTEGER DEFAULT 0,             -- –†–µ–∫–æ—Ä–¥ —Å–µ—Ä–∏–∏ –¥–Ω–µ–π
  last_activity_at TIMESTAMPTZ,                 -- –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
  
  -- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å
  achievements_unlocked INTEGER DEFAULT 0,      -- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
  messages_sent_to_ai INTEGER DEFAULT 0,        -- –°–æ–æ–±—â–µ–Ω–∏–π AI –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫—É
  
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_user_stats_user_id ON user_stats(user_id);

COMMENT ON TABLE user_stats IS '–ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ç—Ä–∏–≥–≥–µ—Ä—ã –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Å–æ–±—ã—Ç–∏–∏ (–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —É—Ä–æ–∫–∞, –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ —Ç.–¥.).';
COMMENT ON COLUMN user_stats.current_streak IS '–î–Ω–µ–π –ø–æ–¥—Ä—è–¥ —Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é. –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ 0 –µ—Å–ª–∏ –ø—Ä–æ–ø—É—â–µ–Ω –¥–µ–Ω—å.';
COMMENT ON COLUMN user_stats.achievements_unlocked IS '–°—á–µ—Ç—á–∏–∫ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.';
```

### 5. `profiles` - –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å XP –∏ —É—Ä–æ–≤–Ω–µ–º
**–ß—Ç–æ —ç—Ç–æ:** –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è —Å —Å–∏—Å—Ç–µ–º–æ–π —É—Ä–æ–≤–Ω–µ–π –∏ –æ–ø—ã—Ç–∞.  
**–ó–∞—á–µ–º:** –•—Ä–∞–Ω–∏—Ç—å –∏–≥—Ä–æ–≤—É—é –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (level, XP, streak).  
**–í–ª–∏—è–Ω–∏–µ:** –£—Ä–æ–≤–µ–Ω—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏—è–º, XP –º–æ—Ç–∏–≤–∏—Ä—É–µ—Ç –∫ –æ–±—É—á–µ–Ω–∏—é.

```sql
-- –£–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –¥–æ–±–∞–≤–ª—è–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
COMMENT ON TABLE profiles IS '–û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –°–æ–¥–µ—Ä–∂–∏—Ç –∏–≥—Ä–æ–≤—É—é –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—é (level, XP) –∏ –ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å auth.users.';
COMMENT ON COLUMN profiles.xp IS '–û—á–∫–∏ –æ–ø—ã—Ç–∞. –ù–∞—á–∏—Å–ª—è—é—Ç—Å—è –∑–∞: –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —É—Ä–æ–∫–æ–≤ (+50), –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π (+10-200), –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏—Å—Å–∏–π (+50-100).';
COMMENT ON COLUMN profiles.level IS '–£—Ä–æ–≤–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ: level = floor(sqrt(xp / 100)). –ö–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.';
COMMENT ON COLUMN profiles.current_streak IS '–°–µ—Ä–∏—è –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥ —Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é. –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å —á–µ—Ä–µ–∑ CRON job.';
```

### 6. `student_progress` - –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —É—Ä–æ–∫–∞–º
**–ß—Ç–æ —ç—Ç–æ:** –ü—Ä–æ–≥—Ä–µ—Å—Å –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–∫–∞ (–ø—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤–∏–¥–µ–æ, —Å—Ç–∞—Ç—É—Å).  
**–ó–∞—á–µ–º:** –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è –∏ —á—Ç–æ —É–∂–µ –∑–∞–≤–µ—Ä—à–∏–ª.  
**–í–ª–∏—è–Ω–∏–µ:** –ü—Ä–∏ is_completed=true –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è XP –∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Å—á–µ—Ç—á–∏–∫–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π.

```sql
COMMENT ON TABLE student_progress IS '–î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –∫–∞–∂–¥–æ–º—É —É—Ä–æ–∫—É. –ö–æ–≥–¥–∞ is_completed –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ TRUE, —Ç—Ä–∏–≥–≥–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–∏—Å–ª—è–µ—Ç XP –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç user_stats.lessons_completed.';
COMMENT ON COLUMN student_progress.is_completed IS 'TRUE –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≤–µ—Ä—à–∏–ª —É—Ä–æ–∫ (–¥–æ—Å–º–æ—Ç—Ä–µ–ª –≤–∏–¥–µ–æ >80% –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–∏–ª –∑–∞–¥–∞–Ω–∏–µ). –¢—Ä–∏–≥–≥–µ—Ä –Ω–∞—á–∏—Å–ª–∏—Ç XP.';
COMMENT ON COLUMN student_progress.xp_earned IS '–°–∫–æ–ª—å–∫–æ XP –ø–æ–ª—É—á–µ–Ω–æ –∑–∞ —ç—Ç–æ—Ç —É—Ä–æ–∫. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 50 XP –∑–∞ —É—Ä–æ–∫.';
```

---

## ‚öôÔ∏è –ú–ï–•–ê–ù–ò–ó–ú –†–ê–ë–û–¢–´ –°–ò–°–¢–ï–ú–´

### –ö–∞–∫ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π?

#### 1. **–ß–µ—Ä–µ–∑ DATABASE TRIGGERS (PostgreSQL)**
**–ì–¥–µ:** Supabase PostgreSQL —Ç—Ä–∏–≥–≥–µ—Ä—ã  
**–ö–æ–≥–¥–∞:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ INSERT/UPDATE –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö

```sql
-- –ü—Ä–∏–º–µ—Ä: –¢—Ä–∏–≥–≥–µ—Ä –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —É—Ä–æ–∫–∞
CREATE OR REPLACE FUNCTION update_achievements_on_lesson_complete()
RETURNS TRIGGER AS $$
BEGIN
  -- –ï—Å–ª–∏ —É—Ä–æ–∫ —Ç–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–≤–µ—Ä—à–µ–Ω
  IF NEW.is_completed = TRUE AND (OLD.is_completed IS NULL OR OLD.is_completed = FALSE) THEN
    
    -- 1. –ù–∞—á–∏—Å–ª–∏—Ç—å XP
    UPDATE profiles 
    SET xp = xp + 50 
    WHERE id = NEW.user_id;
    
    -- 2. –û–±–Ω–æ–≤–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ —É—Ä–æ–∫–æ–≤
    UPDATE user_stats 
    SET 
      lessons_completed = lessons_completed + 1,
      updated_at = NOW()
    WHERE user_id = NEW.user_id;
    
    -- 3. –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π "X —É—Ä–æ–∫–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–æ"
    UPDATE user_achievements
    SET 
      current_value = current_value + 1,
      is_completed = CASE WHEN current_value + 1 >= required_value THEN TRUE ELSE FALSE END,
      completed_at = CASE WHEN current_value + 1 >= required_value THEN NOW() ELSE NULL END,
      updated_at = NOW()
    WHERE user_id = NEW.user_id 
      AND achievement_id IN ('first_step', 'student_5', 'expert_20', 'master_50');
    
  END IF;
  
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER trigger_lesson_complete
  AFTER UPDATE ON student_progress
  FOR EACH ROW
  EXECUTE FUNCTION update_achievements_on_lesson_complete();
```

#### 2. **–ß–µ—Ä–µ–∑ BACKEND API (Node.js)**
**–ì–¥–µ:** `backend/src/services/achievementsService.ts`  
**–ö–æ–≥–¥–∞:** –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è AI)

```typescript
// –ü—Ä–∏–º–µ—Ä: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
export async function trackAIMessage(userId: string) {
  // 1. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
  await supabase
    .from('user_stats')
    .update({ 
      messages_sent_to_ai: supabase.raw('messages_sent_to_ai + 1') 
    })
    .eq('user_id', userId);
  
  // 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è "X —Å–æ–æ–±—â–µ–Ω–∏–π AI"
  await checkAndUnlockAchievements(userId, 'messages_sent');
}
```

#### 3. **–ß–µ—Ä–µ–∑ SCHEDULED JOBS (CRON)**
**–ì–¥–µ:** Supabase pg_cron –∏–ª–∏ backend scheduler  
**–ö–æ–≥–¥–∞:** –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 00:00 UTC

```sql
-- –ü—Ä–∏–º–µ—Ä: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ streak –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
CREATE OR REPLACE FUNCTION update_daily_streaks()
RETURNS void AS $$
BEGIN
  UPDATE profiles
  SET 
    current_streak = CASE 
      WHEN last_activity_at >= CURRENT_DATE - INTERVAL '1 day' THEN current_streak + 1
      ELSE 0
    END,
    longest_streak = GREATEST(longest_streak, current_streak + 1)
  WHERE last_activity_at >= CURRENT_DATE - INTERVAL '1 day';
END;
$$ LANGUAGE plpgsql;
```

---

## üìä –¢–ò–ü–´ –î–û–°–¢–ò–ñ–ï–ù–ò–ô –ò –ò–• –¢–†–ï–ë–û–í–ê–ù–ò–Ø

### 1. **–û–±—É—á–µ–Ω–∏–µ** (14 –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π)
- –ü–µ—Ä–≤—ã–π —É—Ä–æ–∫ –∑–∞–≤–µ—Ä—à–µ–Ω
- 5 —É—Ä–æ–∫–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–æ
- 10 —É—Ä–æ–∫–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–æ
- 20 —É—Ä–æ–∫–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–æ
- 50 —É—Ä–æ–∫–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–æ
- –ü–µ—Ä–≤—ã–π –º–æ–¥—É–ª—å –∑–∞–≤–µ—Ä—à–µ–Ω
- 3 –º–æ–¥—É–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ
- –ü–µ—Ä–≤—ã–π –∫—É—Ä—Å –∑–∞–≤–µ—Ä—à–µ–Ω
- 100% –∫—É—Ä—Å–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–æ
- –ü—Ä–æ—Å–º–æ—Ç—Ä 10 –≤–∏–¥–µ–æ
- –ü—Ä–æ—Å–º–æ—Ç—Ä 20 –≤–∏–¥–µ–æ
- 10 —á–∞—Å–æ–≤ –æ–±—É—á–µ–Ω–∏—è
- 50 —á–∞—Å–æ–≤ –æ–±—É—á–µ–Ω–∏—è
- –°–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ 1.5x

### 2. **–ü–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–æ** (8 –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π)
- Streak 3 –¥–Ω—è
- Streak 7 –¥–Ω–µ–π
- Streak 14 –¥–Ω–µ–π
- Streak 30 –¥–Ω–µ–π
- Streak 100 –¥–Ω–µ–π
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å 5 –¥–Ω–µ–π –≤ –Ω–µ–¥–µ–ª—é
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏
- –†–∞–Ω–Ω—è—è –ø—Ç–∞—à–∫–∞ (–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–æ 9:00)

### 3. **–ú–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ** (8 –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π)
- –î–æ—Å—Ç–∏–≥ 5 —É—Ä–æ–≤–Ω—è
- –î–æ—Å—Ç–∏–≥ 10 —É—Ä–æ–≤–Ω—è
- –î–æ—Å—Ç–∏–≥ 25 —É—Ä–æ–≤–Ω—è
- –ó–∞—Ä–∞–±–æ—Ç–∞–ª 1000 XP
- –ó–∞—Ä–∞–±–æ—Ç–∞–ª 5000 XP
- –ó–∞—Ä–∞–±–æ—Ç–∞–ª 10000 XP
- 100% –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–æ–¥—É–ª—è
- –ò–¥–µ–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∑–∞ —Ç–µ—Å—Ç

### 4. **–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ** (8 –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π)
- –ü–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ AI
- 10 —Å–æ–æ–±—â–µ–Ω–∏–π AI
- 50 —Å–æ–æ–±—â–µ–Ω–∏–π AI
- –ü–æ–¥–µ–ª–∏–ª—Å—è 1 —É—Ä–æ–∫–æ–º
- –ü–æ–¥–µ–ª–∏–ª—Å—è 10 —É—Ä–æ–∫–∞–º–∏
- –ü—Ä–∏–≥–ª–∞—Å–∏–ª 1 –¥—Ä—É–≥–∞
- –ü—Ä–∏–≥–ª–∞—Å–∏–ª 5 –¥—Ä—É–∑–µ–π
- –ù–∞–ø–∏—Å–∞–ª –æ—Ç–∑—ã–≤

### 5. **–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ** (31 –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ)
- –ó–∞–≤–µ—Ä—à–∏–ª —É—Ä–æ–∫ –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ
- –ó–∞–≤–µ—Ä—à–∏–ª –º–æ–¥—É–ª—å –∑–∞ –≤—ã—Ö–æ–¥–Ω—ã–µ
- –ù–æ—á–Ω–æ–π —Å–æ–≤–µ–Ω–æ–∫ (–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ—Å–ª–µ 23:00)
- –ü–µ—Ä—Ñ–µ–∫—Ü–∏–æ–Ω–∏—Å—Ç (–≤—Å–µ –∑–∞–¥–∞–Ω–∏—è –Ω–∞ 100%)
- –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å (–∏–∑—É—á–∏–ª –¥–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã)
- –°–∫–æ—Ä–æ—Å—Ç–Ω–æ–π –±–µ–≥—É–Ω (—É—Ä–æ–∫ –∑–∞ 10 –º–∏–Ω)
- –ú–∞—Ä–∞—Ñ–æ–Ω–µ—Ü (5 —É—Ä–æ–∫–æ–≤ –∑–∞ –¥–µ–Ω—å)
- –ò –¥—Ä—É–≥–∏–µ...

---

## üîÑ –ñ–ò–ó–ù–ï–ù–ù–´–ô –¶–ò–ö–õ –î–û–°–¢–ò–ñ–ï–ù–ò–Ø

```
1. –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
   ‚îú‚îÄ –ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ–∑–¥–∞—é—Ç—Å—è –∑–∞–ø–∏—Å–∏ –≤ user_achievements
   ‚îú‚îÄ current_value = 0, is_completed = FALSE
   ‚îî‚îÄ –í—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –≤ —Å—Ç–∞—Ç—É—Å–µ "–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ"

2. –û–¢–°–õ–ï–ñ–ò–í–ê–ù–ò–ï –ü–†–û–ì–†–ï–°–°–ê
   ‚îú‚îÄ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–ø–æ–ª–Ω—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ (–∑–∞–≤–µ—Ä—à–∞–µ—Ç —É—Ä–æ–∫)
   ‚îú‚îÄ –¢—Ä–∏–≥–≥–µ—Ä –æ–±–Ω–æ–≤–ª—è–µ—Ç user_stats.lessons_completed++
   ‚îú‚îÄ –¢—Ä–∏–≥–≥–µ—Ä –æ–±–Ω–æ–≤–ª—è–µ—Ç user_achievements.current_value++
   ‚îî‚îÄ –ï—Å–ª–∏ current_value >= required_value ‚Üí is_completed = TRUE

3. –†–ê–ó–ë–õ–û–ö–ò–†–û–í–ö–ê
   ‚îú‚îÄ –¢—Ä–∏–≥–≥–µ—Ä –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–ø–∏—Å—å –≤ achievement_history
   ‚îú‚îÄ –ù–∞—á–∏—Å–ª—è–µ—Ç XP –Ω–∞ profiles.xp
   ‚îú‚îÄ –û–±–Ω–æ–≤–ª—è–µ—Ç user_stats.achievements_unlocked++
   ‚îî‚îÄ Frontend –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç popup —Å –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ–º

4. –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï
   ‚îú‚îÄ –°—Ç—Ä–∞–Ω–∏—Ü–∞ /achievements –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç user_achievements
   ‚îú‚îÄ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å (5/10 —É—Ä–æ–∫–æ–≤)
   ‚îú‚îÄ –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ–¥—Å–≤–µ—á–µ–Ω—ã
   ‚îî‚îÄ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞–Ω—ã —Å–µ—Ä—ã–º–∏ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º
```

---

## üõ†Ô∏è –ü–õ–ê–ù –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö ‚úÖ
- [x] –¢–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã (achievements, user_achievements, achievement_history, user_stats)
- [x] –ò–Ω–¥–µ–∫—Å—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫–æ –≤—Å–µ–º —Ç–∞–±–ª–∏—Ü–∞–º –∏ –∫–æ–ª–æ–Ω–∫–∞–º
- [ ] –°–æ–∑–¥–∞—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –≠—Ç–∞–ø 2: –ó–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç (–ñ–î–ï–ú)
- [ ] –ó–∞–ª–∏—Ç—å –≤—Å–µ —É—Ä–æ–∫–∏ –≤ lessons
- [ ] –ó–∞–ª–∏—Ç—å –≤—Å–µ –º–æ–¥—É–ª–∏ –≤ modules  
- [ ] –ó–∞–ª–∏—Ç—å –≤—Å–µ –∫—É—Ä—Å—ã –≤ courses
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å XP –∑–∞ –∫–∞–∂–¥—ã–π —É—Ä–æ–∫

### –≠—Ç–∞–ø 3: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π (–ü–û–°–õ–ï –ö–û–ù–¢–ï–ù–¢–ê)
- [ ] –°–æ–∑–¥–∞—Ç—å –≤—Å–µ 69 –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –≤ achievements
- [ ] –ü—Ä–∏–≤—è–∑–∞—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∫ —Ä–µ–∞–ª—å–Ω—ã–º —É—Ä–æ–∫–∞–º/–º–æ–¥—É–ª—è–º
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è XP
- [ ] –°–æ–∑–¥–∞—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

### –≠—Ç–∞–ø 4: API –∏ Frontend
- [ ] –°–æ–∑–¥–∞—Ç—å `GET /api/achievements/:userId`
- [ ] –°–æ–∑–¥–∞—Ç—å `POST /api/achievements/unlock`
- [ ] –£–±—Ä–∞—Ç—å MOCK –¥–∞–Ω–Ω—ã–µ –∏–∑ Achievements.tsx
- [ ] –î–æ–±–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è—Ö

### –≠—Ç–∞–ø 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ü—Ä–æ–π—Ç–∏ 1 —É—Ä–æ–∫ ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ XP
- [ ] –ü—Ä–æ–π—Ç–∏ 5 —É—Ä–æ–∫–æ–≤ ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫—É "–£—á–µ–Ω–∏–∫"
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å streak –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

---

## üìù SQL –°–ö–†–ò–ü–¢–´ –î–õ–Ø –ü–û–î–ì–û–¢–û–í–ö–ò

### 1. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Ç–∞–±–ª–∏—Ü–∞–º

```sql
-- –í—ã–ø–æ–ª–Ω–∏—Ç—å –ü–û–°–õ–ï –∑–∞–ª–∏–≤–∞ –≤—Å–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
COMMENT ON TABLE achievements IS '–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã (badges). –≠—Ç–æ —à–∞–±–ª–æ–Ω—ã –Ω–∞–≥—Ä–∞–¥.';
COMMENT ON TABLE user_achievements IS '–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º. –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ç—Ä–∏–≥–≥–µ—Ä—ã.';
COMMENT ON TABLE achievement_history IS '–ò—Å—Ç–æ—Ä–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π. –î–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.';
COMMENT ON TABLE user_stats IS '–ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.';
COMMENT ON TABLE profiles IS '–û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª—å —Å –∏–≥—Ä–æ–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–µ–π (level, XP, streak).';
COMMENT ON TABLE student_progress IS '–î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —É—Ä–æ–∫–∞–º. –ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è XP.';
COMMENT ON TABLE lessons IS '–£—Ä–æ–∫–∏ –∫—É—Ä—Å–æ–≤. –ü—Ä–∏ is_archived=FALSE —É—Ä–æ–∫ –¥–æ—Å—Ç—É–ø–µ–Ω —Å—Ç—É–¥–µ–Ω—Ç–∞–º.';
COMMENT ON TABLE modules IS '–ú–æ–¥—É–ª–∏ –∫—É—Ä—Å–æ–≤. –ì—Ä—É–ø–ø–∏—Ä—É—é—Ç —É—Ä–æ–∫–∏ –ø–æ —Ç–µ–º–∞–º.';
COMMENT ON TABLE courses IS '–ö—É—Ä—Å—ã –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã. is_published=TRUE –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.';
COMMENT ON TABLE goals IS 'Kanban –∑–∞–¥–∞—á–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –° Telegram –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è–º–∏.';
COMMENT ON TABLE user_missions IS '–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –º–∏—Å—Å–∏–∏ –¥–ª—è –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏.';
```

### 2. –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è XP

```sql
CREATE OR REPLACE FUNCTION award_xp_for_lesson(p_user_id UUID, p_lesson_id INTEGER)
RETURNS void AS $$
DECLARE
  v_xp_amount INTEGER := 50; -- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 50 XP –∑–∞ —É—Ä–æ–∫
BEGIN
  -- –ù–∞—á–∏—Å–ª–∏—Ç—å XP –≤ –ø—Ä–æ—Ñ–∏–ª—å
  UPDATE profiles 
  SET 
    xp = xp + v_xp_amount,
    last_activity_at = NOW()
  WHERE id = p_user_id;
  
  -- –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
  UPDATE user_stats
  SET 
    lessons_completed = lessons_completed + 1,
    updated_at = NOW()
  WHERE user_id = p_user_id;
  
  -- –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π (–≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —É—Ä–æ–∫–∞–º–∏)
  UPDATE user_achievements
  SET 
    current_value = (SELECT lessons_completed FROM user_stats WHERE user_id = p_user_id),
    is_completed = current_value >= required_value,
    completed_at = CASE WHEN current_value >= required_value AND completed_at IS NULL THEN NOW() ELSE completed_at END,
    updated_at = NOW()
  WHERE user_id = p_user_id 
    AND achievement_id LIKE '%lesson%';
    
END;
$$ LANGUAGE plpgsql;

COMMENT ON FUNCTION award_xp_for_lesson IS '–ù–∞—á–∏—Å–ª—è–µ—Ç XP –∑–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —É—Ä–æ–∫–∞ –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è.';
```

---

## üìñ –î–õ–Ø –î–†–£–ì–ò–• –ê–°–°–ò–°–¢–ï–ù–¢–û–í

–ï—Å–ª–∏ —Ç—ã —á–∏—Ç–∞–µ—à—å —ç—Ç–æ, –∑–Ω–∞–π:

1. **–ù–ï –¢–†–û–ì–ê–ô** —Å–∏—Å—Ç–µ–º—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –ø–æ–∫–∞ –Ω–µ –∑–∞–ª–∏—Ç—ã –í–°–ï —É—Ä–æ–∫–∏
2. **–ò–°–ü–û–õ–¨–ó–£–ô** —Ñ—É–Ω–∫—Ü–∏—é `award_xp_for_lesson()` –¥–ª—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è XP
3. **–ù–ï –ú–ï–ù–Ø–ô** –ª–æ–≥–∏–∫—É –≤ `user_stats` –Ω–∞–ø—Ä—è–º—É—é - —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ —Ç—Ä–∏–≥–≥–µ—Ä—ã
4. **–ß–ò–¢–ê–ô** –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏:
   ```sql
   SELECT 
     col_description('achievements'::regclass, ordinal_position) 
   FROM information_schema.columns 
   WHERE table_name = 'achievements';
   ```

5. **–¢–ï–°–¢–ò–†–£–ô** –ª—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ

---

## üéØ –ò–¢–û–ì–û

**–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã:** –ë–∞–∑–∞ –≥–æ—Ç–æ–≤–∞, –ª–æ–≥–∏–∫–∞ —á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞, –∂–¥–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç  
**–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:** –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π, –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –Ω–∞ frontend  
**–ß—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ (–Ω–µ—Ç —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤), –Ω–µ—Ç API endpoint  
**–ö–æ–≥–¥–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–æ:** –ü–æ—Å–ª–µ –∑–∞–ª–∏–≤–∞ –≤—Å–µ—Ö —É—Ä–æ–∫–æ–≤ + 2-3 –¥–Ω—è –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫—É —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤

**–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ:** –°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å **–ü–û–õ–ù–û–°–¢–¨–Æ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò**. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≤–µ—Ä—à–∞–µ—Ç —É—Ä–æ–∫ ‚Üí —Å—Ä–∞–∑—É –ø–æ–ª—É—á–∞–µ—Ç XP –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º. –ù–∏–∫–∞–∫–æ–π —Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã!






