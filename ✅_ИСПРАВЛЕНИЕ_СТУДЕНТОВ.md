# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –°–¢–£–î–ï–ù–¢–´ –ù–ï –ó–ê–ì–†–£–ñ–ê–Æ–¢–°–Ø

**–î–∞—Ç–∞:** 2025-11-07  
**–°—Ç–∞—Ç—É—Å:** üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ ‚Üí üß™ –¢—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å SQL

---

## üö® –ü–†–û–ë–õ–ï–ú–ê:

```
‚ùå –°—Ç—É–¥–µ–Ω—Ç—ã –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ "–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —É—á–µ–Ω–∏–∫–æ–≤"
‚ùå –§–∏–ª—å—Ç—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∫–æ–ª–æ–Ω–∫—É is_ceo
‚ùå –ù–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ auth.users ‚Üí public.users
```

---

## ‚úÖ –ß–¢–û –ò–°–ü–†–ê–í–õ–ï–ù–û:

### **1. –ò–∑–º–µ–Ω—ë–Ω —Ñ–∏–ª—å—Ç—Ä –≤ `StudentsActivity.tsx`**

**–ë—ã–ª–æ (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û):**
```typescript
.neq('is_ceo', true)  // ‚ùå –ö–æ–ª–æ–Ω–∫–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
```

**–°—Ç–∞–ª–æ (–ü–†–ê–í–ò–õ–¨–ù–û):**
```typescript
.neq('email', 'saint@onaiacademy.kz')  // ‚úÖ –ò—Å–∫–ª—é—á–∞–µ–º –∞–¥–º–∏–Ω–∞ –ø–æ email
```

### **2. –°–æ–∑–¥–∞–Ω SQL –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏**

–§–∞–π–ª: **`üîß_–°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø_–°–¢–£–î–ï–ù–¢–û–í.sql`**

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
1. ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ—Ö –≤ `auth.users`
2. ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ—Ö –≤ `public.users`
3. ‚úÖ –°–æ–∑–¥–∞—ë—Ç —Ç—Ä–∏–≥–≥–µ—Ä –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
4. ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
5. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç

---

## üöÄ –ó–ê–ü–£–°–¢–ò –°–ï–ô–ß–ê–°:

### **–®–∞–≥ 1: –í—ã–ø–æ–ª–Ω–∏ SQL –≤ Supabase**

1. –û—Ç–∫—Ä–æ–π **Supabase SQL Editor**: https://supabase.com/dashboard/project/YOUR_PROJECT/sql
2. –°–∫–æ–ø–∏—Ä—É–π –≤–µ—Å—å –∫–æ–¥ –∏–∑ **`üîß_–°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø_–°–¢–£–î–ï–ù–¢–û–í.sql`**
3. –ù–∞–∂–º–∏ **RUN**

**–≠—Ç–æ—Ç SQL:**
- –°–æ–∑–¥–∞—Å—Ç —Ç—Ä–∏–≥–≥–µ—Ä (–Ω–æ–≤—ã–µ —Å—Ç—É–¥–µ–Ω—Ç—ã –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø–∞–¥–∞—Ç—å –≤ `public.users`)
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
- –ü–æ–∫–∞–∂–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### **–®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å**

1. –û—Ç–∫—Ä–æ–π https://onai.academy
2. –í–æ–π–¥–∏ –∫–∞–∫ `saint@onaiacademy.kz`
3. –ü–µ—Ä–µ–π–¥–∏ –≤ **–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å ‚Üí –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —É—á–µ–Ω–∏–∫–æ–≤**
4. **–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –≤—Å–µ —Å—Ç—É–¥–µ–Ω—Ç—ã!

---

## üìä –ß–¢–û –ò–ó–ú–ï–ù–ò–õ–û–°–¨:

### **Frontend (StudentsActivity.tsx):**
```diff
- .neq('is_ceo', true)
+ .neq('email', 'saint@onaiacademy.kz')
```

### **Backend (SQL Trigger):**
```sql
-- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ auth.users
-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤ public.users
CREATE TRIGGER on_auth_user_created
  AFTER INSERT OR UPDATE ON auth.users
  FOR EACH ROW
  EXECUTE FUNCTION public.handle_new_user();
```

---

## üß™ –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢:

### **–ü–æ—Å–ª–µ SQL:**
```
‚úÖ –¢—Ä–∏–≥–≥–µ—Ä —Å–æ–∑–¥–∞–Ω
‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ N —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
‚úÖ auth.users: N –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚úÖ public.users: N –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```

### **–í –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏:**
```
‚úÖ –°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω
‚úÖ –ü–æ–∫–∞–∑–∞–Ω—ã email, –∏–º—è, —Ä–æ–ª—å, XP, —É—Ä–æ–≤–µ–Ω—å
‚úÖ –ê–¥–º–∏–Ω (saint@onaiacademy.kz) –∏—Å–∫–ª—é—á—ë–Ω –∏–∑ —Å–ø–∏—Å–∫–∞
```

---

## üîÑ –ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–Ø:

**–¢–µ–ø–µ—Ä—å –∫–∞–∂–¥—ã–π –Ω–æ–≤—ã–π —Å—Ç—É–¥–µ–Ω—Ç:**
1. –°–æ–∑–¥–∞—ë—Ç—Å—è –≤ `auth.users` (Edge Function)
2. **–ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò** –ø–æ–ø–∞–¥–∞–µ—Ç –≤ `public.users` (Trigger)
3. **–ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

**–ù–µ –Ω—É–∂–Ω–æ:**
- ‚ùå –í—Ä—É—á–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å
- ‚ùå –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å —Å–µ—Ä–≤–µ—Ä
- ‚ùå –û–±–Ω–æ–≤–ª—è—Ç—å –∫–æ–¥

---

## üìã –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:

1. **–ó–∞–ø—É—Å—Ç–∏ SQL:** `üîß_–°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø_–°–¢–£–î–ï–ù–¢–û–í.sql`
2. **–ü—Ä–æ–≤–µ—Ä—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å:** –°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –¥–æ–ª–∂–µ–Ω –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è
3. **–°–æ–∑–¥–∞–π –Ω–æ–≤–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞:** –û–Ω –¥–æ–ª–∂–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–∏—Ç—å—Å—è

---

## üéØ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï:

### **–¢–µ—Å—Ç 1: –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—É–¥–µ–Ω—Ç–æ–≤**
1. –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å ‚Üí –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —É—á–µ–Ω–∏–∫–æ–≤
2. **–û–∂–∏–¥–∞–µ—Ç—Å—è:** ‚úÖ –°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω

### **–¢–µ—Å—Ç 2: –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—É–¥–µ–Ω—Ç–∞**
1. –ù–∞–∂–º–∏ **+ –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞**
2. –í–≤–µ–¥–∏ email, –∏–º—è
3. **–û–∂–∏–¥–∞–µ—Ç—Å—è:** ‚úÖ –°—Ç—É–¥–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω –∏ –ø–æ—è–≤–∏–ª—Å—è –≤ —Å–ø–∏—Å–∫–µ

### **–¢–µ—Å—Ç 3: –ê–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**
1. –°–æ–∑–¥–∞–π —Å—Ç—É–¥–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ Supabase Auth –Ω–∞–ø—Ä—è–º—É—é
2. –û–±–Ω–æ–≤–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
3. **–û–∂–∏–¥–∞–µ—Ç—Å—è:** ‚úÖ –°—Ç—É–¥–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–∏–ª—Å—è

---

## üéâ –ò–¢–û–ì:

**–ö–æ–¥:**
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Ñ–∏–ª—å—Ç—Ä —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
- ‚úÖ –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- ‚úÖ PM2 –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
- üîß SQL –≥–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É
- ‚è≥ –û–∂–∏–¥–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:**
‚û°Ô∏è **–ó–ê–ü–£–°–¢–ò `üîß_–°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø_–°–¢–£–î–ï–ù–¢–û–í.sql` –í SUPABASE!**

