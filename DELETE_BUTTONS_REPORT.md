# üóëÔ∏è –û—Ç—á—ë—Ç: –ö–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è –º–æ–¥—É–ª–µ–π –∏ —É—Ä–æ–∫–æ–≤

**–î–∞—Ç–∞:** 17 –Ω–æ—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é API  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –í—ã—Å–æ–∫–∏–π

---

## üìã –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. **–î–æ–±–∞–≤–ª–µ–Ω—ã –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è –º–æ–¥—É–ª–µ–π** ‚úÖ
- **–§–∞–π–ª:** `src/pages/Course.tsx`
- **–°—Ç—Ä–æ–∫–∏:** 202-225 (—Ñ—É–Ω–∫—Ü–∏—è), 579-609 (UI)
- **–î–∏–∑–∞–π–Ω:** –ö—Ä–∞—Å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ —Å –∏–∫–æ–Ω–∫–æ–π –∫–æ—Ä–∑–∏–Ω—ã, –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –º–æ–¥—É–ª—å
- **–í–∏–¥–∏–º–æ—Å—Ç—å:** –¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (`isAdmin === true`)

### 2. **–î–æ–±–∞–≤–ª–µ–Ω—ã –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è —É—Ä–æ–∫–æ–≤** ‚úÖ
- **–§–∞–π–ª:** `src/pages/Module.tsx`
- **–°—Ç—Ä–æ–∫–∏:** 147-169 (—Ñ—É–Ω–∫—Ü–∏—è), 568-598 (UI)
- **–î–∏–∑–∞–π–Ω:** –ö—Ä–∞—Å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ —Å –∏–∫–æ–Ω–∫–æ–π –∫–æ—Ä–∑–∏–Ω—ã —Ä—è–¥–æ–º —Å –∫–Ω–æ–ø–∫–æ–π "–ù–∞—á–∞—Ç—å"/"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å"
- **–í–∏–¥–∏–º–æ—Å—Ç—å:** –¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (`isAdmin === true`)

### 3. **–£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚úÖ
- –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ —Å —ç–º–æ–¥–∑–∏ üî• –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- –í—Å–µ —Å–æ–±—ã—Ç–∏—è –∫–Ω–æ–ø–æ–∫ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —É–¥–∞–ª—è–µ–º–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞

---

## üé® –î–∏–∑–∞–π–Ω –∫–Ω–æ–ø–æ–∫ —É–¥–∞–ª–µ–Ω–∏—è

### –í–∏–∑—É–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å:
```css
/* –¶–≤–µ—Ç */
bg-red-500/10          - —Ñ–æ–Ω (–∫—Ä–∞—Å–Ω—ã–π, –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å 10%)
text-red-400           - —Ç–µ–∫—Å—Ç/–∏–∫–æ–Ω–∫–∞
hover:bg-red-500/20    - –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ —Ñ–æ–Ω —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —è—Ä—á–µ
hover:text-red-300     - –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ —Ç–µ–∫—Å—Ç —Å–≤–µ—Ç–ª–µ–µ

/* –ì—Ä–∞–Ω–∏—Ü–∞ */
border border-red-500/30
hover:border-red-500/50

/* –ê–Ω–∏–º–∞—Ü–∏—è */
transition-all
hover:scale-110        - –∏–∫–æ–Ω–∫–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏

/* –ú–æ–¥—É–ª–∏ */
opacity-0              - —Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
group-hover:opacity-100 - –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –º–æ–¥—É–ª—å
```

### –ò–∫–æ–Ω–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã:
- SVG –∏–∫–æ–Ω–∫–∞ (lucide-react style)
- –†–∞–∑–º–µ—Ä: 16√ó16px (—É—Ä–æ–∫–∏), 18√ó18px (–º–æ–¥—É–ª–∏)
- –ê–Ω–∏–º–∞—Ü–∏—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ hover

---

## üìÇ –ù–∞–≤–∏–≥–∞—Ü–∏—è –∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫

### 1. –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ú–û–î–£–õ–Ø

**URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã:** `http://localhost:8080/course/:id`  
**–ü—Ä–∏–º–µ—Ä:** `http://localhost:8080/course/1`

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:**
- –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∫—É—Ä—Å–∞ "–ò–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä 2.0"
- –°–ø—Ä–∞–≤–∞ –≤–≤–µ—Ä—Ö—É –Ω–∞ –∫–∞–∂–¥–æ–π –∫–∞—Ä—Ç–æ—á–∫–µ –º–æ–¥—É–ª—è
- –ü–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –º—ã—à–∏ –Ω–∞ –º–æ–¥—É–ª—å

**–§–∞–π–ª:** `src/pages/Course.tsx`

**–ö–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∏ 202-225):**
```typescript
const handleDeleteModule = async (moduleId: number, moduleTitle: string) => {
  if (!confirm(`‚ùå –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –º–æ–¥—É–ª—å "${moduleTitle}"?\n\n–í—Å–µ —É—Ä–æ–∫–∏, –≤–∏–¥–µ–æ –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã. –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.`)) {
    return;
  }
  
  try {
    console.log('=======================================');
    console.log('üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ –º–æ–¥—É–ª—è:', moduleId);
    console.log('üóëÔ∏è –ù–∞–∑–≤–∞–Ω–∏–µ:', moduleTitle);
    console.log('=======================================');
    
    // TODO: –ó–¥–µ—Å—å –±—É–¥–µ—Ç API –∑–∞–ø—Ä–æ—Å –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –º–æ–¥—É–ª—è
    await api.delete(`/api/modules/${moduleId}`);
    
    alert(`‚úÖ –ú–æ–¥—É–ª—å "${moduleTitle}" —É–¥–∞–ª—ë–Ω!`);
    
    // –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –º–æ–¥—É–ª–µ–π
    await loadModulesFromAPI();
    
  } catch (error: any) {
    console.error('‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –º–æ–¥—É–ª—è:', error);
    alert(error.response?.data?.error || `‚ùå –û—à–∏–±–∫–∞: ${error?.message || '–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –º–æ–¥—É–ª—å'}`);
  }
};
```

**–ö–æ–¥ UI (—Å—Ç—Ä–æ–∫–∏ 579-609):**
```tsx
{/* Admin: Delete Button (Overlay) */}
{isAdmin && (
  <Button
    size="sm"
    variant="ghost"
    onClick={(e) => {
      e.stopPropagation();
      handleDeleteModule(module.id, module.title);
    }}
    className="absolute top-4 right-4 z-[102] bg-red-500/10 text-red-400 hover:bg-red-500/20 hover:text-red-300 border border-red-500/30 hover:border-red-500/50 rounded-xl px-3 py-2 transition-all opacity-0 group-hover:opacity-100"
    title="–£–¥–∞–ª–∏—Ç—å –º–æ–¥—É–ª—å"
  >
    <svg ...>
      {/* Trash icon */}
    </svg>
  </Button>
)}
```

---

### 2. –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –£–†–û–ö–ê

**URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã:** `http://localhost:8080/course/:id/module/:moduleId`  
**–ü—Ä–∏–º–µ—Ä:** `http://localhost:8080/course/1/module/2`

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:**
- –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –º–æ–¥—É–ª—è "–°–æ–∑–¥–∞–Ω–∏–µ GPT-–±–æ—Ç–∞ –∏ CRM"
- –°–ø—Ä–∞–≤–∞ –æ—Ç –∫–Ω–æ–ø–∫–∏ "–ù–∞—á–∞—Ç—å"/"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å" –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–∫–µ
- –í–∏–¥–Ω–∞ –≤—Å–µ–≥–¥–∞ (–Ω–µ —Å–∫—Ä—ã—Ç–∞)

**–§–∞–π–ª:** `src/pages/Module.tsx`

**–ö–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∏ 147-169):**
```typescript
const handleDeleteLesson = async (lessonId: number, lessonTitle: string) => {
  if (!confirm(`‚ùå –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —É—Ä–æ–∫ "${lessonTitle}"?\n\n–í—Å–µ –≤–∏–¥–µ–æ –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã. –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.`)) {
    return;
  }

  try {
    console.log('=======================================');
    console.log('üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ —É—Ä–æ–∫–∞:', lessonId);
    console.log('üóëÔ∏è –ù–∞–∑–≤–∞–Ω–∏–µ:', lessonTitle);
    console.log('=======================================');
    
    // TODO: –ó–¥–µ—Å—å –±—É–¥–µ—Ç API –∑–∞–ø—Ä–æ—Å –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —É—Ä–æ–∫–∞
    await api.delete(`/api/lessons/${lessonId}`);
    
    alert(`‚úÖ –£—Ä–æ–∫ "${lessonTitle}" —É–¥–∞–ª—ë–Ω!`);
    
    // –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ —É—Ä–æ–∫–æ–≤
    await loadLessonsFromAPI();
  } catch (error: any) {
    console.error('‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —É—Ä–æ–∫–∞:', error);
    alert(error.response?.data?.error || `‚ùå –û—à–∏–±–∫–∞: ${error?.message || '–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —É—Ä–æ–∫'}`);
  }
};
```

**–ö–æ–¥ UI (—Å—Ç—Ä–æ–∫–∏ 568-598):**
```tsx
{/* Admin: Delete Button */}
{isAdmin && (
  <Button
    size="sm"
    variant="ghost"
    onClick={(e) => {
      e.stopPropagation();
      handleDeleteLesson(lesson.id, lesson.title);
    }}
    className="relative z-[102] bg-red-500/10 text-red-400 hover:bg-red-500/20 hover:text-red-300 border border-red-500/30 hover:border-red-500/50 rounded-xl px-3 py-2 transition-all group"
    title="–£–¥–∞–ª–∏—Ç—å —É—Ä–æ–∫"
  >
    <svg ...>
      {/* Trash icon */}
    </svg>
  </Button>
)}
```

---

## üîå API Endpoints –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### 1. –£–¥–∞–ª–µ–Ω–∏–µ –º–æ–¥—É–ª—è

**Endpoint:** `DELETE /api/modules/:moduleId`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `moduleId` (number) - ID –º–æ–¥—É–ª—è

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
```http
Authorization: Bearer {token}
Content-Type: application/json
```

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–ú–æ–¥—É–ª—å —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª—ë–Ω"
}
```

**–û—à–∏–±–∫–∏:**
- `400` - –ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- `401` - –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- `403` - –ù–µ—Ç –ø—Ä–∞–≤ (–Ω–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
- `404` - –ú–æ–¥—É–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω
- `500` - –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:**
- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –º–æ–¥—É–ª—è –¥–æ–ª–∂–Ω—ã –ö–ê–°–ö–ê–î–ù–û —É–¥–∞–ª—è—Ç—å—Å—è:
  - –í—Å–µ —É—Ä–æ–∫–∏ –º–æ–¥—É–ª—è
  - –í—Å–µ –≤–∏–¥–µ–æ —É—Ä–æ–∫–æ–≤
  - –í—Å–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã —É—Ä–æ–∫–æ–≤
  - –í–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø–æ –º–æ–¥—É–ª—é

**SQL (–¥–ª—è —Å–ø—Ä–∞–≤–∫–∏):**
```sql
-- –í–∫–ª—é—á–∏—Ç—å –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –≤ –º–∏–≥—Ä–∞—Ü–∏–∏
ALTER TABLE lessons
ADD CONSTRAINT fk_module
FOREIGN KEY (module_id) REFERENCES modules(id)
ON DELETE CASCADE;
```

---

### 2. –£–¥–∞–ª–µ–Ω–∏–µ —É—Ä–æ–∫–∞

**Endpoint:** `DELETE /api/lessons/:lessonId`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `lessonId` (number) - ID —É—Ä–æ–∫–∞

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
```http
Authorization: Bearer {token}
Content-Type: application/json
```

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–£—Ä–æ–∫ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª—ë–Ω"
}
```

**–û—à–∏–±–∫–∏:**
- `400` - –ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- `401` - –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- `403` - –ù–µ—Ç –ø—Ä–∞–≤ (–Ω–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
- `404` - –£—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω
- `500` - –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:**
- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —É—Ä–æ–∫–∞ –¥–æ–ª–∂–Ω—ã –ö–ê–°–ö–ê–î–ù–û —É–¥–∞–ª—è—Ç—å—Å—è:
  - –í–∏–¥–µ–æ —É—Ä–æ–∫–∞
  - –í—Å–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã —É—Ä–æ–∫–∞
  - –í–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø–æ —É—Ä–æ–∫—É
  - –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤–∏–¥–µ–æ

**SQL (–¥–ª—è —Å–ø—Ä–∞–≤–∫–∏):**
```sql
-- –í–∫–ª—é—á–∏—Ç—å –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –≤ –º–∏–≥—Ä–∞—Ü–∏–∏
ALTER TABLE videos
ADD CONSTRAINT fk_lesson
FOREIGN KEY (lesson_id) REFERENCES lessons(id)
ON DELETE CASCADE;

ALTER TABLE lesson_materials
ADD CONSTRAINT fk_lesson
FOREIGN KEY (lesson_id) REFERENCES lessons(id)
ON DELETE CASCADE;
```

---

## üîê –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

### Frontend (React)

–ö–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è –≤–∏–¥–Ω—ã –¢–û–õ–¨–ö–û –µ—Å–ª–∏:
```typescript
const { userRole } = useAuth();
const isAdmin = userRole === 'admin';

// –í JSX:
{isAdmin && (
  <Button onClick={handleDelete}>–£–¥–∞–ª–∏—Ç—å</Button>
)}
```

### Backend (Node.js + Express)

**Middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:**
```javascript
// middleware/adminGuard.js
export const adminGuard = async (req, res, next) => {
  try {
    const user = req.user; // –ò–∑ JWT —Ç–æ–∫–µ–Ω–∞
    
    if (!user) {
      return res.status(401).json({ error: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' });
    }
    
    if (user.role !== 'admin') {
      return res.status(403).json({ error: '–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω. –¢—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.' });
    }
    
    next();
  } catch (error) {
    return res.status(500).json({ error: '–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤' });
  }
};
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ —Ä–æ—É—Ç–∞—Ö:**
```javascript
// routes/modules.js
import { adminGuard } from '../middleware/adminGuard.js';

router.delete('/api/modules/:moduleId', adminGuard, async (req, res) => {
  const { moduleId } = req.params;
  
  try {
    // –£–¥–∞–ª–∏—Ç—å –º–æ–¥—É–ª—å
    await db.query('DELETE FROM modules WHERE id = $1', [moduleId]);
    
    res.json({ success: true, message: '–ú–æ–¥—É–ª—å —É–¥–∞–ª—ë–Ω' });
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –º–æ–¥—É–ª—è:', error);
    res.status(500).json({ error: '–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –º–æ–¥—É–ª—å' });
  }
});

router.delete('/api/lessons/:lessonId', adminGuard, async (req, res) => {
  const { lessonId } = req.params;
  
  try {
    // –£–¥–∞–ª–∏—Ç—å —É—Ä–æ–∫
    await db.query('DELETE FROM lessons WHERE id = $1', [lessonId]);
    
    res.json({ success: true, message: '–£—Ä–æ–∫ —É–¥–∞–ª—ë–Ω' });
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —É—Ä–æ–∫–∞:', error);
    res.status(500).json({ error: '–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —É—Ä–æ–∫' });
  }
});
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

#### –£–¥–∞–ª–µ–Ω–∏–µ –º–æ–¥—É–ª—è:
- [ ] –ö–Ω–æ–ø–∫–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- [ ] –ö–Ω–æ–ø–∫–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –º–æ–¥—É–ª—å
- [ ] –ü—Ä–∏ –∫–ª–∏–∫–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è confirm —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –º–æ–¥—É–ª—è
- [ ] –ü—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è DELETE –∑–∞–ø—Ä–æ—Å
- [ ] –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è —Å–ø–∏—Å–æ–∫ –º–æ–¥—É–ª–µ–π –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- [ ] –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è alert —Å —Ç–µ–∫—Å—Ç–æ–º –æ—à–∏–±–∫–∏
- [ ] –í –∫–æ–Ω—Å–æ–ª–∏ –µ—Å—Ç—å –ª–æ–≥–∏ —Å —ç–º–æ–¥–∑–∏ üóëÔ∏è

#### –£–¥–∞–ª–µ–Ω–∏–µ —É—Ä–æ–∫–∞:
- [ ] –ö–Ω–æ–ø–∫–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- [ ] –ö–Ω–æ–ø–∫–∞ –≤–∏–¥–Ω–∞ —Ä—è–¥–æ–º —Å "–ù–∞—á–∞—Ç—å"/"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å"
- [ ] –ü—Ä–∏ –∫–ª–∏–∫–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è confirm —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —É—Ä–æ–∫–∞
- [ ] –ü—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è DELETE –∑–∞–ø—Ä–æ—Å
- [ ] –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è —Å–ø–∏—Å–æ–∫ —É—Ä–æ–∫–æ–≤ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- [ ] –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è alert —Å —Ç–µ–∫—Å—Ç–æ–º –æ—à–∏–±–∫–∏
- [ ] –í –∫–æ–Ω—Å–æ–ª–∏ –µ—Å—Ç—å –ª–æ–≥–∏ —Å —ç–º–æ–¥–∑–∏ üóëÔ∏è

#### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- [ ] –ö–Ω–æ–ø–∫–∏ –ù–ï –≤–∏–¥–Ω—ã –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [ ] Backend –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- [ ] –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å —á–µ—Ä–µ–∑ API –±–µ–∑ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

---

## üìä –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ "–£–¥–∞–ª–∏—Ç—å –º–æ–¥—É–ª—å":
```
=======================================
üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ –º–æ–¥—É–ª—è: 2
üóëÔ∏è –ù–∞–∑–≤–∞–Ω–∏–µ: –°–æ–∑–¥–∞–Ω–∏–µ GPT-–±–æ—Ç–∞ –∏ CRM
=======================================
```

### –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ "–£–¥–∞–ª–∏—Ç—å —É—Ä–æ–∫":
```
=======================================
üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ —É—Ä–æ–∫–∞: 3
üóëÔ∏è –ù–∞–∑–≤–∞–Ω–∏–µ: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Telegram-–±–æ—Ç–∞
=======================================
```

### –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º —É–¥–∞–ª–µ–Ω–∏–∏:
```
‚úÖ –ú–æ–¥—É–ª—å "–°–æ–∑–¥–∞–Ω–∏–µ GPT-–±–æ—Ç–∞ –∏ CRM" —É–¥–∞–ª—ë–Ω!
```

### –ü—Ä–∏ –æ—à–∏–±–∫–µ:
```
‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –º–æ–¥—É–ª—è: Error: ...
```

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### Backend (Node.js + Express):

1. **–°–æ–∑–¥–∞—Ç—å —Ä–æ—É—Ç—ã:**
   ```bash
   # routes/modules.js
   DELETE /api/modules/:moduleId

   # routes/lessons.js
   DELETE /api/lessons/:lessonId
   ```

2. **–î–æ–±–∞–≤–∏—Ç—å middleware `adminGuard`:**
   ```javascript
   router.delete('/api/modules/:moduleId', adminGuard, deleteModule);
   router.delete('/api/lessons/:lessonId', adminGuard, deleteLesson);
   ```

3. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ:**
   ```sql
   -- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –º–æ–¥—É–ª—è —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —É—Ä–æ–∫–∏
   DELETE FROM modules WHERE id = $1 CASCADE;
   
   -- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —É—Ä–æ–∫–∞ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –≤–∏–¥–µ–æ –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
   DELETE FROM lessons WHERE id = $1 CASCADE;
   ```

4. **–î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   ```javascript
   console.log('Admin', user.email, 'deleted module', moduleId);
   ```

5. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   ```bash
   # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Postman –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å curl
   curl -X DELETE http://localhost:3000/api/modules/2 \
     -H "Authorization: Bearer YOUR_TOKEN"
   ```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (Supabase):

1. **–û–±–Ω–æ–≤–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –∫–∞—Å–∫–∞–¥–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è:**
   ```sql
   -- supabase/migrations/YYYYMMDD_add_cascade_delete.sql
   
   ALTER TABLE lessons
   DROP CONSTRAINT IF EXISTS fk_module,
   ADD CONSTRAINT fk_module
   FOREIGN KEY (module_id) REFERENCES modules(id)
   ON DELETE CASCADE;

   ALTER TABLE videos
   DROP CONSTRAINT IF EXISTS fk_lesson,
   ADD CONSTRAINT fk_lesson
   FOREIGN KEY (lesson_id) REFERENCES lessons(id)
   ON DELETE CASCADE;

   ALTER TABLE lesson_materials
   DROP CONSTRAINT IF EXISTS fk_lesson_materials,
   ADD CONSTRAINT fk_lesson_materials
   FOREIGN KEY (lesson_id) REFERENCES lessons(id)
   ON DELETE CASCADE;

   ALTER TABLE student_progress
   DROP CONSTRAINT IF EXISTS fk_progress_lesson,
   ADD CONSTRAINT fk_progress_lesson
   FOREIGN KEY (lesson_id) REFERENCES lessons(id)
   ON DELETE CASCADE;

   ALTER TABLE video_analytics
   DROP CONSTRAINT IF EXISTS fk_analytics_lesson,
   ADD CONSTRAINT fk_analytics_lesson
   FOREIGN KEY (lesson_id) REFERENCES lessons(id)
   ON DELETE CASCADE;
   ```

2. **–ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏:**
   ```bash
   supabase db push
   ```

3. **–û–±–Ω–æ–≤–∏—Ç—å RLS –ø–æ–ª–∏—Ç–∏–∫–∏:**
   ```sql
   -- –†–∞–∑—Ä–µ—à–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º —É–¥–∞–ª—è—Ç—å –º–æ–¥—É–ª–∏
   CREATE POLICY "Admin can delete modules"
   ON modules FOR DELETE
   USING (auth.jwt() ->> 'user_metadata' ->> 'role' = 'admin');

   -- –†–∞–∑—Ä–µ—à–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º —É–¥–∞–ª—è—Ç—å —É—Ä–æ–∫–∏
   CREATE POLICY "Admin can delete lessons"
   ON lessons FOR DELETE
   USING (auth.jwt() ->> 'user_metadata' ->> 'role' = 'admin');
   ```

---

## üìù –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞ –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞

### –ß—Ç–æ –Ω—É–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å:

**1. API Endpoint:** `DELETE /api/modules/:moduleId`  
   - **–§–∞–π–ª Frontend:** `src/pages/Course.tsx` (—Å—Ç—Ä–æ–∫–∞ 214)
   - **–§—É–Ω–∫—Ü–∏—è:** `handleDeleteModule`
   - **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤:** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä

**2. API Endpoint:** `DELETE /api/lessons/:lessonId`  
   - **–§–∞–π–ª Frontend:** `src/pages/Module.tsx` (—Å—Ç—Ä–æ–∫–∞ 159)
   - **–§—É–Ω–∫—Ü–∏—è:** `handleDeleteLesson`
   - **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤:** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä

### –í–∞–∂–Ω–æ:
- ‚úÖ UI –∫–Ω–æ–ø–∫–∏ —É–∂–µ –≥–æ—Ç–æ–≤—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ
- ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (confirm) –¥–æ–±–∞–≤–ª–µ–Ω—ã
- ‚è≥ –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å API endpoints –≤ –±—ç–∫–µ–Ω–¥–µ
- ‚è≥ –ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –≤ –ë–î
- ‚è≥ –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

### –õ–æ–≥–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
```
üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ –º–æ–¥—É–ª—è: <ID>
üóëÔ∏è –ù–∞–∑–≤–∞–Ω–∏–µ: <–ù–∞–∑–≤–∞–Ω–∏–µ>
```

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ Frontend –≥–æ—Ç–æ–≤, Backend —Ç—Ä–µ–±—É–µ—Ç—Å—è  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –í—ã—Å–æ–∫–∏–π  
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π:** Backend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫



