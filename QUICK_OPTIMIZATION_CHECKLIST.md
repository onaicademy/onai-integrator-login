# ‚ö° –ë–´–°–¢–†–´–ô –ß–ï–ö–õ–ò–°–¢ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ô

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∑–∞ 30 –º–∏–Ω—É—Ç** | **–†–∏—Å–∫: 10-15%** | **–£–ª—É—á—à–µ–Ω–∏–µ: 50-200%**

---

## üéØ –ß–¢–û –î–ï–õ–ê–¢–¨ (–ø–æ –ø–æ—Ä—è–¥–∫—É)

### 1Ô∏è‚É£ –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î (5 –º–∏–Ω—É—Ç)

```bash
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å SQL –∏–∑ —Ñ–∞–π–ª–∞ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤ Supabase Dashboard
# 1. supabase/migrations/20250115_add_performance_indexes.sql
# 2. supabase/migrations/20250115_create_integration_tokens.sql
```

‚úÖ **–ß—Ç–æ –¥–∞—Å—Ç:** –ó–∞–ø—Ä–æ—Å—ã –±—ã—Å—Ç—Ä–µ–µ –≤ 2-5 —Ä–∞–∑

---

### 2Ô∏è‚É£ –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω—ã AmoCRM –≤ –ë–î (2 –º–∏–Ω—É—Ç—ã)

```sql
-- –í Supabase SQL Editor –≤—ã–ø–æ–ª–Ω–∏—Ç—å:
INSERT INTO integration_tokens (service_name, access_token, refresh_token, expires_at)
VALUES (
  'amocrm',
  '–í–°–¢–ê–í–ò–¢–¨_–¢–ï–ö–£–©–ò–ô_ACCESS_TOKEN',
  '–í–°–¢–ê–í–ò–¢–¨_–¢–ï–ö–£–©–ò–ô_REFRESH_TOKEN',
  NOW() + INTERVAL '1 day'
);
```

‚úÖ **–ß—Ç–æ –¥–∞—Å—Ç:** AmoCRM –Ω–µ –ª–æ–º–∞–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–∞—Ö

---

### 3Ô∏è‚É£ –û–±–Ω–æ–≤–∏—Ç—å .env –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (2 –º–∏–Ω—É—Ç—ã)

```bash
ssh -i ~/.ssh/id_rsa root@207.154.231.30

# –î–æ–±–∞–≤–∏—Ç—å –≤ /var/www/onai-integrator-login-main/backend/.env:
echo "LOG_LEVEL=warn" >> .env

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–¥–ª—è –∞–ª–µ—Ä—Ç–æ–≤):
echo "TELEGRAM_BOT_TOKEN=your_token" >> .env
echo "ADMIN_TELEGRAM_CHAT_ID=your_chat_id" >> .env
```

‚úÖ **–ß—Ç–æ –¥–∞—Å—Ç:** –ß–∏—Å—Ç—ã–µ –ª–æ–≥–∏, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö

---

### 4Ô∏è‚É£ –°–æ–±—Ä–∞—Ç—å –∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å (10 –º–∏–Ω—É—Ç)

```bash
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
cd backend
npx tsc --skipLibCheck

# –î–µ–ø–ª–æ–π
rsync -avz -e "ssh -i ~/.ssh/id_rsa" \
  dist/ ecosystem.config.js \
  root@207.154.231.30:/var/www/onai-integrator-login-main/backend/

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
ssh -i ~/.ssh/id_rsa root@207.154.231.30 '
  cd /var/www/onai-integrator-login-main/backend &&
  pm2 delete onai-backend &&
  pm2 start ecosystem.config.js &&
  pm2 save
'
```

‚úÖ **–ß—Ç–æ –¥–∞—Å—Ç:** –í—Å–µ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã

---

### 5Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ (5 –º–∏–Ω—É—Ç)

```bash
# 1. –°—Ç–∞—Ç—É—Å
ssh -i ~/.ssh/id_rsa root@207.154.231.30 'pm2 status'
# –û–∂–∏–¥–∞–µ—Ç—Å—è: online

# 2. Health check
curl -s https://api.onai.academy/api/health/deep | jq '.status'
# –û–∂–∏–¥–∞–µ—Ç—Å—è: "healthy"

# 3. –¢–æ–∫–µ–Ω—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã
ssh -i ~/.ssh/id_rsa root@207.154.231.30 'pm2 logs onai-backend --lines 100 --nostream | grep "AmoCRM.*–¢–æ–∫–µ–Ω—ã"'
# –û–∂–∏–¥–∞–µ—Ç—Å—è: "‚úÖ [AmoCRM] –¢–æ–∫–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ –ë–î"

# 4. –õ–æ–≥–∏ —á–∏—â–µ
ssh -i ~/.ssh/id_rsa root@207.154.231.30 'pm2 logs onai-backend --lines 50 --nostream'
# –û–∂–∏–¥–∞–µ—Ç—Å—è: —Ç–æ–ª—å–∫–æ WARN –∏ ERROR (–Ω–µ—Ç DEBUG)
```

---

## ‚úÖ –ì–û–¢–û–í–û!

–ï—Å–ª–∏ –≤—Å–µ 4 –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ—à–ª–∏ - **–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!**

---

## üö® –ï–°–õ–ò –ß–¢–û-–¢–û –°–õ–û–ú–ê–õ–û–°–¨

### –ë—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–∞—Ç (3 –º–∏–Ω—É—Ç—ã)

```bash
# –û—Ç–∫–∞—Ç–∏—Ç—å –∫–æ–¥
git checkout HEAD~1 backend/src/services/amoCrmService.ts
cd backend && npx tsc --skipLibCheck

# –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é
rsync -avz -e "ssh -i ~/.ssh/id_rsa" \
  backend/dist/ \
  root@207.154.231.30:/var/www/onai-integrator-login-main/backend/dist/

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
ssh -i ~/.ssh/id_rsa root@207.154.231.30 'pm2 restart onai-backend'
```

**–í–ê–ñ–ù–û:** –ò–Ω–¥–µ–∫—Å—ã –ë–î –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å - –æ–Ω–∏ –Ω–µ –ø–æ–º–µ—à–∞—é—Ç!

---

## üìä –ß–¢–û –ü–û–õ–£–ß–ò–õ–ò

- ‚ö° **–°–∫–æ—Ä–æ—Å—Ç—å:** –ó–∞–ø—Ä–æ—Å—ã –±—ã—Å—Ç—Ä–µ–µ –≤ 2-5 —Ä–∞–∑
- üõ°Ô∏è **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** –ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ + —Ç–æ–∫–µ–Ω—ã –≤ –ë–î
- üìà **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –î–µ—Ç–∞–ª—å–Ω—ã–π health check
- üö® **–ê–ª–µ—Ä—Ç—ã:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã)
- üìù **–ß–∏—Å—Ç–æ—Ç–∞:** –õ–æ–≥–∏ –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ –≤ production

**–í—Ä–µ–º—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:** 30 –º–∏–Ω—É—Ç  
**–†–∏—Å–∫:** 10-15%  
**–£–ª—É—á—à–µ–Ω–∏–µ:** 50-200%

üöÄ **–í–ü–ï–†–Å–î!**
