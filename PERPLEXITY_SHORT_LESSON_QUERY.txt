I'm building a Learning Management System (LMS) with React 18, TypeScript, Node.js, Express, and PostgreSQL via Supabase. I need architectural best practices for implementing a 'Complete Lesson' flow.

CURRENT ISSUES:
- onClick handler on 'Complete Lesson' button doesn't fire (no console logs, no API call to backend)
- Need to remove 'Next Module' button entirely (bad UX)
- Unsure about transaction boundaries for automatic module unlock
- Concerns about PostgreSQL schema cache causing stale data

DESIRED FLOW:
1. Student watches video → custom hook tracks progress (80% rule)
2. At 80% watched → 'COMPLETE' button becomes enabled
3. Click 'COMPLETE' → save progress to DB (student_progress table)
4. Check: are ALL lessons in current module completed?
5. If YES → unlock next module + create achievement + show confetti
6. Redirect to main page → show Module Unlock Animation
7. Student can now access next module

TECH STACK:
- Frontend: React 18 + Vite, React Router v6, Framer Motion, custom video player (Plyr + HLS.js)
- Backend: Node.js 20 + Express
- Database: PostgreSQL 17 via Supabase (hosted), using Direct DB queries (pg.Pool) to bypass PostgREST cache
- Schema: tripwire_modules (id, is_locked), tripwire_lessons (id, module_id), student_progress (user_id, lesson_id, status, completed_at)

QUESTIONS:
1. Why would React onClick handler silently fail? (no errors, just doesn't execute)
2. What's the industry standard architecture for LMS lesson completion flow? (Udemy, Coursera patterns)
3. Should 'all lessons completed' check happen on frontend or backend?
4. Best practices for atomic module unlock using PostgreSQL transactions?
5. How to handle race conditions (double-click on complete button)?
6. Database schema optimization for fast 'module completion check' queries with 1000+ concurrent users?
7. How to properly handle post-action redirects in React Router v6 with animations?
8. Security: how to prevent users from bypassing completion requirements?

PLEASE PROVIDE:
- Step-by-step implementation guide with TypeScript code examples
- Common pitfalls and solutions
- Performance considerations
- Testing strategy
- Specific debugging steps for the onClick handler issue

CONSTRAINTS:
- Supabase hosted (no direct PostgreSQL config access)
- PostgREST schema cache requires workarounds
- React 18 Strict Mode enabled
- Must work for 1000+ students completing lessons simultaneously
