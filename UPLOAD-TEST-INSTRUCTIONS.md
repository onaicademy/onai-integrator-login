# üìπ –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –¢–ï–°–¢–û–í–û–ô –ó–ê–ì–†–£–ó–ö–ï –í–ò–î–ï–û

## ‚úÖ **–ß–¢–û –ò–°–ü–†–ê–í–õ–ï–ù–û:**

### 1. Math.ceil –≤ videos.ts (–±—ã–ª–æ Math.round)
```typescript
// ‚ùå –ë—ã–ª–æ:
const durationMinutes = Math.round(durationSeconds / 60);
// 10 —Å–µ–∫—É–Ω–¥ ‚Üí 0 –º–∏–Ω—É—Ç

// ‚úÖ –°—Ç–∞–ª–æ:
const durationMinutes = Math.ceil(durationSeconds / 60);
// 10 —Å–µ–∫—É–Ω–¥ ‚Üí 1 –º–∏–Ω—É—Ç–∞
```

### 2. –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ video_content
–¢–µ–ø–µ—Ä—å backend –≤—ã–≤–æ–¥–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –æ—à–∏–±–∫–∏:
```
‚ùå Video_content save ERROR: ...
‚ùå Error code: ...
‚ùå Error message: ...
üö® CRITICAL: Video uploaded to CDN but NOT saved to video_content table!
```

---

## üìã **–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï:**

### –®–∞–≥ 1: –û—á–∏—Å—Ç–∏ —Å—Ç–∞—Ä—ã–µ –ø–æ–ø—ã—Ç–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –Ω–∞—á–∞—Ç—å —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞:
1. –û—Ç–∫—Ä–æ–π Supabase Dashboard
2. SQL Editor
3. –í—ã–ø–æ–ª–Ω–∏: `clean-failed-uploads.sql`

### –®–∞–≥ 2: –ó–∞–≥—Ä—É–∑–∏ –û–î–ù–û —Ç–µ—Å—Ç–æ–≤–æ–µ –≤–∏–¥–µ–æ

1. –û—Ç–∫—Ä–æ–π: `http://localhost:8080/course/1/module/2`
2. –í—ã–±–µ—Ä–∏ —É—Ä–æ–∫ **"–¢–µ—Å—Ç 2"** (lesson_id = 40)
3. –ù–∞–∂–º–∏ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" ‚Üí –í–∫–ª–∞–¥–∫–∞ "–í–∏–¥–µ–æ"
4. –ó–∞–≥—Ä—É–∑–∏ –∫–æ—Ä–æ—Ç–∫–æ–µ –≤–∏–¥–µ–æ (10-20 —Å–µ–∫—É–Ω–¥)
5. –î–æ–∂–¥–∏—Å—å "‚úÖ –í–∏–¥–µ–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ"

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å backend –ª–æ–≥–∏

**–í –æ–∫–Ω–µ PowerShell "BACKEND WITH FULL FIX + LOGGING" –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**

```
üì• VIDEO UPLOAD - REQUEST RECEIVED
‚è±Ô∏è Duration from request: {
  duration_seconds: 10,
  duration_minutes: 1,
  calculation: 'Math.ceil(10 / 60) = 1'
}
‚úÖ Lesson updated
üíæ Step 2: Saving to video_content table...
‚úÖ Video_content saved: { ... }
‚úÖ Saved data: {
  lesson_id: 40,
  duration_seconds: 10,
  filename: '...'
}
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—à—å:**
```
‚ùå Video_content save ERROR: ...
üö® CRITICAL: Video uploaded to CDN but NOT saved to video_content table!
```

**‚Üí –°–†–ê–ó–£ –°–ö–û–ü–ò–†–£–ô –í–°–Å –°–û–û–ë–©–ï–ù–ò–ï –û–ë –û–®–ò–ë–ö–ï –ò –ü–†–ò–®–õ–ò –ú–ù–ï!**

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ SQL

–í—ã–ø–æ–ª–Ω–∏ –≤ Supabase:
```sql
SELECT 
  l.id,
  l.title,
  l.duration_minutes,
  vc.duration_seconds,
  vc.filename
FROM lessons l
LEFT JOIN video_content vc ON vc.lesson_id = l.id
WHERE l.id = 40;
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:**
- `duration_minutes`: `1` (–Ω–µ 0)
- `duration_seconds`: `10` (–∏–ª–∏ —Å–∫–æ–ª—å–∫–æ –±—ã–ª–æ)
- `filename`: –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ (–Ω–µ NULL)

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –º–æ–¥—É–ª—è

–û–±–Ω–æ–≤–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É (F5) –∏ –ø—Ä–æ–≤–µ—Ä—å:
```
–í—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –º–æ–¥—É–ª—è: 31 –º–∏–Ω—É—Ç–∞
```

**–î–æ–ª–∂–Ω–æ —Å—Ç–∞—Ç—å:**
```
–í—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –º–æ–¥—É–ª—è: 32 –º–∏–Ω—É—Ç—ã  ‚Üê +1 –º–∏–Ω—É—Ç–∞ –æ—Ç –Ω–æ–≤–æ–≥–æ –≤–∏–¥–µ–æ!
```

---

## üéØ **–ï–°–õ–ò –í–°–Å –†–ê–ë–û–¢–ê–ï–¢:**

–ó–∞–≥—Ä—É–∑–∏ –≤–∏–¥–µ–æ –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —É—Ä–æ–∫–æ–≤:
- –£—Ä–æ–∫ "–¢–µ—Å—Ç 3" (lesson_id = 41)

–ü–æ—Å–ª–µ –≤—Å–µ—Ö –∑–∞–≥—Ä—É–∑–æ–∫ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
30 (–¢–µ—Å—Ç 1) + 1 (–¢–µ—Å—Ç 2) + 1 (–¢–µ—Å—Ç 3) + 1 (sdasdsa) = 33 –º–∏–Ω—É—Ç—ã
```

---

## üö® **–ï–°–õ–ò –ù–ï –†–ê–ë–û–¢–ê–ï–¢:**

–°–∫–æ–ø–∏—Ä—É–π –∏ –ø—Ä–∏—à–ª–∏:
1. **–û—à–∏–±–∫—É –∏–∑ backend –ª–æ–≥–æ–≤** (–æ–∫–Ω–æ PowerShell)
2. **SQL —Ä–µ–∑—É–ª—å—Ç–∞—Ç** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ video_content

–Ø —Å—Ä–∞–∑—É –Ω–∞–π–¥—É –ø—Ä–æ–±–ª–µ–º—É!

---

**Backend –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω —Å –ø–æ–ª–Ω—ã–º fix'–æ–º. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≥—Ä—É–∑–∏—Ç—å –æ–¥–Ω–æ –≤–∏–¥–µ–æ!** üöÄ

