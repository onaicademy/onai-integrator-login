# üéØ –§–ò–ù–ê–õ–¨–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

**–î–∞—Ç–∞:** 11 –Ω–æ—è–±—Ä—è 2025

---

## ‚úÖ –ß–¢–û –°–î–ï–õ–ê–ù–û:

### 1. **–î–æ–±–∞–≤–ª–µ–Ω —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ä–æ–ª–∏ –≤ StudentsActivity.tsx**

**–§–∞–π–ª:** `src/pages/admin/StudentsActivity.tsx`

**–ë–´–õ–û:**
```typescript
const { data: profiles, error: profilesError } = await supabase
  .from("profiles")
  .select("*")
  .order("created_at", { ascending: false });
```

**–°–¢–ê–õ–û:**
```typescript
const { data: profiles, error: profilesError } = await supabase
  .from("profiles")
  .select("*")
  .eq("role", "student")  // ‚úÖ –§–∏–ª—å—Ç—Ä —Ç–æ–ª—å–∫–æ —Å—Ç—É–¥–µ–Ω—Ç—ã!
  .order("created_at", { ascending: false });
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –¢–µ–ø–µ—Ä—å –≤ —Å–ø–∏—Å–∫–µ –±—É–¥—É—Ç —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å `role = 'student'`
- ‚úÖ –ê–¥–º–∏–Ω—ã, –∫—É—Ä–∞—Ç–æ—Ä—ã –∏ —Ç–µ—Ö. –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ –ø–æ–ø–∞–¥—É—Ç –≤ —Å–ø–∏—Å–æ–∫
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö

---

### 2. **MainLayout —É–ø—Ä–æ—â—ë–Ω –¥–æ –º–∏–Ω–∏–º—É–º–∞ (—Ö–∞—Ä–¥–∫–æ–¥ admin)**

**–§–∞–π–ª:** `src/components/layouts/MainLayout.tsx`

```typescript
export function MainLayout({ children }: MainLayoutProps) {
  console.log('‚úÖ MainLayout: –†–µ–Ω–¥–µ—Ä–∏–º –ë–ï–ó –ü–†–û–í–ï–†–û–ö');
  
  // –•–ê–†–î–ö–û–î: –≤—Å–µ–≥–¥–∞ admin
  const userRole = "admin";

  return (
    <SidebarProvider>
      <div className="flex h-screen w-full bg-background">
        <AppSidebar role={userRole} />
        ...
      </div>
    </SidebarProvider>
  );
}
```

**–£–±—Ä–∞–Ω–æ:**
- ‚ùå –í—Å–µ useState
- ‚ùå –í—Å–µ useEffect
- ‚ùå –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ Supabase
- ‚ùå –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

---

### 3. **AdminGuard –æ—Ç–∫–ª—é—á–µ–Ω**

**–§–∞–π–ª:** `src/components/AdminGuard.tsx`

```typescript
export function AdminGuard({ children }: { children: React.ReactNode }) {
  console.log('‚úÖ AdminGuard: –û–¢–ö–õ–Æ–ß–ï–ù, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –≤—Å–µ—Ö');
  return <>{children}</>;
}
```

---

### 4. **–£–¥–∞–ª—ë–Ω –∫–∞—Å—Ç–æ–º–Ω—ã–π storageKey**

**–§–∞–π–ª:** `src/lib/supabase.ts`

**–ë–´–õ–û:**
```typescript
export const supabase = createClient(supabaseUrl, supabaseKey, {
  auth: {
    storageKey: 'supabase.auth.token',  // ‚ùå
    ...
  }
})
```

**–°–¢–ê–õ–û:**
```typescript
export const supabase = createClient(supabaseUrl, supabaseKey, {
  auth: {
    autoRefreshToken: true,
    persistSession: true,
    detectSessionInUrl: true,
    storage: window.localStorage
    // –ù–ï –£–ö–ê–ó–´–í–ê–ï–ú storageKey!
  }
})
```

---

## üéØ –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï:

1. ‚úÖ **MainLayout:** –•–∞—Ä–¥–∫–æ–¥ `role = "admin"`, –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–æ–∫
2. ‚úÖ **AdminGuard:** –û—Ç–∫–ª—é—á–µ–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ—Ö
3. ‚úÖ **StudentsActivity:** –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ `role = 'student'`
4. ‚úÖ **Supabase:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π storageKey

---

## üß™ –ö–ê–ö –¢–ï–°–¢–ò–†–û–í–ê–¢–¨:

### –®–ê–ì 1: –û—Ç–∫—Ä–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—É
```
http://localhost:8080/admin/students-activity
```

### –®–ê–ì 2: –û—Ç–∫—Ä–æ–π –∫–æ–Ω—Å–æ–ª—å (`F12`)

### –®–ê–ì 3: –û–±–Ω–æ–≤–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É (`Ctrl+R`)

### –®–ê–ì 4: –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```
‚úÖ AdminGuard: –û–¢–ö–õ–Æ–ß–ï–ù, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –≤—Å–µ—Ö
‚úÖ MainLayout: –†–µ–Ω–¥–µ—Ä–∏–º –ë–ï–ó –ü–†–û–í–ï–†–û–ö
üìã AppSidebar —Ä–æ–ª—å: admin
üì§ –ó–∞–ø—Ä–æ—Å profiles...
‚úÖ –ó–∞–ø—Ä–æ—Å –∑–∞–≤–µ—Ä—à—ë–Ω
‚úÖ –ü–æ–ª—É—á–µ–Ω–æ X –∑–∞–ø–∏—Å–µ–π –∏–∑ profiles
```

### –®–ê–ì 5: –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è

- ‚úÖ –°–∞–π–¥–±–∞—Ä —Å –∞–¥–º–∏–Ω-–º–µ–Ω—é (7 –ø—É–Ω–∫—Ç–æ–≤)
- ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏
- ‚úÖ –°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ (–µ—Å–ª–∏ –µ—Å—Ç—å –≤ –±–∞–∑–µ)
- ‚úÖ –ù–µ—Ç —á–µ—Ä–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞

---

## üîç –ï–°–õ–ò –°–ü–ò–°–û–ö –ü–£–°–¢–û–ô:

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç —á—Ç–æ –≤ —Ç–∞–±–ª–∏—Ü–µ `profiles` –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π —Å `role = 'student'`

**–ü—Ä–æ–≤–µ—Ä—å –≤ Supabase Dashboard:**
1. Table Editor ‚Üí `profiles`
2. –ü–æ—Å–º–æ—Ç—Ä–∏ –∫–∞–∫–∏–µ –∑–∞–ø–∏—Å–∏ –µ—Å—Ç—å
3. –ü—Ä–æ–≤–µ—Ä—å –ø–æ–ª–µ `role` —É –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏

**–ï—Å–ª–∏ —Ç–∞–º —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã:**
- –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞
- –ò–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –Ω–∞ `.eq("role", "admin")` –¥–ª—è —Ç–µ—Å—Ç–∞

---

## üìã –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:

1. **–ï—Å–ª–∏ —Å–ø–∏—Å–æ–∫ –ø–æ—è–≤–∏–ª—Å—è:** ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ —Ñ–∏–ª—å—Ç—Ä–µ!
2. **–ï—Å–ª–∏ —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç–æ–π:** –ü—Ä–æ–≤–µ—Ä—å –¥–∞–Ω–Ω—ã–µ –≤ Supabase
3. **–ï—Å–ª–∏ —á–µ—Ä–Ω—ã–π —ç–∫—Ä–∞–Ω:** –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ –∫–æ–Ω—Å–æ–ª–∏, –ø—Ä–∏—à–ª–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç

---

**–ö–æ–Ω–µ—Ü –æ—Ç—á—ë—Ç–∞**

