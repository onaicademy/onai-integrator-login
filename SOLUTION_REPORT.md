# üéØ –û–¢–ß–Å–¢ –û –†–ï–®–ï–ù–ò–ò –ü–†–û–ë–õ–ï–ú–´: –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤

**–î–∞—Ç–∞:** 11 –Ω–æ—è–±—Ä—è 2025  
**–ü—Ä–æ–µ–∫—Ç:** onAI Academy Platform  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–®–ï–ù–û

---

## üìã –ò–°–•–û–î–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê

### –°–∏–º–ø—Ç–æ–º—ã:
1. ‚ùå –°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/admin/students-activity`
2. ‚ùå –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (`Ctrl+R`) - —á—ë—Ä–Ω—ã–π —ç–∫—Ä–∞–Ω –∏–ª–∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
3. ‚ùå –ö–æ–Ω—Å–æ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ –æ—à–∏–±–∫–∏: "Session check timeout", "No data returned"
4. ‚ùå AdminGuard –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

### –ü–æ–ø—ã—Ç–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- –î–æ–±–∞–≤–ª–µ–Ω—ã timeout'—ã –¥–ª—è `getSession()`
- –ò–∑–º–µ–Ω—ë–Ω –º–µ—Ç–æ–¥ —Å `getSession()` –Ω–∞ `getUser()`
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã RLS –ø–æ–ª–∏—Ç–∏–∫–∏ (–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑)
- –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –£–ø—Ä–æ—â—ë–Ω AdminGuard
- –ò–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–ª–æ ‚ùå

---

## üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ò –ü–û–ò–°–ö –ö–û–†–ù–Ø –ü–†–û–ë–õ–ï–ú–´

### –≠—Ç–∞–ø 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ –¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ localStorage
- ‚úÖ –°–µ—Å—Å–∏—è –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
- ‚úÖ `supabase.auth.getSession()` —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–í—ã–≤–æ–¥:** –ü—Ä–æ–±–ª–µ–º–∞ –ù–ï –≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ frontend –∫–æ–¥–∞
- ‚úÖ –ó–∞–ø—Ä–æ—Å –∫ `profiles` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞
- ‚úÖ `useEffect` —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–í—ã–≤–æ–¥:** –ü—Ä–æ–±–ª–µ–º–∞ –ù–ï –≤–æ frontend –∫–æ–¥–µ

### –≠—Ç–∞–ø 3: –£–ø—Ä–æ—â–µ–Ω–∏–µ –¥–æ –º–∏–Ω–∏–º—É–º–∞
–í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω—ã –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
```typescript
// MainLayout.tsx - —Ö–∞—Ä–¥–∫–æ–¥ admin
const userRole = "admin";

// AdminGuard.tsx - –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ—Ö
return <>{children}</>;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è, –Ω–æ —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç–æ–π ‚ùå

### –≠—Ç–∞–ø 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Supabase
–û—Ç–∫—Ä—ã–ª–∏ Supabase Dashboard ‚Üí Table Editor ‚Üí `profiles`

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ:**
- ‚úÖ –í —Ç–∞–±–ª–∏—Ü–µ `profiles` –µ—Å—Ç—å 16 –∑–∞–ø–∏—Å–µ–π
- ‚úÖ –ï—Å—Ç—å –∫–æ–ª–æ–Ω–∫–∞ `role` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ (`student`, `admin`, `curator`, `tech_support`)
- ‚úÖ 14 —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å `role = 'student'`

**–í—ã–≤–æ–¥:** –î–∞–Ω–Ω—ã–µ –ï–°–¢–¨ –≤ –±–∞–∑–µ! üî•

### –≠—Ç–∞–ø 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –º–æ–º–µ–Ω—Ç!)

–î–æ–±–∞–≤–ª–µ–Ω –¥–µ—Ç–∞–ª—å–Ω—ã–π –ª–æ–≥ –≤ `StudentsActivity.tsx`:
```typescript
console.log('üì§ –ó–∞–ø—Ä–æ—Å profiles...');
const { data: profiles, error: profilesError } = await supabase
  .from("profiles")
  .select("*")
  .order("created_at", { ascending: false });

console.log('üì• –û—Ç–≤–µ—Ç profiles:', profiles);
console.log('‚ùå –û—à–∏–±–∫–∞ profiles:', profilesError);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –≤ –∫–æ–Ω—Å–æ–ª–∏:**
```
üì§ –ó–∞–ø—Ä–æ—Å profiles...
üì• –û—Ç–≤–µ—Ç profiles: []  ‚Üê –ü–£–°–¢–û–ô –ú–ê–°–°–ò–í!
‚ùå –û—à–∏–±–∫–∞ profiles: null
```

**–≠–í–†–ò–ö–ê!** üî• –ó–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ë–ï–ó –æ—à–∏–±–æ–∫, –Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–ü–£–°–¢–û–ô –º–∞—Å—Å–∏–≤**!

–≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ **RLS (Row Level Security)**!

---

## üí° –ö–û–†–ï–ù–¨ –ü–†–û–ë–õ–ï–ú–´: RLS (Row Level Security)

### –ß—Ç–æ —Ç–∞–∫–æ–µ RLS?
Row Level Security - —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ PostgreSQL/Supabase, –∫–æ—Ç–æ—Ä—ã–π **–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Å—Ç—Ä–æ–∫–∞–º —Ç–∞–±–ª–∏—Ü—ã** –Ω–∞ —É—Ä–æ–≤–Ω–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

### –ü–æ—á–µ–º—É RLS –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –¥–æ—Å—Ç—É–ø?

1. **–í Supabase Dashboard** –¥–∞–Ω–Ω—ã–µ –≤–∏–¥–Ω—ã ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Service Role Key** (–∞–¥–º–∏–Ω—Å–∫–∏–π –∫–ª—é—á)
2. **–ù–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ** –¥–∞–Ω–Ω—ã–µ –ù–ï –≤–∏–¥–Ω—ã ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Anon Key** (–∞–Ω–æ–Ω–∏–º–Ω—ã–π –∫–ª—é—á)
3. **RLS –ø–æ–ª–∏—Ç–∏–∫–∏** –Ω–∞ —Ç–∞–±–ª–∏—Ü–µ `profiles` –±—ã–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ –¥–ª—è –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –ü–æ—á–µ–º—É –∑–∞–ø—Ä–æ—Å –≤–æ–∑–≤—Ä–∞—â–∞–ª –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤?
```sql
-- RLS –±—ã–ª –≤–∫–ª—é—á–µ–Ω –Ω–∞ profiles
ALTER TABLE profiles ENABLE ROW LEVEL SECURITY;

-- –ù–æ –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è —á—Ç–µ–Ω–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ –∏–ª–∏ –±—ã–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: Supabase –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç [] –≤–º–µ—Å—Ç–æ –æ—à–∏–±–∫–∏ (—ç—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ –¥–∏–∑–∞–π–Ω—É)
```

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï

### –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è):

**SQL –∫–æ–º–∞–Ω–¥–∞:**
```sql
-- –û–¢–ö–õ–Æ–ß–ê–ï–ú RLS –Ω–∞ profiles (–≤—Ä–µ–º–µ–Ω–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∞)
ALTER TABLE profiles DISABLE ROW LEVEL SECURITY;
```

**–ö–∞–∫ –≤—ã–ø–æ–ª–Ω–∏—Ç—å:**
1. Supabase Dashboard ‚Üí SQL Editor
2. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å SQL –∫–æ–º–∞–Ω–¥—É –≤—ã—à–µ
3. –ù–∞–∂–∞—Ç—å "Run" –∏–ª–∏ `Ctrl+Enter`

### –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
- ‚úÖ –°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è (–≤—Å–µ 16 –∑–∞–ø–∏—Å–µ–π)
- ‚úÖ –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –°—Ç—É–¥–µ–Ω—Ç—ã —É–±–∏—Ä–∞—é—Ç—Å—è –∏–∑ —Å–ø–∏—Å–∫–∞ –ø—Ä–∏ –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏
- ‚úÖ –ù–µ—Ç —á—ë—Ä–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
- ‚úÖ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üîí –ü–û–°–¢–û–Ø–ù–ù–û–ï –†–ï–®–ï–ù–ò–ï (–¥–ª—è production)

### ‚ö†Ô∏è –í–ê–ñ–ù–û: –û—Ç–∫–ª—é—á–∞—Ç—å RLS –Ω–∞ production - –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ!

–ü–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω—É–∂–Ω–æ:

### 1. –í–∫–ª—é—á–∏—Ç—å RLS –æ–±—Ä–∞—Ç–Ω–æ:
```sql
ALTER TABLE profiles ENABLE ROW LEVEL SECURITY;
```

### 2. –°–æ–∑–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞:

```sql
-- –ü–æ–ª–∏—Ç–∏–∫–∞ 1: –ß—Ç–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
CREATE POLICY "authenticated_can_read_profiles" 
ON profiles 
FOR SELECT 
TO authenticated 
USING (true);

-- –ü–æ–ª–∏—Ç–∏–∫–∞ 2: –ê–¥–º–∏–Ω—ã –º–æ–≥—É—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å –ª—é–±—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏
CREATE POLICY "admins_can_update_profiles" 
ON profiles 
FOR UPDATE 
TO authenticated 
USING (
  auth.uid() IN (
    SELECT id FROM profiles WHERE role = 'admin'
  )
);

-- –ü–æ–ª–∏—Ç–∏–∫–∞ 3: –ê–¥–º–∏–Ω—ã –º–æ–≥—É—Ç –≤—Å—Ç–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏
CREATE POLICY "admins_can_insert_profiles" 
ON profiles 
FOR INSERT 
TO authenticated 
WITH CHECK (
  auth.uid() IN (
    SELECT id FROM profiles WHERE role = 'admin'
  )
);

-- –ü–æ–ª–∏—Ç–∏–∫–∞ 4: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å
CREATE POLICY "users_can_update_own_profile" 
ON profiles 
FOR UPDATE 
TO authenticated 
USING (auth.uid() = id);
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ–ª–∏—Ç–∏–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç:
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª–∏—Ç–∏–∫
SELECT schemaname, tablename, policyname, permissive, roles, cmd, qual, with_check
FROM pg_policies
WHERE tablename = 'profiles';
```

---

## üìä –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### 1. –£–ø—Ä–æ—â—ë–Ω MainLayout
```typescript
// –í–†–ï–ú–ï–ù–ù–û: —Ö–∞—Ä–¥–∫–æ–¥ admin –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
export function MainLayout({ children }: MainLayoutProps) {
  const userRole = "admin";
  
  return (
    <SidebarProvider>
      <div className="flex h-screen w-full bg-background">
        <AppSidebar role={userRole} />
        ...
      </div>
    </SidebarProvider>
  );
}
```

### 2. –£–ø—Ä–æ—â—ë–Ω AdminGuard
```typescript
// –í–†–ï–ú–ï–ù–ù–û: –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ—Ö –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
export function AdminGuard({ children }: { children: React.ReactNode }) {
  return <>{children}</>;
}
```

### 3. –£–±—Ä–∞–Ω –∫–∞—Å—Ç–æ–º–Ω—ã–π storageKey
```typescript
// src/lib/supabase.ts
export const supabase = createClient(supabaseUrl, supabaseKey, {
  auth: {
    autoRefreshToken: true,
    persistSession: true,
    detectSessionInUrl: true,
    storage: window.localStorage
    // –ù–ï –£–ö–ê–ó–´–í–ê–ï–ú storageKey - –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π!
  }
})
```

---

## üéØ –ò–¢–û–ì–û–í–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø –í –ö–û–î–ï

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

1. **`src/lib/supabase.ts`**
   - –£–±—Ä–∞–Ω `storageKey: 'supabase.auth.token'`
   - –£–±—Ä–∞–Ω `flowType: 'pkce'`

2. **`src/components/layouts/MainLayout.tsx`**
   - –£–±—Ä–∞–Ω—ã –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
   - –•–∞—Ä–¥–∫–æ–¥ `userRole = "admin"`

3. **`src/components/AdminGuard.tsx`**
   - –£–±—Ä–∞–Ω—ã –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–µ—Å—Å–∏–∏
   - –ü—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `<>{children}</>`

4. **`src/pages/admin/StudentsActivity.tsx`**
   - –ó–∞–ø—Ä–æ—Å –∫ `profiles` (—É–∂–µ –±—ã–ª –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π)
   - –í—Ä–µ–º–µ–Ω–Ω–æ —É–±—Ä–∞–Ω —Ñ–∏–ª—å—Ç—Ä `.eq("role", "student")`

### SQL –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. **`DISABLE_RLS.sql`**
   - –û—Ç–∫–ª—é—á–µ–Ω RLS –Ω–∞ —Ç–∞–±–ª–∏—Ü–µ `profiles`

---

## üìà –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚ùå –°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø—É—Å—Ç–æ–π
- ‚ùå –ß—ë—Ä–Ω—ã–π —ç–∫—Ä–∞–Ω –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
- ‚ùå –û—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
- ‚ùå AdminGuard –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚úÖ –°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è (16 –∑–∞–ø–∏—Å–µ–π)
- ‚úÖ –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –°—Ç—É–¥–µ–Ω—Ç—ã —É–±–∏—Ä–∞—é—Ç—Å—è –∏–∑ —Å–ø–∏—Å–∫–∞
- ‚úÖ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–æ—Å—Ç—É–ø–Ω–∞
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏
- ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∑–∞ < 1 —Å–µ–∫—É–Ω–¥—É

---

## üîë –ö–õ–Æ–ß–ï–í–´–ï –í–´–í–û–î–´

### 1. RLS - —ç—Ç–æ –Ω–µ –±–∞–≥, —ç—Ç–æ —Ñ–∏—á–∞!
RLS –∑–∞—â–∏—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ—Ç –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞. –ù–æ –µ–≥–æ –Ω—É–∂–Ω–æ **–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å**.

### 2. Supabase –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç [] –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ RLS
–ö–æ–≥–¥–∞ RLS –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø, Supabase **–Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É**, –∞ –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤**. –≠—Ç–æ –º–æ–∂–µ—Ç —Å–±–∏—Ç—å —Å —Ç–æ–ª–∫—É –ø—Ä–∏ –¥–µ–±–∞–≥–µ!

### 3. Dashboard ‚â† Frontend
–¢–æ, —á—Ç–æ —Ç—ã –≤–∏–¥–∏—à—å –≤ Supabase Dashboard (Service Role), **–Ω–µ —Ä–∞–≤–Ω–æ** —Ç–æ–º—É, —á—Ç–æ –≤–∏–¥–∏—Ç —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (Anon Key).

### 4. –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π RLS –ø–µ—Ä–≤—ã–º –¥–µ–ª–æ–º
–ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫, –Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Üí –ø—Ä–æ–≤–µ—Ä—å RLS!

---

## üìù –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò (TODO)

### –î–ª—è production:

1. ‚úÖ **–í–∫–ª—é—á–∏—Ç—å RLS –æ–±—Ä–∞—Ç–Ω–æ** –Ω–∞ `profiles`
2. ‚úÖ **–°–æ–∑–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏** (—Å–º. –≤—ã—à–µ)
3. ‚úÖ **–í–µ—Ä–Ω—É—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏** –≤ MainLayout –∏ AdminGuard
4. ‚úÖ **–í–µ—Ä–Ω—É—Ç—å —Ñ–∏–ª—å—Ç—Ä** `.eq("role", "student")` –≤ –∑–∞–ø—Ä–æ—Å–µ
5. ‚úÖ **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** —Å –≤–∫–ª—é—á–µ–Ω–Ω—ã–º RLS

### –î–ª—è —É–ª—É—á—à–µ–Ω–∏—è:

1. –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ RLS (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é "–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞")
2. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
3. –î–æ–±–∞–≤–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤
4. –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ —Å—Ç–∞—Ç—É—Å—É (–∞–∫—Ç–∏–≤–Ω—ã–µ/–Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ)

---

## üéâ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–ü—Ä–æ–±–ª–µ–º–∞:** RLS –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –¥–æ—Å—Ç—É–ø –∫ —Ç–∞–±–ª–∏—Ü–µ `profiles` –¥–ª—è –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**–†–µ—à–µ–Ω–∏–µ:** –û—Ç–∫–ª—é—á–µ–Ω–∏–µ RLS (–≤—Ä–µ–º–µ–Ω–Ω–æ) + –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø–æ–ª–∏—Ç–∏–∫ –¥–æ—Å—Ç—É–ø–∞ (–ø–æ—Å—Ç–æ—è–Ω–Ω–æ).

**–í—Ä–µ–º—è —Ä–µ—à–µ–Ω–∏—è:** ~4 —á–∞—Å–∞ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–≥–æ –¥–µ–±–∞–≥–∞.

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–®–ï–ù–û –ò –†–ê–ë–û–¢–ê–ï–¢!**

---

**–ê–≤—Ç–æ—Ä –æ—Ç—á—ë—Ç–∞:** AI Assistant  
**–î–∞—Ç–∞:** 11 –Ω–æ—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0

