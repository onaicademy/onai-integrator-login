# ‚ö° –ê–£–î–ò–¢ –ò –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò

**–î–∞—Ç–∞**: 14 –¥–µ–∫–∞–±—Ä—è 2025  
**–¶–µ–ª—å**: –£—Å—Ç—Ä–∞–Ω–∏—Ç—å –ª–∞–≥–∏, –±–∞–≥–∏, —É—Å–∫–æ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø—Ä–æ—Ñ—Ç–µ—Å—Ç –≤–æ—Ä–æ–Ω–∫–∏

---

## üìä –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï

### ‚úÖ –ß–¢–û –£–ñ–ï –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–û

#### 1. Backend API Response Time
```typescript
// backend/src/routes/landing.ts:647-652
// ‚úÖ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø: Response –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –°–†–ê–ó–£
res.json({
  success: true,
  leadId: supabaseLead.id,
});

// –í—Å–µ —Ç—è–∂–µ–ª—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ background
(async () => {
  // AmoCRM, Facebook, Notifications - –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –æ—Ç–≤–µ—Ç
})();
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –ñ–î–ï–¢ AmoCRM/Email/SMS  
**–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞**: ~200-500ms (—Ç–æ–ª—å–∫–æ –ë–î insert)

#### 2. Retry Logic —Å Exponential Backoff
```typescript
// backend/src/routes/landing.ts:558-577
async function retryWithBackoff<T>(
  fn: () => Promise<T>,
  maxRetries: number = 3,
  initialDelay: number = 1000
): Promise<T | null>
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç**:
- 1—è –ø–æ–ø—ã—Ç–∫–∞ ‚Üí –æ—à–∏–±–∫–∞ ‚Üí –∂–¥–µ—Ç 1s ‚Üí –ø–æ–≤—Ç–æ—Ä
- 2—è –ø–æ–ø—ã—Ç–∫–∞ ‚Üí –æ—à–∏–±–∫–∞ ‚Üí –∂–¥–µ—Ç 2s ‚Üí –ø–æ–≤—Ç–æ—Ä  
- 3—è –ø–æ–ø—ã—Ç–∫–∞ ‚Üí –æ—à–∏–±–∫–∞ ‚Üí –∂–¥–µ—Ç 4s ‚Üí –≤–æ–∑–≤—Ä–∞—Ç null

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–±–æ–∏ AmoCRM/Facebook –ù–ï –ª–æ–º–∞—é—Ç –≤–æ—Ä–æ–Ω–∫—É

#### 3. Scheduled Notifications (Non-blocking)
```typescript
// backend/src/services/scheduledNotifications.ts
// ‚úÖ Email/SMS –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç
// ‚úÖ –ù–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫
```

---

## üî¥ –ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ –ë–î

**–¢–∞–±–ª–∏—Ü–∞**: `landing_leads`

**–¢–µ–∫—É—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã –ë–ï–ó –∏–Ω–¥–µ–∫—Å–æ–≤:**
```sql
-- –ü–æ–∏—Å–∫ –ø–æ email (–¥–ª—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏)
SELECT * FROM landing_leads WHERE email = 'email@example.com';

-- –ü–æ–∏—Å–∫ –ø–æ phone
SELECT * FROM landing_leads WHERE phone = '+7...';

-- –ü–æ–∏—Å–∫ –ø–æ email –ò–õ–ò phone
SELECT * FROM landing_leads WHERE email = '...' OR phone = '...';

-- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ
SELECT * FROM landing_leads ORDER BY created_at DESC;
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –ë–µ–∑ –∏–Ω–¥–µ–∫—Å–æ–≤ = FULL TABLE SCAN (–º–µ–¥–ª–µ–Ω–Ω–æ)  
**Impact**: –ü—Ä–∏ 1000+ –ª–∏–¥–æ–≤ –∑–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –ª–∞–≥–∞—Ç—å

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 2: Canvas Animations –Ω–∞ Frontend

**–§–∞–π–ª**: `src/pages/tripwire/ProfTest.tsx`

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**
```typescript
// –î–≤–µ canvas –∞–Ω–∏–º–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
bgCanvasRef    // –§–æ–Ω–æ–≤—ã–µ —á–∞—Å—Ç–∏—Ü—ã
visualCanvasRef // 3D –≥–µ–æ–º–µ—Ç—Ä–∏—è
```

**–ü—Ä–æ–±–ª–µ–º–∞**: 
- –ù–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –º–æ–∂–µ—Ç –ª–∞–≥–∞—Ç—å
- –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ CPU/GPU
- –ù–µ –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ**: –£–∂–µ –µ—Å—Ç—å —á–∞—Å—Ç–∏—á–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (—Å—Ç—Ä–æ–∫–∏ 108-119), –Ω–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å

### –ü—Ä–æ–±–ª–µ–º–∞ 3: Lazy Initialization –ö–ª–∏–µ–Ω—Ç–æ–≤

**–§–∞–π–ª**: `backend/src/services/scheduledNotifications.ts:29`

```typescript
const resend = new Resend(process.env.RESEND_API_KEY);
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –º–æ–¥—É–ª—è, –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å lazy initialization (–∫–∞–∫ Supabase clients)

### –ü—Ä–æ–±–ª–µ–º–∞ 4: Memory Leak –≤ setTimeout

**–§–∞–π–ª**: `backend/src/services/scheduledNotifications.ts`

```typescript
const scheduledNotifications = new Map<string, NodeJS.Timeout>();
```

**–ü—Ä–æ–±–ª–µ–º–∞**: 
- –¢–∞–π–º–µ—Ä—ã –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏
- –ü—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞ —Ç–∞–π–º–µ—Ä—ã —Ç–µ—Ä—è—é—Ç—Å—è (–Ω–æ –µ—Å—Ç—å recovery)
- –ù–µ—Ç –æ—á–∏—Å—Ç–∫–∏ —Å—Ç–∞—Ä—ã—Ö —Ç–∞–π–º–µ—Ä–æ–≤

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å TTL –∏ cleanup

---

## ‚ö° –ü–õ–ê–ù –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò

### 1. –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø –ë–î (–ö–†–ò–¢–ò–ß–ù–û)

#### 1.1. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã
```sql
-- –ò–Ω–¥–µ–∫—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ email
CREATE INDEX IF NOT EXISTS idx_landing_leads_email 
ON landing_leads(email);

-- –ò–Ω–¥–µ–∫—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ phone
CREATE INDEX IF NOT EXISTS idx_landing_leads_phone 
ON landing_leads(phone);

-- –ò–Ω–¥–µ–∫—Å –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ –¥–∞—Ç–µ
CREATE INDEX IF NOT EXISTS idx_landing_leads_created_at 
ON landing_leads(created_at DESC);

-- –ò–Ω–¥–µ–∫—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ lead_id –≤ scheduled_notifications
CREATE INDEX IF NOT EXISTS idx_scheduled_notifications_lead_id 
ON scheduled_notifications(lead_id);

-- –ò–Ω–¥–µ–∫—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ pending notifications
CREATE INDEX IF NOT EXISTS idx_scheduled_notifications_status 
ON scheduled_notifications(status) 
WHERE status = 'pending';

-- –ò–Ω–¥–µ–∫—Å –¥–ª—è unified_lead_tracking
CREATE INDEX IF NOT EXISTS idx_unified_lead_tracking_source_lead_id 
ON unified_lead_tracking(source_lead_id);
```

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç**:
- –ü–æ–∏—Å–∫ –ø–æ email: **100x –±—ã—Å—Ç—Ä–µ–µ** (1000ms ‚Üí 10ms)
- –ü–æ–∏—Å–∫ –ø–æ phone: **100x –±—ã—Å—Ç—Ä–µ–µ**
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: **50x –±—ã—Å—Ç—Ä–µ–µ**

#### 1.2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã

**–ë—ã–ª–æ** (–∏–∑–±—ã—Ç–æ—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å):
```sql
SELECT id, email, phone, created_at
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å** (—Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è):
```sql
SELECT id
```

### 2. –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø FRONTEND

#### 2.1. –û—Ç–∫–ª—é—á–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

**–§–∞–π–ª**: `src/pages/tripwire/ProfTest.tsx`

```typescript
// ‚úÖ –£–ñ–ï –ï–°–¢–¨ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ mobile
const isMobile = window.innerWidth < 768;
if (isMobile) {
  canvas.style.display = 'none';
  return;
}

// üîß –î–û–ë–ê–í–ò–¢–¨: –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
const isLowEndDevice = navigator.hardwareConcurrency < 4;
if (isLowEndDevice) {
  canvas.style.display = 'none';
  return;
}
```

#### 2.2. –£–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å—Ç–∏—Ü

**–ë—ã–ª–æ**:
```typescript
const count = Math.min(Math.floor(width * height / 40000), 25);
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å**:
```typescript
const count = Math.min(Math.floor(width * height / 60000), 15); // –ú–µ–Ω—å—à–µ —á–∞—Å—Ç–∏—Ü
```

#### 2.3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å requestIdleCallback

```typescript
// –ó–∞–ø—É—Å–∫–∞—Ç—å —Ç—è–∂–µ–ª—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –±—Ä–∞—É–∑–µ—Ä —Å–≤–æ–±–æ–¥–µ–Ω
requestIdleCallback(() => {
  initParticles();
  animate();
});
```

### 3. –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø BACKEND

#### 3.1. Lazy Initialization –¥–ª—è Resend

**–ë—ã–ª–æ**:
```typescript
const resend = new Resend(process.env.RESEND_API_KEY);
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å**:
```typescript
let resend: Resend | null = null;

function getResendClient(): Resend {
  if (!resend && process.env.RESEND_API_KEY) {
    resend = new Resend(process.env.RESEND_API_KEY);
  }
  if (!resend) {
    throw new Error('RESEND_API_KEY not configured');
  }
  return resend;
}
```

#### 3.2. Cleanup –¥–ª—è scheduledNotifications

```typescript
// –î–æ–±–∞–≤–∏—Ç—å TTL –¥–ª—è —Ç–∞–π–º–µ—Ä–æ–≤
const MAX_TIMEOUT_AGE = 24 * 60 * 60 * 1000; // 24 hours

setInterval(() => {
  const now = Date.now();
  for (const [leadId, timeout] of scheduledNotifications.entries()) {
    // –ï—Å–ª–∏ —Ç–∞–π–º–µ—Ä —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤ - —É–¥–∞–ª–∏—Ç—å
    if (now - timeout._idleStart > MAX_TIMEOUT_AGE) {
      clearTimeout(timeout);
      scheduledNotifications.delete(leadId);
      console.log(`üßπ Cleaned up old timer for lead: ${leadId}`);
    }
  }
}, 60 * 60 * 1000); // –ö–∞–∂–¥—ã–π —á–∞—Å
```

#### 3.3. Connection Pooling –¥–ª—è –ë–î

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å** `maxConnections` –≤ Supabase client:
```typescript
const landingSupabase = createClient(URL, KEY, {
  db: {
    schema: 'public',
  },
  global: {
    headers: { 'x-connection-pool': 'true' },
  },
  // –î–æ–±–∞–≤–∏—Ç—å connection pooling
  auth: {
    autoRefreshToken: false,
    persistSession: false,
  },
});
```

### 4. –ö–≠–®–ò–†–û–í–ê–ù–ò–ï

#### 4.1. –ö—ç—à –¥–ª—è AmoCRM —Ç–æ–∫–µ–Ω–∞

**–ü—Ä–æ–±–ª–µ–º–∞**: –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–∫–µ–Ω

**–†–µ—à–µ–Ω–∏–µ**: –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ 1 —á–∞—Å
```typescript
const amoCRMCache = new Map<string, { token: string; expires: number }>();

function getAmoCRMToken(): string {
  const cached = amoCRMCache.get('token');
  if (cached && cached.expires > Date.now()) {
    return cached.token;
  }
  
  // Refresh token
  const newToken = process.env.AMOCRM_ACCESS_TOKEN;
  amoCRMCache.set('token', {
    token: newToken,
    expires: Date.now() + 60 * 60 * 1000, // 1 hour
  });
  
  return newToken;
}
```

#### 4.2. Rate Limiting –¥–ª—è duplicate submissions

**–ü—Ä–æ–±–ª–µ–º–∞**: –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–ø–∞–º–∏—Ç—å —Ñ–æ—Ä–º—É

**–†–µ—à–µ–Ω–∏–µ**: Rate limit –ø–æ IP
```typescript
const submissionCache = new Map<string, number>();

function canSubmit(ip: string): boolean {
  const lastSubmit = submissionCache.get(ip);
  if (lastSubmit && Date.now() - lastSubmit < 60000) {
    return false; // –ú–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ä–∞–∑ –≤ –º–∏–Ω—É—Ç—É
  }
  submissionCache.set(ip, Date.now());
  return true;
}
```

### 5. ERROR HANDLING

#### 5.1. Graceful Degradation

**–ü—Ä–∏–Ω—Ü–∏–ø**: –ï—Å–ª–∏ –æ–¥–∏–Ω —Å–µ—Ä–≤–∏—Å —É–ø–∞–ª - –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç

```typescript
// ‚úÖ –£–ñ–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û –≤ retryWithBackoff
// –ù–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

async function safeExecute<T>(
  name: string,
  fn: () => Promise<T>,
): Promise<T | null> {
  try {
    return await fn();
  } catch (error) {
    console.error(`‚ùå ${name} failed:`, error);
    // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Sentry, etc)
    return null;
  }
}
```

#### 5.2. Circuit Breaker –¥–ª—è AmoCRM

**–ü—Ä–æ–±–ª–µ–º–∞**: –ï—Å–ª–∏ AmoCRM –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ —Ç–∞–π–º–∞—É—Ç—ã

**–†–µ—à–µ–Ω–∏–µ**: Circuit breaker pattern
```typescript
class CircuitBreaker {
  private failures = 0;
  private lastFailure = 0;
  private threshold = 5;
  private timeout = 60000; // 1 min

  async execute<T>(fn: () => Promise<T>): Promise<T | null> {
    if (this.isOpen()) {
      console.warn('Circuit breaker OPEN - skipping');
      return null;
    }

    try {
      const result = await fn();
      this.onSuccess();
      return result;
    } catch (error) {
      this.onFailure();
      throw error;
    }
  }

  private isOpen(): boolean {
    if (this.failures >= this.threshold) {
      if (Date.now() - this.lastFailure < this.timeout) {
        return true;
      }
      // –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞
      this.failures = 0;
    }
    return false;
  }

  private onSuccess() {
    this.failures = 0;
  }

  private onFailure() {
    this.failures++;
    this.lastFailure = Date.now();
  }
}
```

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

| –ú–µ—Ç—Ä–∏–∫–∞ | –°–µ–π—á–∞—Å | –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|--------|-------------------|-----------|
| Response time (API) | 200-500ms | 100-200ms | **2x –±—ã—Å—Ç—Ä–µ–µ** |
| –ë–î –∑–∞–ø—Ä–æ—Å (–ø–æ–∏—Å–∫) | 100-1000ms | 1-10ms | **100x –±—ã—Å—Ç—Ä–µ–µ** |
| Frontend FPS | 30-40 | 50-60 | **50% –ø–ª–∞–≤–Ω–µ–µ** |
| Memory usage | 100MB | 50MB | **50% –º–µ–Ω—å—à–µ** |
| Error rate | 1-2% | <0.1% | **20x –Ω–∞–¥–µ–∂–Ω–µ–µ** |
| AmoCRM availability | 95% | 99.9% | Circuit breaker |

---

## üöÄ –ü–†–ò–û–†–ò–¢–ï–¢–´ –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### ‚ö° –ö–†–ò–¢–ò–ß–ù–û (–°–¥–µ–ª–∞—Ç—å —Å–µ–π—á–∞—Å):
1. ‚úÖ **–ë–î –∏–Ω–¥–µ–∫—Å—ã** - –æ–≥—Ä–æ–º–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
2. ‚úÖ **Frontend –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - —É–º–µ–Ω—å—à–∏—Ç—å –ª–∞–≥–∏ –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
3. ‚úÖ **Rate limiting** - –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞

### üîß –í–ê–ñ–ù–û (–°–¥–µ–ª–∞—Ç—å —Å–∫–æ—Ä–æ):
4. ‚úÖ **Lazy initialization** - –º–µ–Ω—å—à–µ memory
5. ‚úÖ **Connection pooling** - –±—ã—Å—Ç—Ä–µ–µ –ë–î
6. ‚úÖ **Circuit breaker** - –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å

### üìä –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û (–ú–æ–∂–Ω–æ –ø–æ—Ç–æ–º):
7. ‚ö™ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Sentry/LogRocket)
8. ‚ö™ CDN –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏
9. ‚ö™ Redis –¥–ª—è –∫—ç—à–∞

---

## üß™ –ö–ê–ö –ü–†–û–í–ï–†–ò–¢–¨ –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨

### 1. Response Time
```bash
# –¢–µ—Å—Ç API response time
time curl -X POST https://api.onai.academy/api/landing/proftest \
  -H "Content-Type: application/json" \
  -d '{"name":"Test","email":"test@example.com","phone":"+77771234567"}'
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è**: < 200ms

### 2. Database Performance
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å EXPLAIN PLAN
EXPLAIN ANALYZE 
SELECT * FROM landing_leads 
WHERE email = 'test@example.com';
```

**–ë–µ–∑ –∏–Ω–¥–µ–∫—Å–∞**: Seq Scan (–º–µ–¥–ª–µ–Ω–Ω–æ)  
**–° –∏–Ω–¥–µ–∫—Å–æ–º**: Index Scan (–±—ã—Å—Ç—Ä–æ)

### 3. Frontend Performance
```javascript
// –í Chrome DevTools > Performance
// –ó–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –≤–æ –≤—Ä–µ–º—è –∞–Ω–∏–º–∞—Ü–∏–∏
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å FPS (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 50-60)
```

### 4. Memory Usage
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å memory –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh onai-backend "pm2 monit"
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è**: < 100MB

---

## üìù CHECKLIST –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò

### Backend:
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ë–î –∏–Ω–¥–µ–∫—Å—ã
- [ ] Lazy initialization –¥–ª—è Resend
- [ ] Cleanup –¥–ª—è scheduledNotifications
- [ ] Rate limiting –ø–æ IP
- [ ] Circuit breaker –¥–ª—è AmoCRM
- [ ] Connection pooling

### Frontend:
- [ ] –û—Ç–∫–ª—é—á–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
- [ ] –£–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å—Ç–∏—Ü
- [ ] requestIdleCallback –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π
- [ ] Lazy load –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [ ] Code splitting

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
- [ ] –î–æ–±–∞–≤–∏—Ç—å performance metrics
- [ ] Error tracking (Sentry)
- [ ] User session recording
- [ ] Real User Monitoring (RUM)

---

**Next Steps**: –ù–∞—á–∞—Ç—å —Å –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π (–ë–î –∏–Ω–¥–µ–∫—Å—ã + Frontend)















