# üöÄ DEPLOY –¢–û–õ–¨–ö–û –≠–¢–û–ô –§–ò–ß–ò (–∑–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)

## ‚úÖ –ß–¢–û –í –ö–û–ú–ú–ò–¢–ï (–±–µ–∑–æ–ø–∞—Å–Ω–æ):

```bash
git log --oneline -1
# e1a0311 feat: Add protection against duplicate Telegram leads

git show --stat
```

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- ‚úÖ `backend/scripts/start-clean.sh` (–Ω–æ–≤—ã–π —Ñ–∞–π–ª)
- ‚úÖ `backend/scripts/check-duplicates.sh` (–Ω–æ–≤—ã–π —Ñ–∞–π–ª)
- ‚úÖ `backend/package.json` (—Ç–æ–ª—å–∫–æ 2 —Å—Ç—Ä–æ–∫–∏: dev:clean, check)
- ‚úÖ 4 —Ñ–∞–π–ª–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ .md

**–ù–ï —Ç—Ä–æ–≥–∞–ª–∏:**
- ‚úÖ `server.ts` - –ë–ï–ó –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ `telegram-leads.ts` - –ë–ï–ó –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ `landing.ts` - –ë–ï–ó –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ –õ—é–±–æ–π –∫—Ä–∏—Ç–∏—á–Ω—ã–π –∫–æ–¥ - –ë–ï–ó –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üéØ –ö–ê–ö DEPLOY –ù–ê –°–ï–†–í–ï–†:

### **–í–∞—Ä–∏–∞–Ω—Ç 1: Git pull (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:
cd /path/to/onai-integrator-login

# Pull —Ç–æ–ª—å–∫–æ —ç—Ç–æ–≥–æ –∫–æ–º–º–∏—Ç–∞
git pull origin main

# –ò–õ–ò –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ —ç—Ç–æ—Ç –∫–æ–º–º–∏—Ç:
git fetch
git cherry-pick e1a0311

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –Ω–æ–≤–æ–π –∫–æ–º–∞–Ω–¥–æ–π
cd backend
npm run dev:clean
```

### **–í–∞—Ä–∏–∞–Ω—Ç 2: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ (–±–µ–∑–æ–ø–∞—Å–Ω–µ–µ)**

```bash
# –° –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä:
scp backend/scripts/start-clean.sh user@server:/path/to/backend/scripts/
scp backend/scripts/check-duplicates.sh user@server:/path/to/backend/scripts/

# –°–¥–µ–ª–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
ssh user@server "chmod +x /path/to/backend/scripts/*.sh"

# –û–±–Ω–æ–≤–∏—Ç—å package.json –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (—Ç–æ–ª—å–∫–æ 2 —Å—Ç—Ä–æ–∫–∏):
# –î–æ–±–∞–≤—å –≤ "scripts":
#   "dev:clean": "bash scripts/start-clean.sh",
#   "check": "bash scripts/check-duplicates.sh",
```

### **–í–∞—Ä–∏–∞–Ω—Ç 3: –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (—Å–∞–º–æ–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ)**

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å–æ–∑–¥–∞–π —Ñ–∞–π–ª—ã –≤—Ä—É—á–Ω—É—é:**

```bash
# 1. –°–æ–∑–¥–∞–π start-clean.sh
nano /path/to/backend/scripts/start-clean.sh
# –°–∫–æ–ø–∏—Ä—É–π —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏
chmod +x /path/to/backend/scripts/start-clean.sh

# 2. –°–æ–∑–¥–∞–π check-duplicates.sh
nano /path/to/backend/scripts/check-duplicates.sh
# –°–∫–æ–ø–∏—Ä—É–π —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
chmod +x /path/to/backend/scripts/check-duplicates.sh

# 3. –û–±–Ω–æ–≤i package.json
nano /path/to/backend/package.json
# –î–æ–±–∞–≤—å –≤ —Å–µ–∫—Ü–∏—é "scripts":
#   "dev:clean": "bash scripts/start-clean.sh",
#   "check": "bash scripts/check-duplicates.sh",
```

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û –î–õ–Ø PRODUCTION:

### **–ü–ï–†–ï–î deploy –ø—Ä–æ–≤–µ—Ä—å –ª–æ–∫–∞–ª—å–Ω–æ:**

```bash
# 1. –£–±–µ–¥–∏—Å—å —á—Ç–æ —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç
npm run check

# 2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π –Ω–æ–≤—É—é –∫–æ–º–∞–Ω–¥—É
npm run dev:clean

# 3. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ Telegram –ª–∏–¥—ã –ø—Ä–∏—Ö–æ–¥—è—Ç
# –û—Ç–ø—Ä–∞–≤—å —Ç–µ—Å—Ç–æ–≤—É—é –∑–∞—è–≤–∫—É

# 4. –ï—Å–ª–∏ –≤—Å–µ –û–ö - –¥–µ–ª–∞–π deploy
```

### **–ü–æ—Å–ª–µ deploy –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh user@server

# 2. –ü–µ—Ä–µ–π–¥–∏ –≤ backend
cd /path/to/backend

# 3. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Å–∫—Ä–∏–ø—Ç—ã –Ω–∞ –º–µ—Å—Ç–µ
ls -lh scripts/*.sh

# 4. –ü—Ä–æ–≤–µ—Ä—å package.json
cat package.json | grep "dev:clean"

# 5. –¢–µ—Å—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
npm run check

# 6. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –∑–∞—â–∏—Ç–æ–π
# –û—Å—Ç–∞–Ω–æ–≤–∏ —Å—Ç–∞—Ä—ã–π –ø—Ä–æ—Ü–µ—Å—Å (pm2 stop –∏–ª–∏ killall node)
npm run dev:clean

# 7. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
npm run check
# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: ‚úÖ –í–°–ï –•–û–†–û–®–û!

# 8. –û—Ç–ø—Ä–∞–≤—å —Ç–µ—Å—Ç–æ–≤—É—é –∑–∞—è–≤–∫—É
# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –ø—Ä–∏—à–ª–∞ –û–î–ò–ù –†–ê–ó –≤ Telegram ‚úÖ
```

---

## üõ°Ô∏è –û–¢–ö–ê–¢ (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫):

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:
cd /path/to/backend

# –í–∞—Ä–∏–∞–Ω—Ç 1: Git revert
git revert e1a0311

# –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä–æ—Å—Ç–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã
npm run dev  # –°—Ç–∞—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

# –í–∞—Ä–∏–∞–Ω—Ç 3: –£–¥–∞–ª–∏—Ç—å —Å–∫—Ä–∏–ø—Ç—ã
rm scripts/start-clean.sh scripts/check-duplicates.sh
# –£–±—Ä–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ –∏–∑ package.json
```

**Telegram –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ!** –°–∫—Ä–∏–ø—Ç—ã —Ç–æ–ª—å–∫–æ –ø–æ–º–æ–≥–∞—é—Ç, –Ω–æ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.

---

## üìä –ü–†–û–í–ï–†–ö–ê –ü–û–°–õ–ï DEPLOY:

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:

# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —Ñ–∞–π–ª—ã –Ω–∞ –º–µ—Å—Ç–µ
ls -lh backend/scripts/start-clean.sh
ls -lh backend/scripts/check-duplicates.sh

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –∫–æ–º–∞–Ω–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç
cd backend
npm run check
# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω
lsof -ti:3000
# –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å 1 PID

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ Telegram —Ä–∞–±–æ—Ç–∞–µ—Ç
curl http://localhost:3000/api/telegram-leads/health
# –ò–ª–∏ –æ—Ç–ø—Ä–∞–≤—å —Ç–µ—Å—Ç–æ–≤—É—é –∑–∞—è–≤–∫—É

# 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
tail -f logs/combined.log | grep "Telegram"
# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—Ç–ø—Ä–∞–≤–∫–µ

# 6. –§–ò–ù–ê–õ–¨–ù–´–ô –¢–ï–°–¢: –û—Ç–ø—Ä–∞–≤—å —Ä–µ–∞–ª—å–Ω—É—é –∑–∞—è–≤–∫—É
# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –ø—Ä–∏—à–ª–∞ –û–î–ò–ù –†–ê–ó ‚úÖ
```

---

## üéØ DEPLOY CHECKLIST:

**–ü–µ—Ä–µ–¥ deploy:**
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª –ª–æ–∫–∞–ª—å–Ω–æ ‚úÖ
- [ ] –ö–æ–º–º–∏—Ç —Å–æ–∑–¥–∞–Ω ‚úÖ
- [ ] Telegram —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ ‚úÖ
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω—ã ‚úÖ

**–í–æ –≤—Ä–µ–º—è deploy:**
- [ ] –°–¥–µ–ª–∞–ª backup —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞
- [ ] Git pull / cherry-pick / —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª —Ñ–∞–π–ª—ã
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ —Ñ–∞–π–ª—ã –Ω–∞ –º–µ—Å—Ç–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (chmod +x)

**–ü–æ—Å–ª–µ deploy:**
- [ ] –ó–∞–ø—É—Å—Ç–∏–ª `npm run check`
- [ ] –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–ª —Å `npm run dev:clean`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ —Ç–æ–ª—å–∫–æ 1 –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –ø–æ—Ä—Ç—É 3000
- [ ] –û—Ç–ø—Ä–∞–≤–∏–ª —Ç–µ—Å—Ç–æ–≤—É—é –∑–∞—è–≤–∫—É
- [ ] –ó–∞—è–≤–∫–∞ –ø—Ä–∏—à–ª–∞ –û–î–ò–ù –†–ê–ó –≤ Telegram ‚úÖ

---

## üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:

1. **Deploy –≤ –Ω–µ—Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è** (–Ω–æ—á—å/–≤—ã—Ö–æ–¥–Ω—ã–µ)
2. **–ò–º–µ–π backup** –Ω–∞ —Å–ª—É—á–∞–π –æ—Ç–∫–∞—Ç–∞
3. **–ü—Ä–æ–≤–µ—Ä—è–π –ø–æ —á–µ–∫–ª–∏—Å—Ç—É** –≤—ã—à–µ
4. **–ù–µ –ø–∞–Ω–∏–∫—É–π** - –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω—ã!

**–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ–π–¥–µ—Ç –Ω–µ —Ç–∞–∫:**
- –°—Ç–∞—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞ `npm run dev` –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- Telegram –Ω–µ —Å–ª–æ–º–∞–µ—Ç—Å—è (–∫–æ–¥ –Ω–µ —Ç—Ä–æ–≥–∞–ª–∏)
- –ú–æ–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å –∫–æ–º–º–∏—Ç –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —É–¥–∞–ª–∏—Ç—å —Å–∫—Ä–∏–ø—Ç—ã

---

## üéâ –ì–û–¢–û–í–û –ö DEPLOY!

**–ö–æ–º–º–∏—Ç:** `e1a0311`  
**–§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ:** 7 (–≤—Å–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ)  
**–†–∏—Å–∫:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π ‚úÖ  
**Telegram:** –ü—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å ‚úÖ

**Push –∫–æ–º–º–∏—Ç–∞:**
```bash
git push origin main
```

**–ü–æ—Ç–æ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
```bash
git pull origin main
cd backend && npm run dev:clean
```

**–í–°–ï! –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞! üõ°Ô∏è**






