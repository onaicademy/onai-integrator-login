# üéôÔ∏è –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï WHISPER API (–ì–û–õ–û–°–û–í–´–ï –°–û–û–ë–©–ï–ù–ò–Ø)

**–ü—Ä–æ–±–ª–µ–º–∞:** Whisper API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π  
**–ü—Ä–∏—á–∏–Ω–∞:** –°—Ç–∞—Ä—ã–π OpenAI API –∫–ª—é—á –æ—Ç–æ–∑–≤–∞–Ω  
**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–ª—é—á –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

---

## üö® –°–†–û–ß–ù–û: –°–û–ó–î–ê–ô –ù–û–í–´–ô OPENAI API –ö–õ–Æ–ß

### –ü–æ—á–µ–º—É –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç Whisper:
1. Whisper API = —á–∞—Å—Ç—å OpenAI API
2. –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–ª—é—á –¥–ª—è GPT-4 –∏ Whisper
3. –°—Ç–∞—Ä—ã–π –∫–ª—é—á –±—ã–ª –æ—Ç–æ–∑–≤–∞–Ω OpenAI (—É—Ç–µ—á–∫–∞ –≤ Git)
4. –ù—É–∂–µ–Ω –ù–û–í–´–ô –∫–ª—é—á –¥–ª—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π

---

## ‚úÖ –®–ê–ì 1: –°–û–ó–î–ê–ô –ù–û–í–´–ô –ö–õ–Æ–ß

üëâ **–û—Ç–∫—Ä–æ–π:** https://platform.openai.com/api-keys

1. –ù–∞–∂–º–∏ **"+ Create new secret key"**
2. –ù–∞–∑–æ–≤–∏: `onAI-Academy-Production-Nov2025`
3. **–°–∫–æ–ø–∏—Ä—É–π –∫–ª—é—á** (–ø–æ–∫–∞–∂–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä–∞–∑!)
4. –°–æ—Ö—Ä–∞–Ω–∏ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –º–µ—Å—Ç–æ

---

## ‚úÖ –®–ê–ì 2: –û–ë–ù–û–í–ò –õ–û–ö–ê–õ–¨–ù–´–ô .ENV

```bash
# –§–∞–π–ª: .env (—É —Ç–µ–±—è –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ)

# OpenAI API - –û–î–ò–ù –ö–õ–Æ–ß –î–õ–Ø –í–°–ï–ì–û!
VITE_OPENAI_API_KEY=sk-proj-–í–°–¢–ê–í–¨_–ù–û–í–´–ô_–ö–õ–Æ–ß_–°–Æ–î–ê
VITE_OPENAI_ASSISTANT_ID=asst_SYhUvkKgCMEYlAjA0VNSMbLa

# –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π...
```

---

## ‚úÖ –®–ê–ì 3: –ü–ï–†–ï–ó–ê–ü–£–°–¢–ò –°–ï–†–í–ï–†

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏ —Ç–µ–∫—É—â–∏–π (Ctrl+C)
npm run dev
```

---

## üß™ –®–ê–ì 4: –ü–†–û–¢–ï–°–¢–ò–†–£–ô –ì–û–õ–û–°–û–í–´–ï –°–û–û–ë–©–ï–ù–ò–Ø

### –ù–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ:

1. **–û—Ç–∫—Ä–æ–π:** https://localhost:8080
2. **–û—Ç–∫—Ä–æ–π AI-–∫—É—Ä–∞—Ç–æ—Ä–∞** (—á–∞—Ç)
3. **–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞** üéôÔ∏è
4. **–°–∫–∞–∂–∏ —á—Ç–æ-–Ω–∏–±—É–¥—å** (–º–∏–Ω–∏–º—É–º 1 —Å–µ–∫—É–Ω–¥–∞)
5. **–û—Ç–ø—É—Å—Ç–∏ –∫–Ω–æ–ø–∫—É** (–∑–∞–ø–∏—Å—å –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è)
6. **–î–æ–∂–¥–∏—Å—å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏** (–¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è —Ç–µ–∫—Å—Ç –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞)
7. **–û—Ç–ø—Ä–∞–≤—å —Å–æ–æ–±—â–µ–Ω–∏–µ** (–Ω–∞–∂–º–∏ Enter –∏–ª–∏ –∫–Ω–æ–ø–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏)

### –ß—Ç–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏–∑–æ–π—Ç–∏:

```
‚úÖ –ó–∞–ø–∏—Å—å –Ω–∞—á–∞–ª–∞—Å—å
‚úÖ –ê—É–¥–∏–æ –∑–∞–ø–∏—Å–∞–Ω–æ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ä–∞–∑–º–µ—Ä –≤ –±–∞–π—Ç–∞—Ö)
‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Whisper API
‚úÖ –¢–µ–∫—Å—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω –∏ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
‚úÖ –ú–æ–∂–µ—à—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
```

### –ï—Å–ª–∏ –æ—à–∏–±–∫–∞:

**–û—Ç–∫—Ä–æ–π –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –∏ –ø–æ—Å–º–æ—Ç—Ä–∏:**

```javascript
// –£—Å–ø–µ—à–Ω–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è:
üéôÔ∏è === –ù–ê–ß–ê–õ–û –¢–†–ê–ù–°–ö–†–ò–ü–¶–ò–ò ===
üìä –†–∞–∑–º–µ—Ä –∞—É–¥–∏–æ: 45678 –±–∞–π—Ç
üìä –¢–∏–ø –∞—É–¥–∏–æ: audio/webm
üìù –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞: webm
‚è±Ô∏è –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞—É–¥–∏–æ: 3.2 —Å–µ–∫—É–Ω–¥
üì§ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Whisper API...
üì• –û—Ç–≤–µ—Ç –æ—Ç Whisper API: "–ü—Ä–∏–≤–µ—Ç, —ç—Ç–æ —Ç–µ—Å—Ç"
‚úÖ === –¢–†–ê–ù–°–ö–†–ò–ü–¶–ò–Ø –£–°–ü–ï–®–ù–ê ===

// –û—à–∏–±–∫–∞ API –∫–ª—é—á–∞:
‚ùå OpenAI API error: Invalid API key
```

---

## üîç –ö–ê–ö –†–ê–ë–û–¢–ê–ï–¢ WHISPER –í –ö–û–î–ï

### –§–∞–π–ª: `src/lib/openai-assistant.ts`

```typescript
export async function transcribeAudioToText(
  audioBlob: Blob, 
  userId?: string, 
  threadId?: string
): Promise<string> {
  const client = initOpenAI(); // ‚Üê –ò—Å–ø–æ–ª—å–∑—É–µ—Ç VITE_OPENAI_API_KEY
  
  const file = new File([audioBlob], `audio.webm`, { 
    type: audioBlob.type 
  });
  
  const response = await client.audio.transcriptions.create({
    file: file,
    model: "whisper-1",
    language: "ru", // –†—É—Å—Å–∫–∏–π —è–∑—ã–∫
    response_format: "text",
    prompt: "–≠—Ç–æ –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å—Ç—É–¥–µ–Ω—Ç–∞...",
  });
  
  return response as string;
}
```

### –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:

1. **–û–¥–∏–Ω –∫–ª–∏–µ–Ω—Ç OpenAI** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è GPT-4 –ò Whisper
2. **Whisper model:** `whisper-1`
3. **–Ø–∑—ã–∫:** `ru` (—Ä—É—Å—Å–∫–∏–π)
4. **–§–æ—Ä–º–∞—Ç:** `text` (—Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç, –±–µ–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö)

---

## üí∞ –°–¢–û–ò–ú–û–°–¢–¨ WHISPER API

### –¶–µ–Ω—ã OpenAI:

- **Whisper-1:** $0.006 –∑–∞ –º–∏–Ω—É—Ç—É –∞—É–¥–∏–æ
- **–ü—Ä–∏–º–µ—Ä:** 10 –º–∏–Ω—É—Ç –≥–æ–ª–æ—Å–æ–≤—ã—Ö = $0.06 (‚âà 27 —Ç–µ–Ω–≥–µ)

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

–í—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Whisper –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `ai_token_usage`:

```sql
SELECT 
  audio_duration_seconds,
  cost_kzt,
  created_at
FROM ai_token_usage
WHERE agent_type = 'ai_curator'
  AND operation_type = 'voice_transcription'
ORDER BY created_at DESC;
```

---

## üêõ –¢–ò–ü–ò–ß–ù–´–ï –û–®–ò–ë–ö–ò –ò –†–ï–®–ï–ù–ò–Ø

### –û—à–∏–±–∫–∞ 1: "Invalid API key"
**–ü—Ä–∏—á–∏–Ω–∞:** –ö–ª—é—á —É—Å—Ç–∞—Ä–µ–ª –∏–ª–∏ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.env`  
**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π –∫–ª—é—á –∏ –æ–±–Ω–æ–≤–∏ `.env`

### –û—à–∏–±–∫–∞ 2: "–ê—É–¥–∏–æ —Ñ–∞–π–ª –ø—É—Å—Ç–æ–π"
**–ü—Ä–∏—á–∏–Ω–∞:** –ú–∏–∫—Ä–æ—Ñ–æ–Ω –Ω–µ –¥–∞–ª —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏–ª–∏ –∑–∞–ø–∏—Å—å —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∞—è  
**–†–µ—à–µ–Ω–∏–µ:** 
- –î–∞–π —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –±—Ä–∞—É–∑–µ—Ä—É –Ω–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω
- –ì–æ–≤–æ—Ä–∏ –º–∏–Ω–∏–º—É–º 1 —Å–µ–∫—É–Ω–¥—É

### –û—à–∏–±–∫–∞ 3: "–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ä–µ—á—å"
**–ü—Ä–∏—á–∏–Ω–∞:** Whisper –≤–µ—Ä–Ω—É–ª –ø—É—Å—Ç–æ–π —Ç–µ–∫—Å—Ç  
**–†–µ—à–µ–Ω–∏–µ:**
- –ì–æ–≤–æ—Ä–∏ –≥—Ä–æ–º—á–µ –∏ —á—ë—Ç—á–µ
- –£–±–µ—Ä–∏ —Ñ–æ–Ω–æ–≤—ã–π —à—É–º
- –ü–æ–ø—Ä–æ–±—É–π –¥—Ä—É–≥–æ–π –º–∏–∫—Ä–æ—Ñ–æ–Ω

### –û—à–∏–±–∫–∞ 4: "Network error"
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ API  
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ OpenAI API –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

---

## üìã –ß–ï–ö–õ–ò–°–¢ –ü–†–û–í–ï–†–ö–ò

- [ ] –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π OpenAI API –∫–ª—é—á
- [ ] `.env` –æ–±–Ω–æ–≤–ª—ë–Ω —Å –Ω–æ–≤—ã–º –∫–ª—é—á–æ–º
- [ ] Dev-—Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- [ ] –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –æ—Ç–∫—Ä—ã–ª–∞—Å—å –Ω–∞ localhost:8080
- [ ] AI-–∫—É—Ä–∞—Ç–æ—Ä –æ—Ç–∫—Ä—ã—Ç
- [ ] –ö–Ω–æ–ø–∫–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç (–∑–∞–ø–∏—Å—å –∏–¥—ë—Ç)
- [ ] –ì–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∞–ª–æ—Å—å
- [ ] Whisper —Ä–∞—Å–ø–æ–∑–Ω–∞–ª —Ç–µ–∫—Å—Ç
- [ ] –¢–µ–∫—Å—Ç –ø–æ—è–≤–∏–ª—Å—è –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
- [ ] –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ AI-–∫—É—Ä–∞—Ç–æ—Ä—É
- [ ] –û—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω

---

## üéØ –ß–¢–û –î–ê–õ–¨–®–ï

### –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ:

1. –û–±–Ω–æ–≤–∏ `.env` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (Digital Ocean)
2. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏ production build
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π –Ω–∞ production

### –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. –ü–æ–∫–∞–∂–∏ –º–Ω–µ –∫–æ–Ω—Å–æ–ª—å–Ω—ã–µ –ª–æ–≥–∏ (F12 ‚Üí Console)
2. –ü–æ–∫–∞–∂–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç –æ—à–∏–±–∫–∏
3. –Ø –ø–æ–º–æ–≥—É –Ω–∞–π—Ç–∏ –ø—Ä–æ–±–ª–µ–º—É

---

## üìû –°–í–Ø–ñ–ò–°–¨ –°–û –ú–ù–û–ô –ö–û–ì–î–ê:

‚úÖ –°–æ–∑–¥–∞–ª –Ω–æ–≤—ã–π –∫–ª—é—á - —Å–∫–∞–∂–∏ "–ö–ª—é—á —Å–æ–∑–¥–∞–Ω"  
‚ùå Whisper –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –ø–æ–∫–∞–∂–∏ –ª–æ–≥–∏ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏  
üí¨ –ï—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã - —Å–ø—Ä–∞—à–∏–≤–∞–π

---

**–ì–ª–∞–≤–Ω–æ–µ: –°–û–ó–î–ê–ô –ù–û–í–´–ô API –ö–õ–Æ–ß! –ë–µ–∑ –Ω–µ–≥–æ –Ω–∏—á–µ–≥–æ –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å. üîë**

