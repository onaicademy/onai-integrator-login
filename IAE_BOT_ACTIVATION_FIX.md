# üîß IAE Bot - Activation Fix

## –ü—Ä–æ–±–ª–µ–º–∞

–ö–æ–¥ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ `2134` –Ω–µ —Ä–∞–±–æ—Ç–∞–ª –≤ IAE –±–æ—Ç–µ.

## –ü—Ä–∏—á–∏–Ω–∞

IAE –±–æ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª **–¥—Ä—É–≥—É—é –ª–æ–≥–∏–∫—É –∞–∫—Ç–∏–≤–∞—Ü–∏–∏** —á–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–∞–±–æ—á–∏–π –±–æ—Ç:
- ‚ùå –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞: —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã `/start` + –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ `bot.on('message')`
- ‚úÖ –†–∞–±–æ—á–∞—è –ª–æ–≥–∏–∫–∞: –ø—Ä–æ—Å—Ç–æ–µ `bot.on('message')` —Å–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º `text === '2134'`

## –†–µ—à–µ–Ω–∏–µ

–ü–µ—Ä–µ–ø–∏—Å–∞–ª IAE –±–æ—Ç–∞ **–¢–û–ß–ù–û** –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç `telegramBot.ts`:

### –ë—ã–ª–æ:
```typescript
// –ö–æ–º–∞–Ω–¥—ã —á–µ—Ä–µ–∑ onText
iaeBot.onText(/\/start/, ...)
iaeBot.onText(/\/help/, ...)
iaeBot.onText(/\/status/, ...)

// –ê–∫—Ç–∏–≤–∞—Ü–∏—è —á–µ—Ä–µ–∑ bot.on —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –Ω–∞ –∫–æ–º–∞–Ω–¥—ã
iaeBot.on('message', async (msg) => {
  if (msg.text?.startsWith('/')) return; // –ò–≥–Ω–æ—Ä–∏–º –∫–æ–º–∞–Ω–¥—ã
  if (msg.text === ACTIVATION_CODE) { ... }
});
```

### –°—Ç–∞–ª–æ:
```typescript
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é (–∫–∞–∫ —É –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–æ—Ç–∞)
export function initIAEBot() {
  // /start –∫–æ–º–∞–Ω–¥–∞
  iaeBot.onText(/\/start/, ...);
  
  // /status –∫–æ–º–∞–Ω–¥–∞  
  iaeBot.onText(/\/status/, ...);
  
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–¥–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (–ë–ï–ó —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∫–æ–º–∞–Ω–¥!)
  iaeBot.on('message', async (msg) => {
    const text = msg.text?.trim();
    if (!text || !msg.from?.id) return;
    
    // –ü—Ä–æ—Å—Ç–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ - –∫–∞–∫ —É –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–æ—Ç–∞!
    if (text === ACTIVATION_CODE) {
      // –ê–∫—Ç–∏–≤–∞—Ü–∏—è...
    }
  });
}
```

### –í server.ts:
```typescript
// –í—ã–∑–æ–≤ initIAEBot() –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
const { initIAEBot } = await import('./services/iaeAgentBot.js');
initIAEBot();
```

## –ò–∑–º–µ–Ω–µ–Ω–∏—è

1. **–£–±—Ä–∞–ª** –∫–æ–º–∞–Ω–¥—ã `/help`, `/deactivate` (—É–ø—Ä–æ—Å—Ç–∏–ª)
2. **–î–æ–±–∞–≤–∏–ª** —Ñ—É–Ω–∫—Ü–∏—é `initIAEBot()` –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
3. **–ü–µ—Ä–µ–ø–∏—Å–∞–ª** `bot.on('message')` —Ç–æ—á–Ω–æ –∫–∞–∫ —É `telegramBot.ts`
4. **–î–æ–±–∞–≤–∏–ª** –≤—ã–∑–æ–≤ `initIAEBot()` –≤ `server.ts`

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–∫—Ç–∏–≤–∞—Ü–∏—è (—Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ):

1. –î–æ–±–∞–≤—å IAE –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É
2. –û—Ç–ø—Ä–∞–≤—å –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç: **`2134`** (–±–µ–∑ —Å–ª—ç—à–∞!)
3. –ë–æ—Ç –æ—Ç–≤–µ—Ç–∏—Ç: **"‚úÖ –ê–ö–¢–ò–í–ê–¶–ò–Ø –£–°–ü–ï–®–ù–ê!"**
4. –ß–∞—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `data/iae-active-chats.json`

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞:

- `/start` - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
- `/status` - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –ª–∏ —á–∞—Ç
- `2134` - –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —á–∞—Ç (–ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç!)

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏ backend
cd backend
npm exec tsx src/server.ts

# 2. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# ‚úÖ [IAE Bot] Bot initialized
# ü§ñ [IAE Bot] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤...

# 3. –í Telegram:
# - –î–æ–±–∞–≤—å –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É
# - –û—Ç–ø—Ä–∞–≤—å: 2134
# - –ü–æ–ª—É—á–∏—à—å: ‚úÖ –ê–ö–¢–ò–í–ê–¶–ò–Ø –£–°–ü–ï–®–ù–ê!

# 4. –ü—Ä–æ–≤–µ—Ä—å —Ñ–∞–π–ª
cat data/iae-active-chats.json
# –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–≤–æ–π chatId
```

## Commit

```
üîß FIX: IAE Bot activation - rewrite –∫–∞–∫ —É –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–æ—Ç–∞

Commit: 9bfbaa6
Files changed: 2
Lines: -151, +85
```

## Deploy

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –Ω–∞ production:
1. Backend –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è —Å –Ω–æ–≤–æ–π –ª–æ–≥–∏–∫–æ–π
2. IAE –±–æ—Ç –Ω–∞—á–Ω–µ—Ç —Å–ª—É—à–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–æ–¥–æ–º `2134` –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç

---

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ! –¢–µ–ø–µ—Ä—å IAE –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ—á–Ω–æ –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–∞–±–æ—á–∏–π –±–æ—Ç!**
