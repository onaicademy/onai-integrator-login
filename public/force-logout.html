<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üîê –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã—Ö–æ–¥</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Manrope', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #030303;
      color: #00FF88;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 600px;
      width: 100%;
      background: rgba(0, 255, 136, 0.05);
      border: 1px solid rgba(0, 255, 136, 0.2);
      border-radius: 16px;
      padding: 40px;
      text-align: center;
    }
    
    h1 {
      font-size: 32px;
      margin-bottom: 20px;
      color: #00FF88;
      text-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
    }
    
    .log {
      margin: 20px 0;
      padding: 20px;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      text-align: left;
      max-height: 400px;
      overflow-y: auto;
    }
    
    .log-line {
      margin: 8px 0;
      padding: 4px 8px;
      border-left: 3px solid #00FF88;
      animation: fadeIn 0.3s ease-in;
    }
    
    .log-line.success {
      border-left-color: #00FF88;
      color: #00FF88;
    }
    
    .log-line.warning {
      border-left-color: #FFA500;
      color: #FFA500;
    }
    
    .log-line.error {
      border-left-color: #FF0000;
      color: #FF0000;
    }
    
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateX(-10px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    
    .redirect-message {
      margin-top: 20px;
      padding: 20px;
      background: rgba(0, 255, 136, 0.1);
      border: 1px solid rgba(0, 255, 136, 0.3);
      border-radius: 8px;
      font-size: 18px;
      font-weight: bold;
    }
    
    .countdown {
      font-size: 48px;
      margin: 20px 0;
      color: #00FF88;
      text-shadow: 0 0 30px rgba(0, 255, 136, 0.7);
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîê –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã—Ö–æ–¥</h1>
    <div class="log" id="log"></div>
    <div class="redirect-message" id="redirect" style="display: none;">
      <p>‚úÖ –ì–æ—Ç–æ–≤–æ! –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑:</p>
      <div class="countdown" id="countdown">3</div>
    </div>
  </div>

  <script>
    const log = document.getElementById('log');
    const redirect = document.getElementById('redirect');
    const countdownEl = document.getElementById('countdown');
    
    function addLog(message, type = 'success') {
      const line = document.createElement('div');
      line.className = `log-line ${type}`;
      line.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
      log.appendChild(line);
      log.scrollTop = log.scrollHeight;
    }
    
    async function forceLogout() {
      addLog('üîÑ –ù–∞—á–∏–Ω–∞–µ–º –ø–æ–ª–Ω—É—é –æ—á–∏—Å—Ç–∫—É...', 'warning');
      
      // 1. Clear localStorage
      try {
        const keys = Object.keys(localStorage);
        addLog(`üì¶ localStorage: –Ω–∞–π–¥–µ–Ω–æ ${keys.length} –∫–ª—é—á–µ–π`, 'success');
        keys.forEach(key => {
          addLog(`   - –£–¥–∞–ª—è–µ–º: ${key}`, 'success');
          localStorage.removeItem(key);
        });
        addLog('‚úÖ localStorage –æ—á–∏—â–µ–Ω', 'success');
      } catch (e) {
        addLog(`‚ö†Ô∏è localStorage: ${e.message}`, 'warning');
      }
      
      // 2. Clear sessionStorage
      try {
        const keys = Object.keys(sessionStorage);
        addLog(`üì¶ sessionStorage: –Ω–∞–π–¥–µ–Ω–æ ${keys.length} –∫–ª—é—á–µ–π`, 'success');
        sessionStorage.clear();
        addLog('‚úÖ sessionStorage –æ—á–∏—â–µ–Ω', 'success');
      } catch (e) {
        addLog(`‚ö†Ô∏è sessionStorage: ${e.message}`, 'warning');
      }
      
      // 3. Clear Service Workers
      if ('serviceWorker' in navigator) {
        try {
          const registrations = await navigator.serviceWorker.getRegistrations();
          addLog(`üîß Service Workers: –Ω–∞–π–¥–µ–Ω–æ ${registrations.length}`, 'success');
          for (const registration of registrations) {
            await registration.unregister();
            addLog(`   - –£–¥–∞–ª–µ–Ω: ${registration.scope}`, 'success');
          }
          addLog('‚úÖ Service Workers —É–¥–∞–ª–µ–Ω—ã', 'success');
        } catch (e) {
          addLog(`‚ö†Ô∏è Service Workers: ${e.message}`, 'warning');
        }
      }
      
      // 4. Clear Cache Storage
      if ('caches' in window) {
        try {
          const cacheNames = await caches.keys();
          addLog(`üíæ Cache Storage: –Ω–∞–π–¥–µ–Ω–æ ${cacheNames.length} –∫—ç—à–µ–π`, 'success');
          for (const name of cacheNames) {
            await caches.delete(name);
            addLog(`   - –£–¥–∞–ª–µ–Ω: ${name}`, 'success');
          }
          addLog('‚úÖ Cache Storage –æ—á–∏—â–µ–Ω', 'success');
        } catch (e) {
          addLog(`‚ö†Ô∏è Cache Storage: ${e.message}`, 'warning');
        }
      }
      
      // 5. Clear Cookies
      try {
        const cookies = document.cookie.split(';');
        addLog(`üç™ Cookies: –Ω–∞–π–¥–µ–Ω–æ ${cookies.length}`, 'success');
        cookies.forEach(cookie => {
          const name = cookie.split('=')[0].trim();
          document.cookie = `${name}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/`;
          addLog(`   - –£–¥–∞–ª–µ–Ω: ${name}`, 'success');
        });
        addLog('‚úÖ Cookies —É–¥–∞–ª–µ–Ω—ã', 'success');
      } catch (e) {
        addLog(`‚ö†Ô∏è Cookies: ${e.message}`, 'warning');
      }
      
      // 6. Clear IndexedDB
      if ('indexedDB' in window) {
        try {
          const databases = await indexedDB.databases();
          addLog(`üóÑÔ∏è IndexedDB: –Ω–∞–π–¥–µ–Ω–æ ${databases.length} –±–∞–∑`, 'success');
          for (const db of databases) {
            if (db.name) {
              indexedDB.deleteDatabase(db.name);
              addLog(`   - –£–¥–∞–ª–µ–Ω–∞: ${db.name}`, 'success');
            }
          }
          addLog('‚úÖ IndexedDB –æ—á–∏—â–µ–Ω', 'success');
        } catch (e) {
          addLog(`‚ö†Ô∏è IndexedDB: ${e.message}`, 'warning');
        }
      }
      
      addLog('', 'success');
      addLog('üéâ –ü–û–õ–ù–ê–Ø –û–ß–ò–°–¢–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê!', 'success');
      addLog('‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏ —É–¥–∞–ª–µ–Ω—ã', 'success');
      addLog('üîÑ –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞...', 'warning');
      
      // Show redirect message
      redirect.style.display = 'block';
      
      // Countdown
      let seconds = 3;
      const countdownInterval = setInterval(() => {
        seconds--;
        countdownEl.textContent = seconds;
        
        if (seconds === 0) {
          clearInterval(countdownInterval);
          window.location.href = '/integrator/login?force_refresh=' + Date.now();
        }
      }, 1000);
    }
    
    // Start immediately
    forceLogout();
  </script>
</body>
</html>




