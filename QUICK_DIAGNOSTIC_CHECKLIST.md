# üîç –ë–´–°–¢–†–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê PDF UPLOAD

## ‚úÖ –®–ê–ì 1: –ü–†–û–í–ï–†–¨ SUPABASE BUCKET

1. –û—Ç–∫—Ä–æ–π **Supabase Dashboard**: https://supabase.com/dashboard
2. –í—ã–±–µ—Ä–∏ –ø—Ä–æ–µ–∫—Ç
3. –í –ª–µ–≤–æ–º –º–µ–Ω—é ‚Üí **Storage**
4. –¢—ã –¥–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å bucket —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º **`user-files`**

‚ùå **–ï—Å–ª–∏ –ù–ï–¢:**
‚Üí Click **"Create a new bucket"**
‚Üí Name: `user-files`
‚Üí Public: **‚ùå false**
‚Üí Click **"Create"**

---

## ‚úÖ –®–ê–ì 2: –ü–†–û–í–ï–†–¨ –¢–ê–ë–õ–ò–¶–£ file_uploads

1. –û—Ç–∫—Ä–æ–π **Supabase Dashboard**
2. –í –ª–µ–≤–æ–º –º–µ–Ω—é ‚Üí **Table Editor**
3. –¢—ã –¥–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å —Ç–∞–±–ª–∏—Ü—É **`file_uploads`**

‚ùå **–ï—Å–ª–∏ –ù–ï–¢:**
‚Üí –û—Ç–∫—Ä–æ–π **SQL Editor**
‚Üí Click **"New query"**
‚Üí –°–∫–æ–ø–∏—Ä—É–π –í–ï–°–¨ —Ñ–∞–π–ª `supabase_create_file_storage.sql`
‚Üí –í—Å—Ç–∞–≤—å –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä
‚Üí Click **"Run"** (Ctrl+Enter)

---

## ‚úÖ –®–ê–ì 3: –ü–†–û–í–ï–†–¨ BACKEND –õ–û–ì–ò

–û—Ç–∫—Ä–æ–π —Ç–µ—Ä–º–∏–Ω–∞–ª –≥–¥–µ –∑–∞–ø—É—â–µ–Ω Backend (`npm run dev`)

**‚ùå –ï—Å–ª–∏ –≤–∏–¥–∏—à—å –æ—à–∏–±–∫–∏ —Ç–∏–ø–∞:**

### `Bucket 'user-files' not found`
**–ü—Ä–∏—á–∏–Ω–∞:** Bucket –Ω–µ —Å–æ–∑–¥–∞–Ω  
**–†–µ—à–µ–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω–∏ –®–ê–ì 1 –≤—ã—à–µ

### `relation "file_uploads" does not exist`
**–ü—Ä–∏—á–∏–Ω–∞:** –¢–∞–±–ª–∏—Ü–∞ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞  
**–†–µ—à–µ–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω–∏ –®–ê–ì 2 –≤—ã—à–µ

### `permission denied for table file_uploads`
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–≤–µ—Ä–Ω—ã–π SERVICE_ROLE_KEY  
**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π `backend/.env`
2. –ù–∞–π–¥–∏ `SUPABASE_SERVICE_ROLE_KEY=...`
3. –£–±–µ–¥–∏—Å—å —á—Ç–æ —ç—Ç–æ **SERVICE ROLE KEY** (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `eyJhbGci...`, –¥–ª–∏–Ω–∞ ~200+ —Å–∏–º–≤–æ–ª–æ–≤)
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ Backend

### `userId is required`
**–ü—Ä–∏—á–∏–Ω–∞:** Frontend –Ω–µ –ø–µ—Ä–µ–¥–∞—ë—Ç userId  
**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ Frontend (–∫–æ–¥ —É–∂–µ –æ–±–Ω–æ–≤–ª—ë–Ω)

---

## ‚úÖ –®–ê–ì 4: –ü–†–û–í–ï–†–¨ FRONTEND –õ–û–ì–ò

–û—Ç–∫—Ä–æ–π –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12 ‚Üí Console)

**‚ùå –ï—Å–ª–∏ –≤–∏–¥–∏—à—å –æ—à–∏–±–∫–∏ —Ç–∏–ø–∞:**

### `401 Unauthorized` –∏–ª–∏ `403 Forbidden`
**–ü—Ä–∏—á–∏–Ω–∞:** JWT —Ç–æ–∫–µ–Ω –Ω–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ –∏—Å—Ç—ë–∫  
**–†–µ—à–µ–Ω–∏–µ:** –†–∞–∑–ª–æ–≥–∏–Ω—å—Å—è –∏ –∑–∞–ª–æ–≥–∏–Ω—å—Å—è –∑–∞–Ω–æ–≤–æ

### `500 Internal Server Error`
**–ü—Ä–∏—á–∏–Ω–∞:** Backend –æ—à–∏–±–∫–∞  
**–†–µ—à–µ–Ω–∏–µ:** –°–º–æ—Ç—Ä–∏ Backend –ª–æ–≥–∏ (–≤—ã—à–µ)

### `Failed to load resource: net::ERR_CONNECTION_REFUSED`
**–ü—Ä–∏—á–∏–Ω–∞:** Backend –Ω–µ –∑–∞–ø—É—â–µ–Ω  
**–†–µ—à–µ–Ω–∏–µ:**
```bash
cd backend
npm run dev
```

---

## ‚úÖ –®–ê–ì 5: –¢–ï–°–¢–û–í–ê–Ø –ó–ê–ì–†–£–ó–ö–ê

1. –û—Ç–∫—Ä–æ–π `http://localhost:8080`
2. –ü–µ—Ä–µ–π–¥–∏ –≤ **AI-–ö—É—Ä–∞—Ç–æ—Ä**
3. –ü—Ä–∏–∫—Ä–µ–ø–∏ **–ú–ê–õ–ï–ù–¨–ö–ò–ô** PDF (1-2 —Å—Ç—Ä–∞–Ω–∏—Ü—ã, < 5MB)
4. –û—Ç–ø—Ä–∞–≤—å —Å–æ–æ–±—â–µ–Ω–∏–µ

**‚úÖ –û–ñ–ò–î–ê–ï–ú–´–ï –õ–û–ì–ò Backend:**
```
[FileController] üîç –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞ (–ù–û–í–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê)...
[FileController] üìÑ –§–∞–π–ª –ø–æ–ª—É—á–µ–Ω: { filename: 'test.pdf', size: 54257 }
[FileController] üìÑ –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–µ–∫—Å—Ç –∏–∑ PDF...
[FileProcessing] ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–æ 1234 —Å–∏–º–≤–æ–ª–æ–≤ –∏–∑ PDF
[FileController] üì§ –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª –≤ Supabase Storage...
[StorageService] ‚úÖ –§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω
[FileController] üíæ –°–æ—Ö—Ä–∞–Ω—è–µ–º metadata –≤ –ë–î...
[DatabaseService] ‚úÖ Metadata —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞, ID: 1
```

**‚úÖ –û–ñ–ò–î–ê–ï–ú–´–ï –õ–û–ì–ò Frontend (F12):**
```
üìé [processFile] –ü–æ–ª—É—á–µ–Ω —Ñ–∞–π–ª: { name: 'test.pdf', size: 54257 }
üìé [processFile] –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ Backend: /api/files/process
‚úÖ –§–∞–π–ª –æ–±—Ä–∞–±–æ—Ç–∞–Ω: { success: true, file: { fileUrl: '...' } }
```

---

## üö® –°–†–û–ß–ù–´–ï –î–ï–ô–°–¢–í–ò–Ø

–ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç:

1. **–û—Å—Ç–∞–Ω–æ–≤–∏ Backend + Frontend** (Ctrl+C –≤ –æ–±–æ–∏—Ö —Ç–µ—Ä–º–∏–Ω–∞–ª–∞—Ö)
2. **–ü—Ä–æ–≤–µ—Ä—å .env —Ñ–∞–π–ª:**
   ```bash
   cd backend
   cat .env | grep SUPABASE
   ```
   –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
   - `SUPABASE_URL=https://arqhkacellqbhjhbebfh.supabase.co`
   - `SUPABASE_SERVICE_ROLE_KEY=eyJhbGci...` (–¥–ª–∏–Ω–Ω—ã–π –∫–ª—é—á)

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ Backend:**
   ```bash
   cd backend
   npm run dev
   ```

4. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ Frontend:**
   ```bash
   cd C:\onai-integrator-login
   npm run dev
   ```

5. **–ü–æ–ø—Ä–æ–±—É–π –∑–∞–Ω–æ–≤–æ**

---

## üìã –ß–ï–ö–õ–ò–°–¢ –ü–ï–†–ï–î –û–ë–†–ê–©–ï–ù–ò–ï–ú –ó–ê –ü–û–ú–û–©–¨–Æ

–°–æ–±–µ—Ä–∏ –í–°–Æ —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:

- [ ] Backend –ª–æ–≥–∏ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å—Ç—Ä–æ–∫ –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞)
- [ ] Frontend –ª–æ–≥–∏ (F12 ‚Üí Console, —Å–∫—Ä–∏–Ω—à–æ—Ç)
- [ ] Bucket `user-files` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç? (–î–ê/–ù–ï–¢)
- [ ] –¢–∞–±–ª–∏—Ü–∞ `file_uploads` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç? (–î–ê/–ù–ï–¢)
- [ ] Backend –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3000? (–î–ê/–ù–ï–¢)
- [ ] Frontend –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 8080? (–î–ê/–ù–ï–¢)
- [ ] `.env` —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç SERVICE_ROLE_KEY? (–î–ê/–ù–ï–¢)

**–û—Ç–ø—Ä–∞–≤—å —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é ‚Äî –∏ –º—ã –±—ã—Å—Ç—Ä–æ –Ω–∞–π–¥—ë–º –ø—Ä–æ–±–ª–µ–º—É!** üîç


