# ü§ñ Telegram Leads Bot - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

## –ß—Ç–æ —ç—Ç–æ?

–°–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –Ω–æ–≤—ã—Ö –ª–∏–¥–∞—Ö (–∑–∞—è–≤–∫–∞—Ö —Å –ª–µ–Ω–¥–∏–Ω–≥–æ–≤ ProfTest –∏ ExpressCourse) –≤ Telegram –≥—Ä—É–ø–ø—É.

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç?

1. **–î–æ–±–∞–≤–ª—è–µ—à—å –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É** –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
2. **–í–≤–æ–¥–∏—à—å –∫–æ–¥ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏** `2134` –≤ –≥—Ä—É–ø–ø–µ
3. **–í—Å–µ –∑–∞—è–≤–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç** –≤ —ç—Ç—É –≥—Ä—É–ø–ø—É

## üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ (–®–∞–≥ –∑–∞ —à–∞–≥–æ–º)

### 1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –∫ –ë–î

–ü–æ–¥–∫–ª—é—á–∏—Å—å –∫ **Landing Supabase** (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ª–µ–Ω–¥–∏–Ω–≥–æ–≤) –∏ –≤—ã–ø–æ–ª–Ω–∏ SQL –º–∏–≥—Ä–∞—Ü–∏—é:

```bash
# –ù–∞–π–¥–∏ —Ñ–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏
backend/supabase/migrations/create_telegram_groups.sql
```

–°–∫–æ–ø–∏—Ä—É–π —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –∏ –≤—ã–ø–æ–ª–Ω–∏ –≤ **SQL Editor** –≤ Supabase Dashboard:
- URL: https://supabase.com/dashboard/project/xikaiavwqinamgolmtcy/sql/new
- –ë–∞–∑–∞: Landing Supabase (xikaiavwqinamgolmtcy)

–ò–ª–∏ —á–µ—Ä–µ–∑ psql:
```bash
psql "postgresql://postgres.xikaiavwqinamgolmtcy:YOUR_PASSWORD@aws-0-eu-central-1.pooler.supabase.com:6543/postgres" -f backend/supabase/migrations/create_telegram_groups.sql
```

### 2. –ü—Ä–æ–≤–µ—Ä—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í `backend/env.env` –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã:

```env
# Telegram Leads Bot (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
TELEGRAM_LEADS_BOT_TOKEN=8275130868:AAGiH466WmyoUQUKN4VfwI3nM1qZAmlUJOQ

# Landing Supabase (–±–∞–∑–∞ –¥–ª—è –ª–µ–Ω–¥–∏–Ω–≥–æ–≤ - —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞)
LANDING_SUPABASE_URL=https://xikaiavwqinamgolmtcy.supabase.co
LANDING_SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

‚úÖ –í—Å–µ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ, –Ω–∏—á–µ–≥–æ –º–µ–Ω—è—Ç—å –Ω–µ –Ω—É–∂–Ω–æ!

### 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ backend

```bash
cd backend
npm run dev
# –∏–ª–∏
pm2 restart backend
```

### 4. –ê–∫—Ç–∏–≤–∏—Ä—É–π –≥—Ä—É–ø–ø—É –≤ Telegram

1. **–û—Ç–∫—Ä–æ–π Telegram** –∏ –Ω–∞–π–¥–∏ —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞: `@onai_leads_bot` (–∏–ª–∏ –∫–∞–∫ –æ–Ω –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è)
   
2. **–°–æ–∑–¥–∞–π –≥—Ä—É–ø–ø—É** –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é
   
3. **–î–æ–±–∞–≤—å –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É**:
   - –û—Ç–∫—Ä–æ–π –≥—Ä—É–ø–ø—É
   - –ù–∞–∂–º–∏ –Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã ‚Üí "–î–æ–±–∞–≤–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤"
   - –ù–∞–π–¥–∏ –∏ –¥–æ–±–∞–≤—å –±–æ—Ç–∞
   
4. **–°–¥–µ–ª–∞–π –±–æ—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º**:
   - –û—Ç–∫—Ä–æ–π "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–æ–π" ‚Üí "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã"
   - –î–æ–±–∞–≤—å –±–æ—Ç–∞ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
   - –î–∞–π –ø—Ä–∞–≤–∞ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π
   
5. **–û—Ç–ø—Ä–∞–≤—å –∫–æ–¥ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏**:
   ```
   2134
   ```
   
6. **–ë–æ—Ç –æ—Ç–≤–µ—Ç–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º**:
   ```
   ‚úÖ –ë–û–¢ –ê–ö–¢–ò–í–ò–†–û–í–ê–ù!
   
   üìç Chat ID: -1003505301432
   üè∑Ô∏è –ì—Ä—É–ø–ø–∞: –õ–∏–¥—ã –¢—Ä–∏–ø–≤–∞–µ—Ä
   
   –¢–µ–ø–µ—Ä—å –≤—Å–µ –Ω–æ–≤—ã–µ –∑–∞—è–≤–∫–∏ —Å —Å–∞–π—Ç–∞ –±—É–¥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å —Å—é–¥–∞! üöÄ
   ```

### 5. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

#### –ß–µ—Ä–µ–∑ API —Ç–µ—Å—Ç:
```bash
curl -X POST http://localhost:3000/api/telegram-leads/test
```

–î–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É.

#### –ß–µ—Ä–µ–∑ —Ä–µ–∞–ª—å–Ω—É—é –∑–∞—è–≤–∫—É:
–û—Ç–ø—Ä–∞–≤—å —Ç–µ—Å—Ç–æ–≤—É—é –∑–∞—è–≤–∫—É —Å –ª–µ–Ω–¥–∏–Ω–≥–∞:
- ProfTest: https://onai.academy/integrator/proftest
- ExpressCourse: https://onai.academy/integrator/expresscourse

–ó–∞—è–≤–∫–∞ –¥–æ–ª–∂–Ω–∞ –ø—Ä–∏–π—Ç–∏ –≤ Telegram –≥—Ä—É–ø–ø—É –≤ —Ç–∞–∫–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:

```
üéØ –ù–û–í–ê–Ø –ó–ê–Ø–í–ö–ê - üéì –≠–ö–°–ü–†–ï–°–° –ö–£–†–°

üë§ –ò–º—è: –ú—É—Ä–∑–∏–ª–∫–∞ –ê—Ä—ã–∫–æ–≤
üì± –¢–µ–ª–µ—Ñ–æ–Ω: +7 777 123 45 67
üìß Email: test@example.com
üí≥ –°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã: üí≥ Kaspi –±–∞–Ω–∫
üìç –ò—Å—Ç–æ—á–Ω–∏–∫: expresscourse

‚è∞ 16.12.2024, 23:45
```

## üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

–í –≥—Ä—É–ø–ø–µ –º–æ–∂–µ—à—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å:

- `/help` - –°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É
- `/status` - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≥—Ä—É–ø–ø—ã (–∞–∫—Ç–∏–≤–Ω–∞ –ª–∏)
- `/deactivate` - –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≥—Ä—É–ø–ø—É (–ª–∏–¥—ã –ø–µ—Ä–µ—Å—Ç–∞–Ω—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å)
- `2134` - –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≥—Ä—É–ø–ø—É –∑–∞–Ω–æ–≤–æ

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ API endpoints

### –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –≥—Ä—É–ø–ø:
```bash
GET http://localhost:3000/api/telegram-leads/active-groups
```

Response:
```json
{
  "success": true,
  "groups": [
    {
      "chat_id": "-1003505301432",
      "chat_title": "–õ–∏–¥—ã –¢—Ä–∏–ø–≤–∞–µ—Ä",
      "group_type": "leads",
      "is_active": true,
      "activated_by": "misolabs",
      "activated_at": "2024-12-16T18:28:00.000Z"
    }
  ],
  "count": 1
}
```

### –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:
```bash
POST http://localhost:3000/api/telegram-leads/test
```

## üö® Troubleshooting

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ–¥ 2134
1. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω (—Å–º. –ª–æ–≥–∏ backend)
2. –£–±–µ–¥–∏—Å—å —á—Ç–æ –±–æ—Ç - –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≥—Ä—É–ø–ø—ã
3. –ü—Ä–æ–≤–µ—Ä—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –≤ `env.env`

### –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç, –Ω–æ –ª–∏–¥—ã –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç
1. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –≥—Ä—É–ø–ø–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞: `/status`
2. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ backend –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞—è–≤–∫–∏
3. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ `telegram_groups` —Å–æ–∑–¥–∞–Ω–∞ –≤ –ë–î

### –ö–∞–∫ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≥—Ä—É–ø–ø—É?
–û—Ç–ø—Ä–∞–≤—å –≤ –≥—Ä—É–ø–ø—É: `/deactivate`

–ò–ª–∏ —É–¥–∞–ª–∏ –±–æ—Ç–∞ –∏–∑ –≥—Ä—É–ø–ø—ã - –æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è.

### –ö–∞–∫ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –¥—Ä—É–≥—É—é –≥—Ä—É–ø–ø—É?
–ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å –±–æ—Ç–∞ –≤ –Ω–æ–≤—É—é –≥—Ä—É–ø–ø—É –∏ –æ—Ç–ø—Ä–∞–≤—å –∫–æ–¥ `2134`. 
–ú–æ–∂–Ω–æ –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –≥—Ä—É–ø–ø - –ª–∏–¥—ã –±—É–¥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –≤–æ –≤—Å–µ.

## üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

Backend –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è:

```bash
# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≥—Ä—É–ø–ø—ã
‚úÖ New group -1003505301432 activated by misolabs

# –û—Ç–ø—Ä–∞–≤–∫–∞ –ª–∏–¥–∞
üì± Found 1 active group(s) for lead notifications
üì± Sending lead notification to group "–õ–∏–¥—ã –¢—Ä–∏–ø–≤–∞–µ—Ä" (-1003505301432)
‚úÖ Lead notification sent to group "–õ–∏–¥—ã –¢—Ä–∏–ø–≤–∞–µ—Ä" (-1003505301432)
üìä Lead notification results: 1 success, 0 failed out of 1 groups
```

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ —Ñ–∏—à–∫–∏

### –ù–µ—Å–∫–æ–ª—å–∫–æ –≥—Ä—É–ø–ø
–ú–æ–∂–µ—à—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≥—Ä—É–ø–ø - –ª–∏–¥—ã –±—É–¥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –≤–æ –≤—Å–µ:
- –ì—Ä—É–ø–ø–∞ –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
- –ì—Ä—É–ø–ø–∞ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤
- –õ–∏—á–Ω–∞—è –≥—Ä—É–ø–ø–∞ –¥–ª—è —Ç–µ–±—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è
–ï—Å–ª–∏ –±–æ—Ç —É–¥–∞–ª–µ–Ω –∏–∑ –≥—Ä—É–ø–ø—ã –∏–ª–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, –≥—Ä—É–ø–ø–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è.

### –ò—Å—Ç–æ—Ä–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–π
–í—Å–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:
- –ö—Ç–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª (username)
- –ö–æ–≥–¥–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª
- –ö–æ–≥–¥–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –±—ã–ª–∞ –∞–∫—Ç–∏–≤–Ω–∞

## üéØ –ß—Ç–æ –¥–∞–ª—å—à–µ?

–¢–µ–ø–µ—Ä—å –≤—Å–µ –∑–∞—è–≤–∫–∏ —Å –ª–µ–Ω–¥–∏–Ω–≥–æ–≤ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –≤ Telegram! üöÄ

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ:
- –ò–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π: `backend/src/services/telegramService.ts`
- –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã (—Ç–æ–ª—å–∫–æ ProfTest, —Ç–æ–ª—å–∫–æ ExpressCourse): `telegram-leads.ts`
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –∞–¥–º–∏–Ω–æ–≤: —Å–æ–∑–¥–∞–π –Ω–æ–≤—É—é –≥—Ä—É–ø–ø—É —Å `group_type: 'admin'`

**–ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å —Ç—ã –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—à—å –Ω–∏ –æ–¥–Ω–æ–≥–æ –ª–∏–¥–∞! üéâ**
