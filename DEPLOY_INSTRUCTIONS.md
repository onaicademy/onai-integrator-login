# üöÄ DEPLOY INSTRUCTIONS - onAI Academy v1.10.00

## ‚úÖ –ó–ê–í–ï–†–®–ï–ù–ù–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø

### 1. **–°—á–µ—Ç—á–∏–∫ –∑–∞–≤–µ—Ä—à–∏–≤—à–∏—Ö –∫—É—Ä—Å** (modules_completed >= 3)
- ‚úÖ Backend: –î–æ–±–∞–≤–ª–µ–Ω `course_completed_users` –≤ `getSalesLeaderboard()` (direct SQL)
- ‚úÖ Backend: –û–±–Ω–æ–≤–ª–µ–Ω RPC `rpc_get_tripwire_stats` (–º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞)
- ‚úÖ Frontend: –û–±–Ω–æ–≤–ª–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `ManagerStats` –≤ `SalesLeaderboard.tsx`
- ‚úÖ Frontend: –û–±–Ω–æ–≤–ª–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `Stats` –≤ `TripwireManager.tsx` –∏ `StatsCards.tsx`
- ‚úÖ UI: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ "–ó–∞–≤–µ—Ä—à–∏–ª–∏ –∫—É—Ä—Å: X" –≤ Leaderboard —Å –∏–∫–æ–Ω–∫–æ–π —à–∫–æ–ª—ã
- ‚úÖ UI: –ö–∞—Ä—Ç–æ—á–∫–∞ "–ó–ê–í–ï–†–®–ò–õ–ò –ö–£–†–°" –≤ StatsCards –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `course_completed_students`

### 2. **–ö–∞–ª–µ–Ω–¥–∞—Ä—å –≤–º–µ—Å—Ç–æ –∫–Ω–æ–ø–æ–∫ –ø–µ—Ä–∏–æ–¥**
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω—ã –∫–Ω–æ–ø–∫–∏ "–ù–µ–¥–µ–ª—è/–ú–µ—Å—è—Ü/–ì–æ–¥" –Ω–∞ `SafeDateFilter` (–∫–∞–ª–µ–Ω–¥–∞—Ä—å)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ `TripwireManager.tsx` –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ `SalesChart`, `UsersTable`, `ActivityLog`

### 3. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤—ã—Ä—É—á–∫–∞ –≤ Leaderboard –∏ Sales Chart**
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω—ã RPC –≤—ã–∑–æ–≤—ã –Ω–∞ direct SQL queries
- ‚úÖ JOIN —Å `tripwire_user_profile` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### 4. **–£–¥–∞–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–°–ú–û–¢–†–ï–¢–¨ –£–ß–ï–ù–ò–ö–û–í"**
- ‚úÖ –£–±—Ä–∞–Ω–∞ –∏–∑ `SalesLeaderboard.tsx`
- ‚úÖ –£–±—Ä–∞–Ω prop `onManagerSelect`

### 5. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω timeout –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω `listUsers()` –Ω–∞ `getUserByEmail()` –≤ `tripwireManagerService.ts`

---

## üìã –ö–û–ú–ê–ù–î–´ –î–õ–Ø –î–ï–ü–õ–û–Ø (–í—ã–ø–æ–ª–Ω–∏—Ç—å –≤ –û–¢–î–ï–õ–¨–ù–û–ú Windows Terminal)

### –®–∞–≥ 1: Git Push (Frontend auto-deploy –Ω–∞ Vercel)

```powershell
cd C:\onai-integrator-login\onai-integrator-login

git add -A

git commit -m "Add course completion counter, fix leaderboard revenue, replace period buttons with calendar"

git push origin main
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Frontend –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—Å—è –Ω–∞ Vercel (https://onai.academy)

---

### –®–∞–≥ 2: Backend Deploy –Ω–∞ DigitalOcean

```bash
ssh root@207.154.231.30 "cd /var/www/onai-integrator-login-main && git pull origin main && cd backend && npm install --production && npm run build && pm2 restart onai-backend --update-env && sleep 5 && pm2 status && pm2 logs onai-backend --lines 20 --nostream"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Backend –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ https://api.onai.academy

---

## üß™ –ü–†–û–í–ï–†–ö–ê –ü–û–°–õ–ï –î–ï–ü–õ–û–Ø

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Backend API
```bash
curl https://api.onai.academy/api/health
```

### 2. –û—Ç–∫—Ä—ã—Ç—å Production –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
- ‚úÖ https://onai.academy/admin/tripwire-manager
- ‚úÖ –õ–æ–≥–∏–Ω: `rakhat@onaiacademy.kz` / –ü–∞—Ä–æ–ª—å: (–∏–∑–≤–µ—Å—Ç–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
  - –ö–∞—Ä—Ç–æ—á–∫–∞ "–ó–ê–í–ï–†–®–ò–õ–ò –ö–£–†–°" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —á–∏—Å–ª–æ
  - Leaderboard –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–ó–∞–≤–µ—Ä—à–∏–ª–∏ –∫—É—Ä—Å: X" –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞
  - –í—ã—Ä—É—á–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
  - –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç (–≤—ã–±–æ—Ä –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –¥–∞—Ç)
  - –î–∏–Ω–∞–º–∏–∫–∞ –ø—Ä–æ–¥–∞–∂ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞—Ç

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Browser Console
```javascript
// –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 0 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ (500, RPC errors, missing functions)
```

---

## üîÑ –û–°–¢–ê–í–®–ò–ï–°–Ø –ó–ê–î–ê–ß–ò (–ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è)

### TODO #6: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É welcome email
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `emailService.ts` –∏ SMTP –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –ø–∏—Å—å–º–æ –Ω–∞ `digital.mcwin@gmail.com`

---

## üìù –í–ï–†–°–ò–Ø –ü–õ–ê–¢–§–û–†–ú–´

**v1.10.00** - –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –°—á–µ—Ç—á–∏–∫ –∑–∞–≤–µ—Ä—à–∏–≤—à–∏—Ö –∫—É—Ä—Å –¥–ª—è sales –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–∏–æ–¥–∞ –≤–º–µ—Å—Ç–æ –∫–Ω–æ–ø–æ–∫
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –≤—ã—Ä—É—á–∫–∏ –≤ –¥–∞—à–±–æ—Ä–¥–∞—Ö
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (getUserByEmail)

---

## ‚ö†Ô∏è –ò–ó–í–ï–°–¢–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

1. **Cursor PowerShell –∑–∞–≤–∏—Å–∞–µ—Ç** - –ò—Å–ø–æ–ª—å–∑—É–π –æ—Ç–¥–µ–ª—å–Ω—ã–π Windows Terminal –¥–ª—è git/npm/ssh –∫–æ–º–∞–Ω–¥
2. **pm2 logs** - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–ª–∞–≥ `--nostream` —á—Ç–æ–±—ã –Ω–µ –∑–∞–≤–∏—Å–∞–ª–æ

---

**–ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ:** 2025-12-10
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é ‚úÖ
