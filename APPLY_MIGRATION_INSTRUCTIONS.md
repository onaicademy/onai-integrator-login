# üìã –ò–ù–°–¢–†–£–ö–¶–ò–Ø: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ú–∏–≥—Ä–∞—Ü–∏—é –ë–î

**–ú–∏–≥—Ä–∞—Ü–∏—è:** `campaign_targetologist_map`  
**–§–∞–π–ª:** `supabase/migrations/20251222_create_campaign_targetologist_map.sql`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–∞ –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é  

---

## üéØ –ß–¢–û –î–ï–õ–ê–ï–¢ –ú–ò–ì–†–ê–¶–ò–Ø

–°–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:
- –ö–∞–∫–æ–π —Ç–∞—Ä–≥–µ—Ç–æ–ª–æ–≥ –≤–ª–∞–¥–µ–µ—Ç –∫–∞–∫–æ–π –∫–∞–º–ø–∞–Ω–∏–µ–π
- –ö–∞–∫ –±—ã–ª–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ (database/utm/pattern/manual)
- –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä—É—á–Ω–æ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è

---

## üöÄ –°–ü–û–°–û–ë 1: –ß–µ—Ä–µ–∑ Supabase Dashboard (–ë–´–°–¢–†–û)

### –®–∞–≥–∏:

1. **–û—Ç–∫—Ä–æ–π Supabase Dashboard:**
   ```
   https://supabase.com/dashboard/project/oetodaexnjcunklkdlkv
   ```

2. **–ü–µ—Ä–µ–π–¥–∏ –≤ SQL Editor:**
   - –°–ª–µ–≤–∞ –≤ –º–µ–Ω—é: "SQL Editor"
   - –ò–ª–∏ –ø—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞: https://supabase.com/dashboard/project/oetodaexnjcunklkdlkv/sql

3. **–°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π Query:**
   - –ù–∞–∂–º–∏ "New query"

4. **–í—Å—Ç–∞–≤—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:**
   - –û—Ç–∫—Ä–æ–π: `/Users/miso/onai-integrator-login/supabase/migrations/20251222_create_campaign_targetologist_map.sql`
   - –°–∫–æ–ø–∏—Ä—É–π –í–°–Å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
   - –í—Å—Ç–∞–≤—å –≤ SQL Editor

5. **–ó–∞–ø—É—Å—Ç–∏:**
   - –ù–∞–∂–º–∏ "Run" –∏–ª–∏ Cmd+Enter

6. **–ü—Ä–æ–≤–µ—Ä—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: "Success. No rows returned"
   - –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! –¢–∞–±–ª–∏—Ü–∞ —Å–æ–∑–¥–∞–Ω–∞ ‚úÖ

7. **–ü—Ä–æ–≤–µ—Ä—å —Ç–∞–±–ª–∏—Ü—É:**
   - –°–ª–µ–≤–∞ –≤ –º–µ–Ω—é: "Table Editor"
   - –ù–∞–π–¥–∏: `campaign_targetologist_map`
   - –î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ ‚úÖ

---

## üõ†Ô∏è –°–ü–û–°–û–ë 2: –ß–µ—Ä–µ–∑ Supabase CLI (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

```bash
cd /Users/miso/onai-integrator-login

# –ï—Å–ª–∏ CLI –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
npm install -g supabase

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é:
supabase db push

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é:
supabase db execute --file supabase/migrations/20251222_create_campaign_targetologist_map.sql
```

---

## üîç –ü–†–û–í–ï–†–ö–ê –ü–û–°–õ–ï –ü–†–ò–ú–ï–ù–ï–ù–ò–Ø

### –ß–µ—Ä–µ–∑ SQL Editor:

```sql
-- 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–∑–¥–∞–Ω–∞
SELECT * FROM campaign_targetologist_map LIMIT 5;

-- 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã
SELECT tablename, indexname 
FROM pg_indexes 
WHERE tablename = 'campaign_targetologist_map';

-- 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å RLS policies
SELECT * FROM pg_policies 
WHERE tablename = 'campaign_targetologist_map';
```

### –ß–µ—Ä–µ–∑ Backend API:

```bash
# –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏, –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ backend:
cd /Users/miso/onai-integrator-login/backend
npm run dev

# –¢–µ—Å—Ç:
curl http://localhost:3000/api/traffic-facebook/campaigns/act_1296178948690331 | jq '.campaigns[0].targetologist'
# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: "Muha" –∏–ª–∏ "Kenesary" –∏–ª–∏ null
```

---

## ‚ùì –ï–°–õ–ò –ß–¢–û-–¢–û –ù–ï –†–ê–ë–û–¢–ê–ï–¢

### –û—à–∏–±–∫–∞: "relation already exists"

**–ü—Ä–∏—á–∏–Ω–∞:** –¢–∞–±–ª–∏—Ü–∞ —É–∂–µ —Å–æ–∑–¥–∞–Ω–∞

**–†–µ—à–µ–Ω–∏–µ:** –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! –¢–∞–±–ª–∏—Ü–∞ —É–∂–µ –µ—Å—Ç—å, –º–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å.

---

### –û—à–∏–±–∫–∞: "permission denied"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Å—å —á—Ç–æ –ª–æ–≥–∏–Ω –≤ Supabase –∫–∞–∫ admin
2. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π Service Role Key

---

### –û—à–∏–±–∫–∞: Backend –Ω–µ –≤–∏–¥–∏—Ç —Ç–∞–±–ª–∏—Ü—É

**–ü—Ä–∏—á–∏–Ω–∞:** –¢–∞–±–ª–∏—Ü–∞ —Å–æ–∑–¥–∞–Ω–∞ –≤ –¥—Ä—É–≥–æ–π —Å—Ö–µ–º–µ

**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –ü—Ä–æ–≤–µ—Ä—å —Å—Ö–µ–º—É:
SELECT schemaname, tablename 
FROM pg_tables 
WHERE tablename = 'campaign_targetologist_map';

-- –ï—Å–ª–∏ –≤ –¥—Ä—É–≥–æ–π —Å—Ö–µ–º–µ, –ø–µ—Ä–µ—Å–æ–∑–¥–∞–π –≤ public:
DROP TABLE IF EXISTS campaign_targetologist_map CASCADE;
-- –ò –∑–∞–ø—É—Å—Ç–∏ –º–∏–≥—Ä–∞—Ü–∏—é –∑–∞–Ω–æ–≤–æ
```

---

## ‚úÖ –ü–û–°–õ–ï –ü–†–ò–ú–ï–ù–ï–ù–ò–Ø –ú–ò–ì–†–ê–¶–ò–ò

### –ß—Ç–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å:

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:**
   - –ö–∞–∂–¥–∞—è –∫–∞–º–ø–∞–Ω–∏—è –ø–æ–ª—É—á–∏—Ç –≤–ª–∞–¥–µ–ª—å—Ü–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ë–î

2. **–†—É—á–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
   - POST `/api/targetologist-assignment/manual`
   - –î–ª—è –∫–∞–º–ø–∞–Ω–∏–π –≥–¥–µ –Ω–µ —Å–º–æ–≥–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å

3. **–ò—Å—Ç–æ—Ä–∏—è:**
   - –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
   - –í–∏–¥–Ω–æ –∫—Ç–æ –∏ –∫–æ–≥–¥–∞ –Ω–∞–∑–Ω–∞—á–∏–ª

4. **–ë—ã—Å—Ç—Ä–∞—è —Ä–∞–±–æ—Ç–∞:**
   - –û–¥–∏–Ω —Ä–∞–∑ –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏ = –≤—Å–µ–≥–¥–∞ –∏–∑ –ë–î
   - –ù–µ –Ω—É–∂–Ω–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑ pattern matching

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ô –®–ê–ì

**–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏:**

```
‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ backend
‚úÖ –û—Ç–∫—Ä–æ–π Settings page
‚úÖ –ù–∞–∂–º–∏ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã"
‚úÖ –†–∞–∑–≤–µ—Ä–Ω–∏ –ª—é–±–æ–π –∫–∞–±–∏–Ω–µ—Ç
‚úÖ –î–æ–ª–∂–µ–Ω —É–≤–∏–¥–µ—Ç—å badge —Å –≤–ª–∞–¥–µ–ª—å—Ü–µ–º —Ä—è–¥–æ–º —Å –∫–∞–º–ø–∞–Ω–∏–µ–π
```

---

**–ü—Ä–∏–º–µ–Ω–∏ –º–∏–≥—Ä–∞—Ü–∏—é –°–ï–ô–ß–ê–° —á–µ—Ä–µ–∑ Supabase Dashboard!** üí™

**–§–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏:**
```
/Users/miso/onai-integrator-login/supabase/migrations/20251222_create_campaign_targetologist_map.sql
```
