# üìä –°—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–π Supabase

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 7 –Ω–æ—è–±—Ä—è 2025  
**–ü—Ä–æ–µ–∫—Ç:** onAI Academy Platform

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û: –ú–∏–≥—Ä–∞—Ü–∏–∏ –ù–ï –ü–†–ò–ú–ï–ù–ï–ù–´!

### –ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ (—Ñ–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π):

‚úÖ **5 –º–∏–≥—Ä–∞—Ü–∏–π –≥–æ—Ç–æ–≤—ã –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é:**

1. `20251103164013_*.sql` - –ë–∞–∑–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. `20251103182016_*.sql` - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
3. `20251104_add_diagnostics_tables.sql` - –¢–∞–±–ª–∏—Ü—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
4. `20250115_add_ai_curator_chat_tables.sql` - **–î–∏–∞–ª–æ–≥–∏ AI-–∫—É—Ä–∞—Ç–æ—Ä–∞**
5. `20250116_achievements_system.sql` - **–°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π** ‚≠ê

---

## üî¥ –ü—Ä–æ–±–ª–µ–º–∞:

**–ú–∏–≥—Ä–∞—Ü–∏–∏ –ù–ï –ü–†–ò–ú–ï–ù–ï–ù–´ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö Supabase!**

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç:
- ‚ùå –¢–∞–±–ª–∏—Ü—ã `user_achievements` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç
- ‚ùå –¢–∞–±–ª–∏—Ü—ã `achievement_history` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç  
- ‚ùå –¢–∞–±–ª–∏—Ü—ã `user_statistics` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç
- ‚ùå –¢–∞–±–ª–∏—Ü—ã `ai_curator_threads` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç
- ‚ùå AI-–∫—É—Ä–∞—Ç–æ—Ä –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚ùå –°–µ–π—á–∞—Å –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è MOCK –¥–∞–Ω–Ω—ã–µ

---

## üîß –ö–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Supabase Dashboard (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

1. **–û—Ç–∫—Ä–æ–π Supabase Dashboard:**
   ```
   https://supabase.com/dashboard/project/capdjvokjdivxjfddmx
   ```

2. **–ü–µ—Ä–µ–π–¥–∏ –≤ SQL Editor:**
   - –í –ª–µ–≤–æ–º –º–µ–Ω—é ‚Üí "SQL Editor"
   - –ù–∞–∂–º–∏ "New query"

3. **–°–∫–æ–ø–∏—Ä—É–π –∏ –≤—ã–ø–æ–ª–Ω–∏ –∫–∞–∂–¥—É—é –º–∏–≥—Ä–∞—Ü–∏—é:**
   
   **–ü–æ—Ä—è–¥–æ–∫ –≤–∞–∂–µ–Ω! –í—ã–ø–æ–ª–Ω—è–π –ø–æ –æ—á–µ—Ä–µ–¥–∏:**

   **–®–∞–≥ 1:** `20251103164013_*.sql`  
   **–®–∞–≥ 2:** `20251103182016_*.sql`  
   **–®–∞–≥ 3:** `20251104_add_diagnostics_tables.sql`  
   **–®–∞–≥ 4:** `20250115_add_ai_curator_chat_tables.sql`  
   **–®–∞–≥ 5:** `20250116_achievements_system.sql` ‚≠ê

4. **–î–ª—è –∫–∞–∂–¥–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏:**
   - –û—Ç–∫—Ä–æ–π —Ñ–∞–π–ª –∏–∑ `supabase/migrations/`
   - –°–∫–æ–ø–∏—Ä—É–π –≤–µ—Å—å SQL –∫–æ–¥
   - –í—Å—Ç–∞–≤—å –≤ SQL Editor
   - –ù–∞–∂–º–∏ "Run" (–∏–ª–∏ Ctrl+Enter)
   - –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –≤—ã–ø–æ–ª–Ω–∏–ª–æ—Å—å –±–µ–∑ –æ—à–∏–±–æ–∫

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ Supabase CLI (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Supabase CLI (–µ—Å–ª–∏ –Ω–µ—Ç)
brew install supabase/tap/supabase

# –õ–æ–≥–∏–Ω –≤ Supabase
supabase login

# –°–≤—è–∑–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
supabase link --project-ref capdjvokjdivxjfddmx

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –í–°–ï –º–∏–≥—Ä–∞—Ü–∏–∏
supabase db push
```

---

## üìã –ß—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –º–∏–≥—Ä–∞—Ü–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π:

### –¢–∞–±–ª–∏—Ü—ã:

#### 1. `user_achievements`
- –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –∫–∞–∂–¥–æ–º—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—é
- –ü–æ–ª—è: `current_value`, `required_value`, `is_completed`

#### 2. `achievement_history`
- –ò—Å—Ç–æ—Ä–∏—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
- –ü–æ–ª—è: `achievement_id`, `xp_earned`, `unlocked_at`

#### 3. `user_statistics`
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- 30+ –º–µ—Ç—Ä–∏–∫ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π:
  - `lessons_completed`
  - `modules_completed`
  - `streak_days`
  - `total_xp`
  - `perfect_lessons`
  - `ai_conversations`
  - –∏ —Ç.–¥.

### –ò–Ω–¥–µ–∫—Å—ã:
- –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø–æ `user_id`
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π

### RLS Policies:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ
- –ê–¥–º–∏–Ω—ã –≤–∏–¥—è—Ç –≤—Å—ë

### –§—É–Ω–∫—Ü–∏–∏:
- `initialize_user_statistics()` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- `update_achievement_progress()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

---

## üéØ –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π:

### –ù—É–∂–Ω–æ –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥:

#### 1. –í `achievements-api.ts`:

**–ë—ã–ª–æ:**
```typescript
const MOCK_USER_ACHIEVEMENTS = { ... }
```

**–°—Ç–∞–Ω–µ—Ç:**
```typescript
const { data: stats } = await supabase
  .from('user_statistics')
  .select('*')
  .eq('user_id', userId)
  .single();
```

#### 2. –í `AIChatDialog.tsx`:

**–ë—ã–ª–æ:**
```typescript
const userId = 'user-1'; // Mock
```

**–°—Ç–∞–Ω–µ—Ç:**
```typescript
const { data: { user } } = await supabase.auth.getUser();
const userId = user.id; // –†–µ–∞–ª—å–Ω—ã–π ID
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π, –≤—ã–ø–æ–ª–Ω–∏ –≤ SQL Editor:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public' 
  AND table_name LIKE '%achievement%'
  OR table_name LIKE 'user_statistics';

-- –î–æ–ª–∂–Ω—ã –±—ã—Ç—å:
-- user_achievements
-- achievement_history  
-- user_statistics
```

–ï—Å–ª–∏ —É–≤–∏–¥–∏—à—å —ç—Ç–∏ 3 —Ç–∞–±–ª–∏—Ü—ã - –≤—Å—ë –≥–æ—Ç–æ–≤–æ! ‚úÖ

---

## üîÑ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. ‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ (—á–µ—Ä–µ–∑ Dashboard –∏–ª–∏ CLI)
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
3. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Supabase
4. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ localhost
5. ‚úÖ –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –Ω–∞ Digital Ocean

---

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Ç–∞–±–ª–∏—Ü:

**AI-–∫—É—Ä–∞—Ç–æ—Ä –¥–∏–∞–ª–æ–≥–∏:**
- ‚ùå –ù–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ
- –§–∞–π–ª: `20250115_add_ai_curator_chat_tables.sql`
- –¢–∞–±–ª–∏—Ü—ã: `ai_curator_threads`, `ai_curator_messages`, `ai_curator_attachments`, `ai_curator_metrics`

**–°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π:**
- ‚ùå –ù–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ
- –§–∞–π–ª: `20250116_achievements_system.sql`
- –¢–∞–±–ª–∏—Ü—ã: `user_achievements`, `achievement_history`, `user_statistics`

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
- ‚ùå –ù–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ
- –§–∞–π–ª: `20251104_add_diagnostics_tables.sql`

---

## üÜò –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

### –û—à–∏–±–∫–∞: "relation already exists"
```sql
-- –£–¥–∞–ª–∏ —Ç–∞–±–ª–∏—Ü—É –∏ –ø—Ä–∏–º–µ–Ω—è–π –∑–∞–Ω–æ–≤–æ
DROP TABLE IF EXISTS user_achievements CASCADE;
DROP TABLE IF EXISTS achievement_history CASCADE;
DROP TABLE IF EXISTS user_statistics CASCADE;
```

### –û—à–∏–±–∫–∞: "permission denied"
- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ç—ã Owner –ø—Ä–æ–µ–∫—Ç–∞ –≤ Supabase
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π Service Role Key

### –û—à–∏–±–∫–∞: "syntax error"
- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª –í–ï–°–¨ SQL –∫–æ–¥
- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –Ω–µ –ø–æ—Ç–µ—Ä—è–ª–∏—Å—å —Å–∏–º–≤–æ–ª—ã –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:

**–ü–†–ò–ú–ï–ù–ò–¢–¨ –°–ï–ô–ß–ê–°!** 

–ë–µ–∑ —ç—Ç–æ–≥–æ:
- AI-–∫—É—Ä–∞—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ mock –¥–∞–Ω–Ω—ã—Ö
- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:
- ‚úÖ –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è AI-–∫—É—Ä–∞—Ç–æ—Ä–∞
- ‚úÖ –†–µ–∞–ª—å–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- ‚úÖ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —Å –∂–∏–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

---

**–ê–≤—Ç–æ—Ä:** AI Development System  
**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –¢–†–ï–ë–£–ï–¢–°–Ø –î–ï–ô–°–¢–í–ò–ï

